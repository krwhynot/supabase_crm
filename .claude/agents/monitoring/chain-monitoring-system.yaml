# Agent Chain Monitoring System Configuration
# Comprehensive monitoring and metrics collection for agent workflow chains

version: "1.0.0"
monitoring_enabled: true
collection_interval: "1m"
retention_period: "30d"

# Metrics Collection Configuration
metrics:
  # Chain Execution Metrics
  chain_execution:
    - metric: "chain_completion_rate"
      type: "percentage"
      description: "Percentage of chains that complete successfully"
      target: ">= 95%"
      alert_threshold: "< 90%"
    
    - metric: "chain_execution_time"
      type: "duration"
      description: "Average time to complete full chain execution"
      target: "< 5m"
      alert_threshold: "> 10m"
    
    - metric: "chain_interruption_rate"
      type: "percentage"
      description: "Percentage of chains interrupted before completion"
      target: "< 5%"
      alert_threshold: "> 10%"

  # Agent Performance Metrics
  agent_performance:
    - metric: "agent_response_time"
      type: "duration"
      description: "Average response time per agent"
      target: "< 2m"
      alert_threshold: "> 5m"
    
    - metric: "agent_success_rate"
      type: "percentage"
      description: "Percentage of successful agent executions"
      target: ">= 98%"
      alert_threshold: "< 95%"
    
    - metric: "agent_timeout_rate"
      type: "percentage"
      description: "Percentage of agents timing out"
      target: "< 1%"
      alert_threshold: "> 5%"

  # Trigger System Metrics
  trigger_system:
    - metric: "trigger_accuracy"
      type: "percentage"
      description: "Percentage of triggers that result in relevant agent actions"
      target: ">= 90%"
      alert_threshold: "< 80%"
    
    - metric: "false_positive_rate"
      type: "percentage"
      description: "Percentage of unnecessary triggers"
      target: "< 10%"
      alert_threshold: "> 20%"
    
    - metric: "trigger_latency"
      type: "duration"
      description: "Time between file change and agent trigger"
      target: "< 30s"
      alert_threshold: "> 2m"

# Chain-Specific Monitoring
chain_monitoring:
  backend_security_performance:
    priority: "high"
    sla_target: "< 8m"
    success_rate_target: ">= 95%"
    critical_alerts: true
    components:
      - agent: "backend-architect"
        timeout: "3m"
        expected_deliverables: ["api_analysis", "architecture_recommendations"]
      - agent: "security-specialist"
        timeout: "4m"
        expected_deliverables: ["security_assessment", "vulnerability_scan"]
      - agent: "comprehensive-performance-tester"
        timeout: "5m"
        expected_deliverables: ["performance_metrics", "load_test_results"]

  frontend_quality:
    priority: "high"
    sla_target: "< 6m"
    success_rate_target: ">= 98%"
    critical_alerts: true
    components:
      - agent: "vue-component-architect"
        timeout: "3m"
        expected_deliverables: ["component_analysis", "architecture_review"]
      - agent: "quality-compliance-auditor"
        timeout: "4m"
        expected_deliverables: ["quality_assessment", "compliance_report"]

  migration_performance:
    priority: "critical"
    sla_target: "< 10m"
    success_rate_target: ">= 99%"
    critical_alerts: true
    components:
      - agent: "migration-workflow-orchestrator"
        timeout: "6m"
        expected_deliverables: ["migration_plan", "risk_assessment"]
      - agent: "comprehensive-performance-tester"
        timeout: "8m"
        expected_deliverables: ["migration_performance_analysis", "rollback_validation"]

# Alert Configuration
alerting:
  channels:
    - type: "console"
      enabled: true
      severity_filter: ["warning", "error", "critical"]
    
    - type: "log_file"
      enabled: true
      path: ".claude/agents/monitoring/alerts.log"
      severity_filter: ["warning", "error", "critical"]
    
    - type: "metrics_file"
      enabled: true
      path: ".claude/agents/monitoring/metrics.json"
      update_interval: "5m"

  severity_levels:
    info:
      description: "Informational messages"
      action_required: false
    
    warning:
      description: "Performance degradation or minor issues"
      action_required: false
      escalation_time: "1h"
    
    error:
      description: "Chain failures or significant issues"
      action_required: true
      escalation_time: "15m"
    
    critical:
      description: "System failures or security issues"
      action_required: true
      escalation_time: "immediate"

# Performance Baselines
baselines:
  chain_execution_times:
    backend_security_performance: "7m 30s"
    frontend_quality: "5m 15s"
    migration_performance: "9m 45s"
    deployment_lifecycle: "12m 00s"
  
  agent_response_times:
    backend_architect: "2m 15s"
    vue_component_architect: "2m 45s"
    security_specialist: "3m 30s"
    comprehensive_performance_tester: "4m 15s"
    quality_compliance_auditor: "3m 00s"
    migration_workflow_orchestrator: "5m 30s"

# Health Checks
health_checks:
  chain_health:
    interval: "5m"
    checks:
      - name: "recent_chain_success"
        description: "At least one successful chain in last hour"
        threshold: "1h"
      
      - name: "agent_availability"
        description: "All agents responding to health pings"
        timeout: "30s"
      
      - name: "trigger_system_active"
        description: "Trigger system processing file changes"
        threshold: "5m"

  performance_health:
    interval: "1m"
    checks:
      - name: "average_response_time"
        description: "Agent response times within normal range"
        threshold: "< 5m"
      
      - name: "queue_depth"
        description: "Agent execution queue not backing up"
        threshold: "< 10 pending"
      
      - name: "system_resources"
        description: "System resources available for agent execution"
        cpu_threshold: "< 80%"
        memory_threshold: "< 90%"

# Reporting Configuration
reporting:
  daily_summary:
    enabled: true
    time: "09:00"
    timezone: "UTC"
    recipients: ["development_team"]
    metrics_included:
      - "chain_completion_rate"
      - "average_execution_time"
      - "top_failing_chains"
      - "performance_trends"

  weekly_analysis:
    enabled: true
    day: "monday"
    time: "09:00"
    timezone: "UTC"
    recipients: ["development_team", "tech_leads"]
    analysis_included:
      - "performance_regression_analysis"
      - "trigger_accuracy_trends"
      - "agent_optimization_recommendations"
      - "capacity_planning_insights"

# Data Retention and Cleanup
data_management:
  raw_metrics_retention: "7d"
  aggregated_metrics_retention: "90d"
  alert_history_retention: "30d"
  performance_baselines_retention: "1y"
  
  cleanup_schedule:
    frequency: "daily"
    time: "02:00"
    timezone: "UTC"

# Integration Points
integrations:
  git_hooks:
    enabled: true
    track_trigger_correlation: true
    measure_commit_to_chain_latency: true
  
  ci_cd_pipeline:
    enabled: true
    track_deployment_chains: true
    measure_pre_deployment_validation_time: true
  
  development_tools:
    vscode_extension: false
    cli_metrics: true
    dashboard_url: "http://localhost:3001/agent-metrics"

# Experimental Features
experimental:
  machine_learning_predictions:
    enabled: false
    description: "ML-based prediction of chain success probability"
  
  adaptive_timeouts:
    enabled: false
    description: "Dynamic timeout adjustment based on historical performance"
  
  predictive_alerting:
    enabled: false
    description: "Alert on predicted failures before they occur"