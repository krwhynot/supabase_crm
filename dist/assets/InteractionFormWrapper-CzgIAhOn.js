import{a,b as t,j as s,d as Q,r as W,y as Y,c as E,h,l as k,e as T,n as C,F as O,i as V,u as A,m as H,t as c,v as N,f as U,K as tt,A as et,x as Z,o as ot,G as X,s as st,q as at,k as nt}from"./index-CtjJHjR0.js";import{u as lt}from"./interactionStore-BcF9J0uD.js";import{u as rt}from"./opportunityStore-B1hLuFtx.js";import{Q as it,I as ut,d as dt,e as ct}from"./interactions-BY6_IYFA.js";import{r as pt}from"./BuildingOfficeIcon-DckFZ7iO.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as mt}from"./InformationCircleIcon-1Ldx3HPC.js";import{r as ft}from"./XMarkIcon-D9bsmxiL.js";import{r as bt}from"./ChevronLeftIcon-Co16s6Lq.js";import{r as gt}from"./DocumentIcon-BsH_BoVe.js";import{r as vt}from"./ChevronRightIcon-BkJhkfUA.js";import{r as yt}from"./ExclamationTriangleIcon-BvwA24I5.js";import{r as _t}from"./CheckIcon-B_41sR31.js";function xt(q,D){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"})])}const ht={class:"interaction-step-one space-y-6"},wt={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},kt=["value"],St={key:0,class:"mt-1 text-sm text-red-600"},Dt={class:"mt-1 text-sm text-gray-500"},Ct={key:0,class:"mt-1 text-sm text-red-600"},$t={key:0,class:"mt-1 text-sm text-red-600"},It={class:"mt-1 text-sm text-gray-500"},Et={class:"relative"},Tt=["disabled"],Ot=["value"],Vt={key:0,class:"absolute inset-y-0 right-0 flex items-center pr-3"},Ut={key:0,class:"mt-1 text-sm text-red-600"},At={key:1,class:"mt-3 p-3 bg-blue-50 rounded-md"},Pt={class:"flex items-center"},jt={class:"text-sm font-medium text-blue-900"},Mt={class:"text-sm text-blue-700"},Nt={key:0,class:"border-t pt-6"},qt={class:"grid grid-cols-2 gap-3 sm:grid-cols-4"},Ft=["onClick"],Lt={class:"text-lg mb-1"},Rt={class:"text-xs text-center"},Bt=Q({__name:"InteractionStepOne",props:{formData:{},validation:{},opportunities:{},loading:{type:Boolean,default:!1}},emits:["update:formData","opportunitySelected"],setup(q,{emit:D}){const g=q,v=D,e=W({...g.formData});Y(()=>g.formData,_=>{e.value={..._}},{deep:!0});const y=E(()=>g.opportunities.find(_=>_.id===e.value.opportunity_id)),F=E(()=>!e.value.subject||window.innerWidth<768),j=E(()=>it.filter(_=>_.type===e.value.type)),r=_=>{var p,b;return((p=g.validation.errors.step1)==null?void 0:p.includes(`${_} is required`))||((b=g.validation.errors[_])==null?void 0:b.length)>0},x=_=>{var p,b;return((p=g.validation.errors[_])==null?void 0:p[0])||((b=g.validation.errors.step1)==null?void 0:b.find(m=>m.includes(_)))},M=_=>({Email:"Email communication or email campaign",Phone:"Phone call or voice conversation",Meeting:"Face-to-face meeting or site visit",Demo:"Product demonstration or presentation",Proposal:"Business proposal or quote",Contract:"Contract discussion or signing",Note:"Internal note or documentation",Task:"Task or follow-up action",Event:"Sample drop-off or delivery",Social:"Social media interaction",Website:"Website or online interaction",Other:"Follow-up contact or check-in"})[_]||"",w=()=>{v("update:formData",{type:e.value.type})},$=()=>{v("update:formData",{subject:e.value.subject})},L=()=>{v("update:formData",{interaction_date:e.value.interaction_date})},R=()=>{v("update:formData",{opportunity_id:e.value.opportunity_id}),v("opportunitySelected",e.value.opportunity_id)},z=_=>{e.value.type=_.type,e.value.subject=_.subject_template,v("update:formData",{type:_.type,subject:_.subject_template})};return(_,p)=>(s(),a("div",ht,[t("div",wt,[t("div",null,[p[4]||(p[4]=t("label",{for:"interaction-type",class:"block text-sm font-medium text-gray-700 mb-2"},[T(" Interaction Type "),t("span",{class:"text-red-500"},"*")],-1)),k(t("select",{id:"interaction-type","onUpdate:modelValue":p[0]||(p[0]=b=>e.value.type=b),onChange:w,class:C(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":r("type")}])},[(s(!0),a(O,null,V(A(ut),b=>(s(),a("option",{key:b.value,value:b.value},c(b.label),9,kt))),128))],34),[[H,e.value.type]]),r("type")?(s(),a("p",St,c(x("type")),1)):h("",!0),t("p",Dt,c(M(e.value.type)),1)]),t("div",null,[p[5]||(p[5]=t("label",{for:"interaction-date",class:"block text-sm font-medium text-gray-700 mb-2"},[T(" Date & Time "),t("span",{class:"text-red-500"},"*")],-1)),k(t("input",{id:"interaction-date",type:"datetime-local","onUpdate:modelValue":p[1]||(p[1]=b=>e.value.interaction_date=b),onInput:L,class:C(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":r("interaction_date")}])},null,34),[[N,e.value.interaction_date]]),r("interaction_date")?(s(),a("p",Ct,c(x("interaction_date")),1)):h("",!0)])]),t("div",null,[p[6]||(p[6]=t("label",{for:"subject",class:"block text-sm font-medium text-gray-700 mb-2"},[T(" Subject "),t("span",{class:"text-red-500"},"*")],-1)),k(t("input",{id:"subject",type:"text","onUpdate:modelValue":p[2]||(p[2]=b=>e.value.subject=b),onInput:$,placeholder:"Brief description of the interaction",class:C(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":r("subject")}]),maxlength:"255"},null,34),[[N,e.value.subject]]),r("subject")?(s(),a("p",$t,c(x("subject")),1)):h("",!0),t("p",It,c(e.value.subject.length)+"/255 characters ",1)]),t("div",null,[p[9]||(p[9]=t("label",{for:"opportunity",class:"block text-sm font-medium text-gray-700 mb-2"},[T(" Related Opportunity "),t("span",{class:"text-red-500"},"*")],-1)),t("div",Et,[k(t("select",{id:"opportunity","onUpdate:modelValue":p[3]||(p[3]=b=>e.value.opportunity_id=b),onChange:R,class:C(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":r("opportunity_id")}]),disabled:_.loading},[p[7]||(p[7]=t("option",{value:""},"Select an opportunity...",-1)),(s(!0),a(O,null,V(_.opportunities,b=>(s(),a("option",{key:b.id,value:b.id},c(b.name)+" - "+c(b.organization_name),9,Ot))),128))],42,Tt),[[H,e.value.opportunity_id]]),_.loading?(s(),a("div",Vt,p[8]||(p[8]=[t("svg",{class:"animate-spin h-4 w-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):h("",!0)]),r("opportunity_id")?(s(),a("p",Ut,c(x("opportunity_id")),1)):h("",!0),y.value?(s(),a("div",At,[t("div",Pt,[U(A(pt),{class:"h-5 w-5 text-blue-400 mr-2"}),t("div",null,[t("p",jt,c(y.value.name),1),t("p",Mt,c(y.value.organization_name)+" â€¢ Stage: "+c(y.value.stage),1)])])])):h("",!0)]),F.value?(s(),a("div",Nt,[p[10]||(p[10]=t("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"Quick Templates",-1)),t("div",qt,[(s(!0),a(O,null,V(j.value,b=>(s(),a("button",{key:b.id,type:"button",onClick:m=>z(b),class:"flex flex-col items-center p-3 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"},[t("span",Lt,c(b.icon),1),t("span",Rt,c(b.label),1)],8,Ft))),128))])])):h("",!0)]))}}),Wt=J(Bt,[["__scopeId","data-v-a3b33e19"]]),zt={class:"interaction-step-two space-y-6"},Ht={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},Kt=["value"],Gt={key:0,class:"mt-1 text-sm text-red-600"},Qt={key:0,class:"mt-1 text-sm text-red-600"},Yt={key:0},Jt={for:"location",class:"block text-sm font-medium text-gray-700 mb-2"},Xt={key:0,class:"text-red-500"},Zt={key:0,class:"mt-1 text-sm text-red-600"},te={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},ee=["value"],oe={key:1,class:"bg-blue-50 rounded-lg p-4"},se={class:"flex"},ae={class:"space-y-2"},ne={class:"text-sm text-blue-800"},le=["onClick"],re={key:2,class:"border-t pt-6"},ie={key:3,class:"border-t pt-6"},ue={key:4,class:"border-t pt-6"},de=Q({__name:"InteractionStepTwo",props:{formData:{},validation:{},interactionType:{}},emits:["update:formData"],setup(q,{emit:D}){const g=q,v=D,e=W({...g.formData}),y=W(1);Y(()=>g.formData,m=>{var n;e.value={...m},y.value=((n=m.participants)==null?void 0:n.length)||1},{deep:!0});const F=[{value:"SCHEDULED",label:"Scheduled"},{value:"COMPLETED",label:"Completed"},{value:"CANCELLED",label:"Cancelled"},{value:"NO_SHOW",label:"No Show"}],j=["Phone","Email","Video Call","In Person","Text","Social Media","Other"],r=E(()=>["Meeting","Demo","Event"].includes(g.interactionType)),x=E(()=>M.value.length>0),M=E(()=>{const m=[];if(!e.value.duration_minutes){const u={Email:null,Phone:15,Meeting:60,Demo:45,Proposal:30,Contract:45,Note:null,Task:15,Event:15,Social:null,Website:null,Other:20}[g.interactionType];u&&m.push({field:"duration_minutes",label:`Set duration to ${u} minutes`,value:u})}if(!e.value.contact_method){const u={Email:"Email",Phone:"Phone",Meeting:"In Person",Demo:"In Person",Proposal:"Email",Contract:"In Person",Note:"Other",Task:"Phone",Event:"In Person",Social:"Social Media",Website:"Other",Other:"Phone"}[g.interactionType];u&&m.push({field:"contact_method",label:`Set contact method to ${u}`,value:u})}return m}),w=m=>{var n,u;return((n=g.validation.errors.step2)==null?void 0:n.some(B=>B.includes(m)))||((u=g.validation.errors[m])==null?void 0:u.length)>0},$=m=>{var n,u;return((n=g.validation.errors[m])==null?void 0:n[0])||((u=g.validation.errors.step2)==null?void 0:u.find(B=>B.includes(m)))},L=()=>{v("update:formData",{status:e.value.status})},R=()=>{v("update:formData",{duration_minutes:e.value.duration_minutes})},z=()=>{v("update:formData",{location:e.value.location})},_=()=>{v("update:formData",{contact_method:e.value.contact_method})},p=()=>{const m=Array.from({length:y.value},(n,u)=>`Participant ${u+1}`);e.value.participants=m,v("update:formData",{participants:m})},b=m=>{m.field==="duration_minutes"?(e.value.duration_minutes=m.value,v("update:formData",{duration_minutes:m.value})):m.field==="contact_method"&&(e.value.contact_method=m.value,v("update:formData",{contact_method:m.value}))};return(m,n)=>(s(),a("div",zt,[t("div",Ht,[t("div",null,[n[5]||(n[5]=t("label",{for:"status",class:"block text-sm font-medium text-gray-700 mb-2"},[T(" Status "),t("span",{class:"text-red-500"},"*")],-1)),k(t("select",{id:"status","onUpdate:modelValue":n[0]||(n[0]=u=>e.value.status=u),onChange:L,class:C(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":w("status")}])},[(s(),a(O,null,V(F,u=>t("option",{key:u.value,value:u.value},c(u.label),9,Kt)),64))],34),[[H,e.value.status]]),w("status")?(s(),a("p",Gt,c($("status")),1)):h("",!0)]),t("div",null,[n[6]||(n[6]=t("label",{for:"duration",class:"block text-sm font-medium text-gray-700 mb-2"}," Duration (minutes) ",-1)),k(t("input",{id:"duration",type:"number","onUpdate:modelValue":n[1]||(n[1]=u=>e.value.duration_minutes=u),onInput:R,placeholder:"e.g., 30",min:"1",max:"480",class:C(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":w("duration_minutes")}])},null,34),[[N,e.value.duration_minutes,void 0,{number:!0}]]),w("duration_minutes")?(s(),a("p",Qt,c($("duration_minutes")),1)):h("",!0),n[7]||(n[7]=t("p",{class:"mt-1 text-sm text-gray-500"}," Leave blank if duration is not applicable ",-1))])]),r.value?(s(),a("div",Yt,[t("label",Jt,[n[8]||(n[8]=T(" Location ",-1)),m.interactionType==="Meeting"?(s(),a("span",Xt,"*")):h("",!0)]),k(t("input",{id:"location",type:"text","onUpdate:modelValue":n[2]||(n[2]=u=>e.value.location=u),onInput:z,placeholder:"Meeting location, address, or venue",class:C(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":w("location")}]),maxlength:"255"},null,34),[[N,e.value.location]]),w("location")?(s(),a("p",Zt,c($("location")),1)):h("",!0)])):h("",!0),t("div",te,[t("div",null,[n[10]||(n[10]=t("label",{for:"contact-method",class:"block text-sm font-medium text-gray-700 mb-2"}," Contact Method ",-1)),k(t("select",{id:"contact-method","onUpdate:modelValue":n[3]||(n[3]=u=>e.value.contact_method=u),onChange:_,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[n[9]||(n[9]=t("option",{value:""},"Select method...",-1)),(s(),a(O,null,V(j,u=>t("option",{key:u,value:u},c(u),9,ee)),64))],544),[[H,e.value.contact_method]]),n[11]||(n[11]=t("p",{class:"mt-1 text-sm text-gray-500"}," How was this interaction conducted? ",-1))]),t("div",null,[n[12]||(n[12]=t("label",{for:"participant-count",class:"block text-sm font-medium text-gray-700 mb-2"}," Number of Participants ",-1)),k(t("input",{id:"participant-count",type:"number","onUpdate:modelValue":n[4]||(n[4]=u=>y.value=u),onInput:p,placeholder:"1",min:"1",max:"20",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,544),[[N,y.value,void 0,{number:!0}]]),n[13]||(n[13]=t("p",{class:"mt-1 text-sm text-gray-500"}," Total people involved in this interaction ",-1))])]),x.value?(s(),a("div",oe,[t("div",se,[U(A(xt),{class:"h-5 w-5 text-blue-400 mt-0.5 mr-3"}),t("div",null,[n[14]||(n[14]=t("h4",{class:"text-sm font-medium text-blue-900 mb-2"},"Smart Suggestions",-1)),t("div",ae,[(s(!0),a(O,null,V(M.value,u=>(s(),a("div",{key:u.field,class:"flex items-center justify-between"},[t("span",ne,c(u.label),1),t("button",{type:"button",onClick:B=>b(u),class:"text-sm text-blue-600 hover:text-blue-800 font-medium"}," Apply ",8,le)]))),128))])])])])):h("",!0),m.interactionType==="Email"?(s(),a("div",re,n[15]||(n[15]=[t("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"Email Details",-1),t("div",{class:"text-sm text-gray-500"},[t("p",null,"â€¢ Duration is typically not applicable for emails"),t("p",null,"â€¢ Consider follow-up requirements for important emails")],-1)]))):m.interactionType==="Demo"?(s(),a("div",ie,n[16]||(n[16]=[t("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"Demo Details",-1),t("div",{class:"text-sm text-gray-500"},[t("p",null,"â€¢ Consider setting duration to 45-60 minutes for product demos"),t("p",null,"â€¢ Location helps track whether it's on-site or virtual"),t("p",null,"â€¢ Multiple participants are common for demos")],-1)]))):m.interactionType==="Event"?(s(),a("div",ue,n[17]||(n[17]=[t("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"Sample Delivery Details",-1),t("div",{class:"text-sm text-gray-500"},[t("p",null,"â€¢ Duration is typically short (10-15 minutes)"),t("p",null,"â€¢ Location is important for delivery tracking"),t("p",null,"â€¢ Consider scheduling follow-up for feedback")],-1)]))):h("",!0)]))}}),ce=J(de,[["__scopeId","data-v-d495ae2f"]]),pe={class:"interaction-step-three space-y-6"},me={key:0,class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},fe=["value"],be={key:0,class:"mt-1 text-sm text-red-600"},ge=["value"],ve={key:0,class:"mt-1 text-sm text-red-600"},ye={key:0,class:"mt-1 text-sm text-red-600"},_e={class:"mt-1 text-sm text-gray-500"},xe={class:"border-t pt-6"},he={class:"flex items-center mb-4"},we={key:0,class:"space-y-4 pl-6"},ke=["min"],Se={key:0,class:"mt-1 text-sm text-red-600"},De={class:"mt-1 text-sm text-gray-500"},Ce=["value"],$e={class:"flex flex-wrap gap-2 mb-2"},Ie=["onClick"],Ee={class:"flex"},Te={key:1,class:"bg-gray-50 rounded-lg p-4"},Oe={class:"flex"},Ve={class:"space-y-2"},Ue={class:"text-sm text-gray-700"},Ae=["onClick"],Pe=Q({__name:"InteractionStepThree",props:{formData:{},validation:{},status:{}},emits:["update:formData"],setup(q,{emit:D}){const g=q,v=D,e=W({...g.formData}),y=W("");Y(()=>g.formData,f=>{e.value={...f}},{deep:!0});const F=[{value:1,label:"1 - Poor"},{value:2,label:"2 - Below Average"},{value:3,label:"3 - Average"},{value:4,label:"4 - Good"},{value:5,label:"5 - Excellent"}],j=["Schedule Follow-up Call","Send Information","Prepare Proposal","Schedule Demo","Send Samples","Schedule Site Visit","Internal Discussion","Wait for Customer Response","Update Opportunity Stage","Close Opportunity"],r=E(()=>new Date().toISOString().slice(0,16)),x=E(()=>g.status==="COMPLETED"&&e.value.outcome),M=E(()=>{const f=e.value.outcome;return f?{POSITIVE:[{description:"Schedule follow-up to maintain momentum",action:"follow_up"},{description:"Consider updating opportunity stage",action:null},{description:"Add positive interaction tag",action:"tag_positive"}],NEUTRAL:[{description:"Schedule follow-up to address concerns",action:"follow_up"},{description:"Consider sending additional information",action:null},{description:"Add neutral interaction tag",action:"tag_neutral"}],NEGATIVE:[{description:"Schedule follow-up to address issues",action:"follow_up"},{description:"Consider internal team discussion",action:null},{description:"Add negative interaction tag",action:"tag_negative"}],NEEDS_FOLLOW_UP:[{description:"Schedule immediate follow-up",action:"follow_up"},{description:"Set next action as priority",action:null},{description:"Add follow-up required tag",action:"tag_followup"}]}[f]||[]:[]}),w=f=>{var o,S;return((o=g.validation.errors.step3)==null?void 0:o.some(I=>I.includes(f)))||((S=g.validation.errors[f])==null?void 0:S.length)>0},$=f=>{var o,S;return((o=g.validation.errors[f])==null?void 0:o[0])||((S=g.validation.errors.step3)==null?void 0:S.find(I=>I.includes(f)))},L=()=>{v("update:formData",{outcome:e.value.outcome})},R=()=>{v("update:formData",{rating:e.value.rating})},z=()=>{v("update:formData",{notes:e.value.notes})},_=()=>{const f={follow_up_required:e.value.follow_up_required};e.value.follow_up_required||(f.follow_up_date=null,f.follow_up_notes="",f.next_action="",e.value.follow_up_date=null,e.value.follow_up_notes="",e.value.next_action=""),v("update:formData",f)},p=()=>{v("update:formData",{follow_up_date:e.value.follow_up_date})},b=()=>{v("update:formData",{follow_up_notes:e.value.follow_up_notes})},m=()=>{v("update:formData",{next_action:e.value.next_action})},n=()=>{var o;const f=y.value.trim().replace(",","");if(f&&!((o=e.value.tags)!=null&&o.includes(f))){const S=[...e.value.tags||[],f];e.value.tags=S,v("update:formData",{tags:S})}y.value=""},u=f=>{f.key===","&&(f.preventDefault(),n())},B=f=>{const o=(e.value.tags||[]).filter(S=>S!==f);e.value.tags=o,v("update:formData",{tags:o})},G=f=>{var o,S;if(f.action==="follow_up"){e.value.follow_up_required=!0;const I=new Date;I.setDate(I.getDate()+7),e.value.follow_up_date=I.toISOString().slice(0,16),v("update:formData",{follow_up_required:!0,follow_up_date:e.value.follow_up_date})}else if((o=f.action)!=null&&o.startsWith("tag_")){const d=`${f.action.replace("tag_","")}-interaction`;if(!((S=e.value.tags)!=null&&S.includes(d))){const l=[...e.value.tags||[],d];e.value.tags=l,v("update:formData",{tags:l})}}};return e.value.tags||(e.value.tags=[],v("update:formData",{tags:[]})),(f,o)=>{var S,I;return s(),a("div",pe,[f.status==="COMPLETED"?(s(),a("div",me,[t("div",null,[o[9]||(o[9]=t("label",{for:"outcome",class:"block text-sm font-medium text-gray-700 mb-2"},[T(" Outcome "),t("span",{class:"text-red-500"},"*")],-1)),k(t("select",{id:"outcome","onUpdate:modelValue":o[0]||(o[0]=d=>e.value.outcome=d),onChange:L,class:C(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":w("outcome")}])},[o[8]||(o[8]=t("option",{value:""},"Select outcome...",-1)),(s(!0),a(O,null,V(A(dt),d=>(s(),a("option",{key:d.value,value:d.value},c(d.label),9,fe))),128))],34),[[H,e.value.outcome]]),w("outcome")?(s(),a("p",be,c($("outcome")),1)):h("",!0)]),t("div",null,[o[11]||(o[11]=t("label",{for:"rating",class:"block text-sm font-medium text-gray-700 mb-2"}," Rating (1-5) ",-1)),k(t("select",{id:"rating","onUpdate:modelValue":o[1]||(o[1]=d=>e.value.rating=d),onChange:R,class:C(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":w("rating")}])},[o[10]||(o[10]=t("option",{value:null},"Select rating...",-1)),(s(),a(O,null,V(F,d=>t("option",{key:d.value,value:d.value},c(d.label),9,ge)),64))],34),[[H,e.value.rating,void 0,{number:!0}]]),w("rating")?(s(),a("p",ve,c($("rating")),1)):h("",!0),o[12]||(o[12]=t("p",{class:"mt-1 text-sm text-gray-500"}," Rate the effectiveness of this interaction ",-1))])])):h("",!0),t("div",null,[o[13]||(o[13]=t("label",{for:"notes",class:"block text-sm font-medium text-gray-700 mb-2"}," Notes ",-1)),k(t("textarea",{id:"notes","onUpdate:modelValue":o[2]||(o[2]=d=>e.value.notes=d),onInput:z,rows:"4",placeholder:"Additional notes about this interaction...",class:C(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":w("notes")}]),maxlength:"2000"},null,34),[[N,e.value.notes]]),w("notes")?(s(),a("p",ye,c($("notes")),1)):h("",!0),t("p",_e,c(((S=e.value.notes)==null?void 0:S.length)||0)+"/2000 characters ",1)]),t("div",xe,[o[19]||(o[19]=t("h4",{class:"text-sm font-medium text-gray-700 mb-4"},"Follow-up Planning",-1)),t("div",he,[k(t("input",{id:"follow-up-required","onUpdate:modelValue":o[3]||(o[3]=d=>e.value.follow_up_required=d),onChange:_,type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,544),[[tt,e.value.follow_up_required]]),o[14]||(o[14]=t("label",{for:"follow-up-required",class:"ml-2 block text-sm text-gray-700"}," This interaction requires follow-up ",-1))]),e.value.follow_up_required?(s(),a("div",we,[t("div",null,[o[15]||(o[15]=t("label",{for:"follow-up-date",class:"block text-sm font-medium text-gray-700 mb-2"},[T(" Follow-up Date "),t("span",{class:"text-red-500"},"*")],-1)),k(t("input",{id:"follow-up-date",type:"datetime-local","onUpdate:modelValue":o[4]||(o[4]=d=>e.value.follow_up_date=d),onInput:p,min:r.value,class:C(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":w("follow_up_date")}])},null,42,ke),[[N,e.value.follow_up_date]]),w("follow_up_date")?(s(),a("p",Se,c($("follow_up_date")),1)):h("",!0)]),t("div",null,[o[16]||(o[16]=t("label",{for:"follow-up-notes",class:"block text-sm font-medium text-gray-700 mb-2"}," Follow-up Notes ",-1)),k(t("textarea",{id:"follow-up-notes","onUpdate:modelValue":o[5]||(o[5]=d=>e.value.follow_up_notes=d),onInput:b,rows:"3",placeholder:"What needs to be done in the follow-up?",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",maxlength:"500"},null,544),[[N,e.value.follow_up_notes]]),t("p",De,c(((I=e.value.follow_up_notes)==null?void 0:I.length)||0)+"/500 characters ",1)]),t("div",null,[o[18]||(o[18]=t("label",{for:"next-action",class:"block text-sm font-medium text-gray-700 mb-2"}," Next Action ",-1)),k(t("select",{id:"next-action","onUpdate:modelValue":o[6]||(o[6]=d=>e.value.next_action=d),onChange:m,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[o[17]||(o[17]=t("option",{value:""},"Select next action...",-1)),(s(),a(O,null,V(j,d=>t("option",{key:d,value:d},c(d),9,Ce)),64))],544),[[H,e.value.next_action]])])])):h("",!0)]),t("div",null,[o[20]||(o[20]=t("label",{for:"tags",class:"block text-sm font-medium text-gray-700 mb-2"}," Tags ",-1)),t("div",$e,[(s(!0),a(O,null,V(e.value.tags,d=>(s(),a("span",{key:d,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},[T(c(d)+" ",1),t("button",{type:"button",onClick:l=>B(d),class:"flex-shrink-0 ml-1.5 h-4 w-4 rounded-full inline-flex items-center justify-center text-blue-400 hover:bg-blue-200 hover:text-blue-500 focus:outline-none focus:bg-blue-500 focus:text-white"},[U(A(ft),{class:"h-3 w-3"})],8,Ie)]))),128))]),t("div",Ee,[k(t("input",{"onUpdate:modelValue":o[7]||(o[7]=d=>y.value=d),onKeyup:et(n,["enter"]),onKeydown:u,type:"text",placeholder:"Add tag and press Enter",class:"flex-1 rounded-l-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",maxlength:"50"},null,544),[[N,y.value]]),t("button",{type:"button",onClick:n,class:"inline-flex items-center px-3 py-2 border border-l-0 border-gray-300 rounded-r-md bg-gray-50 text-gray-500 text-sm hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"}," Add ")]),o[21]||(o[21]=t("p",{class:"mt-1 text-sm text-gray-500"}," Use tags to categorize and search interactions later ",-1))]),x.value?(s(),a("div",Te,[t("div",Oe,[U(A(mt),{class:"h-5 w-5 text-gray-400 mt-0.5 mr-3"}),t("div",null,[o[22]||(o[22]=t("h4",{class:"text-sm font-medium text-gray-900 mb-2"},"Recommended Next Steps",-1)),t("div",Ve,[(s(!0),a(O,null,V(M.value,d=>(s(),a("div",{key:d.action||"default",class:"flex items-center justify-between"},[t("span",Ue,c(d.description),1),d.action?(s(),a("button",{key:0,type:"button",onClick:l=>G(d),class:"text-sm text-blue-600 hover:text-blue-800 font-medium"}," Apply ",8,Ae)):h("",!0)]))),128))])])])])):h("",!0)])}}}),je=J(Pe,[["__scopeId","data-v-55a81276"]]),Me={class:"interaction-form-wrapper"},Ne={class:"mb-8"},qe={class:"text-2xl font-bold text-gray-900 mb-2"},Fe={class:"text-gray-600"},Le={class:"mb-8"},Re={"aria-label":"Progress"},Be={class:"flex items-center"},We={class:"flex items-center"},ze={key:1},He={class:"space-y-6"},Ke={class:"space-y-6"},Ge={class:"space-y-6"},Qe={class:"flex justify-between pt-6 border-t border-gray-200"},Ye={key:1},Je={class:"flex space-x-3"},Xe=["disabled"],Ze=["disabled"],to=["disabled"],eo={key:0,class:"flex items-center"},oo={key:1},so={key:0,class:"mt-6 rounded-md bg-red-50 p-4"},ao={class:"flex"},no={class:"ml-3"},lo={class:"mt-2 text-sm text-red-700"},ro=Q({__name:"InteractionFormWrapper",props:{interactionId:{},opportunityId:{},isEditing:{type:Boolean,default:!1}},setup(q){const D=q,g=lt(),v=rt(),e=nt(),y=W(1),F=W([]),j=W(!1),r=Z({step1:{type:"Phone",subject:"",opportunity_id:D.opportunityId||"",interaction_date:new Date().toISOString().slice(0,16)},step2:{status:"SCHEDULED",duration_minutes:null,location:null,contact_method:null,participants:[]},step3:{outcome:null,rating:null,notes:"",follow_up_required:!1,follow_up_date:null,follow_up_notes:"",next_action:"",tags:[],attachments:[],custom_fields:null}}),x=Z({isValid:!1,errors:{},warnings:{},touched:{},step1Valid:!1,step2Valid:!1,step3Valid:!1}),M=[{id:"basic",name:"Basic Info"},{id:"details",name:"Details"},{id:"outcome",name:"Outcome"}],w=E(()=>g.creating),$=E(()=>g.error),L=E(()=>{switch(y.value){case 1:return x.step1Valid;case 2:return x.step2Valid;case 3:return x.step3Valid;default:return!1}}),R=E(()=>x.step1Valid&&x.step2Valid&&x.step3Valid),z=l=>_(l)||y.value===l?"bg-blue-600 text-white":"bg-gray-300 text-gray-500",_=l=>{switch(l){case 1:return x.step1Valid&&y.value>1;case 2:return x.step2Valid&&y.value>2;case 3:return x.step3Valid;default:return!1}},p=()=>{y.value<3&&L.value&&y.value++},b=()=>{y.value>1&&y.value--},m=l=>{Object.assign(r.step1,l),G()},n=l=>{Object.assign(r.step2,l),f()},u=l=>{Object.assign(r.step3,l),o()},B=l=>{r.step1.opportunity_id=l,G()},G=()=>{const l=[];(!r.step1.subject||r.step1.subject.length<3)&&l.push("Subject must be at least 3 characters"),r.step1.opportunity_id||l.push("Opportunity must be selected"),r.step1.interaction_date||l.push("Interaction date is required"),x.step1Valid=l.length===0,x.errors.step1=l},f=()=>{const l=[];r.step2.status||l.push("Status is required"),r.step1.type==="Meeting"&&!r.step2.location&&l.push("Location is required for in-person meetings"),r.step2.duration_minutes&&(r.step2.duration_minutes<1||r.step2.duration_minutes>480)&&l.push("Duration must be between 1 and 480 minutes"),x.step2Valid=l.length===0,x.errors.step2=l},o=()=>{const l=[];r.step2.status==="COMPLETED"&&!r.step3.outcome&&l.push("Outcome is required for completed interactions"),r.step3.follow_up_required&&!r.step3.follow_up_date&&l.push("Follow-up date is required when follow-up is needed"),r.step3.rating&&(r.step3.rating<1||r.step3.rating>5)&&l.push("Rating must be between 1 and 5"),x.step3Valid=l.length===0,x.errors.step3=l};Y(()=>r.step1.type,l=>{const i=ct[l];i&&(Object.assign(r.step2,i),f())}),ot(async()=>{j.value=!0;try{await v.fetchOpportunities({},{page:1,limit:100,sort_by:"created_at",sort_order:"desc"}),F.value=v.opportunities}catch(l){console.error("Failed to load opportunities:",l)}finally{j.value=!1}D.isEditing&&D.interactionId&&await S(),G(),f(),o()});const S=async()=>{if(D.interactionId)try{await g.fetchInteractionById(D.interactionId);const l=g.selectedInteraction;if(l){const i=l;r.step1={type:i.type,subject:i.subject||"",opportunity_id:i.opportunity_id,interaction_date:i.interaction_date.slice(0,16)};const P=Array.isArray(i.participants)?i.participants:[];r.step2={status:i.status||"SCHEDULED",duration_minutes:i.duration_minutes,location:i.location,contact_method:i.contact_method,participants:P},r.step3={outcome:i.outcome,rating:i.rating,notes:i.notes||"",follow_up_required:i.follow_up_required||!1,follow_up_date:i.follow_up_date,follow_up_notes:i.follow_up_notes||"",next_action:i.next_action||"",tags:Array.isArray(i.tags)?i.tags:[],attachments:Array.isArray(i.attachments)?i.attachments:[],custom_fields:i.custom_fields}}}catch(l){console.error("Failed to load interaction:",l)}},I=async()=>{if(!R.value)return;const l={...r.step1,...r.step2,...r.step3};try{let i=!1;D.isEditing&&D.interactionId?i=await g.updateInteraction(D.interactionId,l):i=await g.createInteraction(l),i&&(D.opportunityId?e.push(`/opportunities/${D.opportunityId}`):e.push("/interactions"))}catch(i){console.error("Form submission failed:",i)}},d=async()=>{console.log("Saving draft...",r)};return(l,i)=>(s(),a("div",Me,[t("div",Ne,[t("h2",qe,c(l.isEditing?"Edit Interaction":"New Interaction"),1),t("p",Fe,c(l.isEditing?"Update interaction details":"Record a new customer interaction"),1)]),t("div",Le,[t("nav",Re,[t("ol",Be,[(s(),a(O,null,V(M,(P,K)=>t("li",{key:P.id,class:"relative"},[t("div",We,[t("div",{class:C(["flex h-8 w-8 items-center justify-center rounded-full text-sm font-medium",z(K+1)])},[_(K+1)?(s(),at(A(_t),{key:0,class:"h-5 w-5"})):(s(),a("span",ze,c(K+1),1))],2),t("span",{class:C(["ml-3 text-sm font-medium",y.value===K+1?"text-blue-600":"text-gray-500"])},c(P.name),3)]),K<M.length-1?(s(),a("div",{key:0,class:C(["absolute left-4 top-8 h-6 w-0.5",_(K+1)?"bg-blue-600":"bg-gray-300"])},null,2)):h("",!0)])),64))])])]),t("form",{onSubmit:st(I,["prevent"]),class:"space-y-6"},[k(t("div",He,[U(Wt,{"form-data":r.step1,"onUpdate:formData":[i[0]||(i[0]=P=>r.step1=P),m],validation:x,opportunities:F.value,loading:j.value,onOpportunitySelected:B},null,8,["form-data","validation","opportunities","loading"])],512),[[X,y.value===1]]),k(t("div",Ke,[U(ce,{"form-data":r.step2,"onUpdate:formData":[i[1]||(i[1]=P=>r.step2=P),n],validation:x,"interaction-type":r.step1.type},null,8,["form-data","validation","interaction-type"])],512),[[X,y.value===2]]),k(t("div",Ge,[U(je,{"form-data":r.step3,"onUpdate:formData":[i[2]||(i[2]=P=>r.step3=P),u],validation:x,status:r.step2.status},null,8,["form-data","validation","status"])],512),[[X,y.value===3]]),t("div",Qe,[y.value>1?(s(),a("button",{key:0,type:"button",onClick:b,class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[U(A(bt),{class:"h-4 w-4 mr-2"}),i[3]||(i[3]=T(" Previous ",-1))])):(s(),a("div",Ye)),t("div",Je,[!l.isEditing&&y.value===3?(s(),a("button",{key:0,type:"button",onClick:d,disabled:w.value,class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[U(A(gt),{class:"h-4 w-4 mr-2"}),i[4]||(i[4]=T(" Save Draft ",-1))],8,Xe)):h("",!0),y.value<3?(s(),a("button",{key:1,type:"button",onClick:p,disabled:!L.value,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[i[5]||(i[5]=T(" Next ",-1)),U(A(vt),{class:"h-4 w-4 ml-2"})],8,Ze)):(s(),a("button",{key:2,type:"submit",disabled:!R.value||w.value,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[w.value?(s(),a("span",eo,[i[6]||(i[6]=t("svg",{class:"animate-spin -ml-1 mr-3 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),T(" "+c(l.isEditing?"Updating...":"Creating..."),1)])):(s(),a("span",oo,c(l.isEditing?"Update Interaction":"Create Interaction"),1))],8,to))])])],32),$.value?(s(),a("div",so,[t("div",ao,[U(A(yt),{class:"h-5 w-5 text-red-400"}),t("div",no,[i[7]||(i[7]=t("h3",{class:"text-sm font-medium text-red-800"},"Error",-1)),t("div",lo,c($.value),1)])])])):h("",!0)]))}}),wo=J(ro,[["__scopeId","data-v-811bad0d"]]);export{wo as I};
//# sourceMappingURL=InteractionFormWrapper-CzgIAhOn.js.map
