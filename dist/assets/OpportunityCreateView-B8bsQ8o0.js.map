{"version":3,"file":"OpportunityCreateView-B8bsQ8o0.js","sources":["../../src/views/opportunities/OpportunityCreateView.vue"],"sourcesContent":["<template>\n  <div class=\"opportunity-create-view\">\n      <!-- Page Header -->\n      <div class=\"mb-8\">\n        <!-- Breadcrumb Navigation -->\n        <nav class=\"flex mb-4\" aria-label=\"Breadcrumb\">\n          <ol class=\"inline-flex items-center space-x-1 md:space-x-3\">\n            <li class=\"inline-flex items-center\">\n              <router-link\n                to=\"/\"\n                class=\"inline-flex items-center text-sm font-medium text-gray-700 hover:text-primary-600\"\n              >\n                <svg class=\"w-3 h-3 mr-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path d=\"m19.707 9.293-2-2-7-7a1 1 0 0 0-1.414 0l-7 7-2 2a1 1 0 0 0 1.414 1.414L2 10.414V18a2 2 0 0 0 2 2h3a1 1 0 0 0 1-1v-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v4a1 1 0 0 0 1 1h3a2 2 0 0 0 2-2v-7.586l.293.293a1 1 0 0 0 1.414-1.414Z\"/>\n                </svg>\n                Dashboard\n              </router-link>\n            </li>\n            <li>\n              <div class=\"flex items-center\">\n                <svg class=\"w-3 h-3 text-gray-400 mx-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m9 5 7 7-7 7\"></path>\n                </svg>\n                <router-link\n                  to=\"/opportunities\"\n                  class=\"ml-1 text-sm font-medium text-gray-700 hover:text-primary-600 md:ml-2\"\n                >\n                  Opportunities\n                </router-link>\n              </div>\n            </li>\n            <li aria-current=\"page\">\n              <div class=\"flex items-center\">\n                <svg class=\"w-3 h-3 text-gray-400 mx-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m9 5 7 7-7 7\"></path>\n                </svg>\n                <span class=\"ml-1 text-sm font-medium text-gray-500 md:ml-2\">New Opportunity</span>\n              </div>\n            </li>\n          </ol>\n        </nav>\n\n        <!-- Header Content -->\n        <div class=\"flex items-center space-x-3 mb-4\">\n          <router-link\n            to=\"/opportunities\"\n            class=\"inline-flex items-center text-gray-500 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 rounded-md p-1\"\n            :aria-label=\"'Back to opportunities list'\"\n          >\n            <svg class=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 19l-7-7 7-7\" />\n            </svg>\n          </router-link>\n          <div>\n            <h1 class=\"text-3xl font-bold text-gray-900\" data-testid=\"page-title\">Create New Opportunity</h1>\n            <p class=\"mt-2 text-gray-600\">\n              Set up a new sales opportunity with auto-naming, multi-principal support, and stage tracking.\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <!-- Opportunity Form -->\n      <div class=\"max-w-4xl\" data-testid=\"opportunity-form-container\">\n        <OpportunityFormWrapper\n          :is-editing=\"false\"\n          :initial-data=\"contextData\"\n          @success=\"handleSuccess\"\n          @cancel=\"handleCancel\"\n          @error=\"handleError\"\n          data-testid=\"opportunity-form\"\n        />\n      </div>\n      \n      <!-- Error Display -->\n      <div v-if=\"submitError\" class=\"mt-6 max-w-4xl\">\n        <div class=\"p-4 border border-red-300 rounded-md bg-red-50\">\n          <div class=\"flex\">\n            <svg class=\"h-5 w-5 text-red-400 mr-2 mt-0.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n            <div>\n              <h3 class=\"text-sm font-medium text-red-800\">Error creating opportunity</h3>\n              <p class=\"mt-1 text-sm text-red-700\">{{ submitError }}</p>\n              <div class=\"mt-3\">\n                <button\n                  @click=\"clearError\"\n                  class=\"text-sm font-medium text-red-800 hover:text-red-900 focus:outline-none focus:ring-2 focus:ring-red-500 rounded-md px-2 py-1\"\n                >\n                  Dismiss\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Success Message (shown briefly before navigation) -->\n      <div v-if=\"successMessage\" class=\"mt-6 max-w-4xl\">\n        <div class=\"p-4 border border-green-300 rounded-md bg-green-50\">\n          <div class=\"flex\">\n            <svg class=\"h-5 w-5 text-green-400 mr-2 mt-0.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\" />\n            </svg>\n            <div>\n              <h3 class=\"text-sm font-medium text-green-800\">Success!</h3>\n              <p class=\"mt-1 text-sm text-green-700\">{{ successMessage }}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed } from 'vue'\nimport { useRouter, useRoute } from 'vue-router'\nimport OpportunityFormWrapper from '@/components/opportunities/OpportunityFormWrapper.vue'\nimport type { OpportunityFormWrapperData } from '@/types/opportunityForm'\nimport { OpportunityContext } from '@/types/opportunities'\n\n// Dependencies\nconst router = useRouter()\nconst route = useRoute()\n\n// ===============================\n// REACTIVE STATE\n// ===============================\n\nconst submitError = ref<string | null>(null)\nconst successMessage = ref<string | null>(null)\n\n// Context data processing\nconst contextData = computed((): Partial<OpportunityFormWrapperData> => {\n  const query = route.query\n  const initialData: Partial<OpportunityFormWrapperData> = {}\n  \n  // Handle context from contact detail page\n  if (query.contextType === 'contact') {\n    initialData.organizationName = (query.organizationName as string) || ''\n    // Set context to indicate this came from a contact\n    initialData.context = OpportunityContext.NEW_PRODUCT_INTEREST // Default context for contact-initiated opportunities\n    initialData.notes = query.contactName \n      ? `Opportunity created from contact: ${query.contactName}`\n      : 'Opportunity created from contact page'\n  }\n  \n  // Handle context from organization detail page\n  if (query.contextType === 'organization') {\n    initialData.organizationName = (query.organizationName as string) || ''\n    // Set context to indicate this came from an organization\n    initialData.context = OpportunityContext.FOLLOW_UP // Default context for organization-initiated opportunities\n    initialData.notes = 'Opportunity created from organization page'\n  }\n  \n  return initialData\n})\n\n// ===============================\n// EVENT HANDLERS\n// ===============================\n\n/**\n * Handle successful opportunity creation\n * Navigate to the created opportunity's detail page\n */\nconst handleSuccess = (data: { opportunityId?: string; opportunityIds?: string[]; count?: number }) => {\n  console.log('Opportunity(s) created successfully:', data)\n  \n  // Clear any previous errors\n  submitError.value = null\n  \n  // Handle single opportunity creation\n  if (data.opportunityId) {\n    successMessage.value = 'Opportunity created successfully! Redirecting to details...'\n    \n    // Brief delay to show success message before navigation\n    setTimeout(() => {\n      router.push(`/opportunities/${data.opportunityId}`)\n    }, 1500)\n  }\n  // Handle batch opportunity creation\n  else if (data.opportunityIds && data.opportunityIds.length > 0) {\n    const count = data.count || data.opportunityIds.length\n    successMessage.value = `${count} opportunities created successfully! Redirecting to list...`\n    \n    // Brief delay to show success message before navigation\n    setTimeout(() => {\n      router.push('/opportunities')\n    }, 2000)\n  }\n  // Fallback - redirect to opportunities list\n  else {\n    successMessage.value = 'Opportunity created successfully! Redirecting...'\n    \n    setTimeout(() => {\n      router.push('/opportunities')\n    }, 1500)\n  }\n}\n\n/**\n * Handle form cancellation\n * Navigate back to opportunities list\n */\nconst handleCancel = () => {\n  // Clear any messages\n  submitError.value = null\n  successMessage.value = null\n  \n  // Navigate back to opportunities list\n  router.push('/opportunities')\n}\n\n/**\n * Handle form submission error\n */\nconst handleError = (error: string | Error) => {\n  console.error('Opportunity creation error:', error)\n  \n  // Clear success message if any\n  successMessage.value = null\n  \n  // Set error message\n  submitError.value = typeof error === 'string' ? error : error.message || 'An unexpected error occurred'\n}\n\n/**\n * Clear error message\n */\nconst clearError = () => {\n  submitError.value = null\n}\n</script>\n\n<style scoped>\n.opportunity-create-view {\n  @apply max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6;\n}\n\n/* Breadcrumb enhancements */\n.opportunity-create-view nav ol li a:hover {\n  @apply text-primary-600;\n}\n\n.opportunity-create-view nav ol li[aria-current=\"page\"] span {\n  color: rgb(107 114 128);\n}\n\n/* Back button enhancements */\n.opportunity-create-view a[aria-label]:hover {\n  @apply bg-gray-50;\n}\n\n/* Responsive design */\n@media (max-width: 1024px) {\n  .opportunity-create-view {\n    @apply px-4;\n  }\n}\n\n@media (max-width: 768px) {\n  .opportunity-create-view {\n    @apply px-2 py-4;\n  }\n  \n  /* Stack header elements on mobile */\n  .opportunity-create-view .flex.items-center.space-x-3 {\n    @apply flex-col items-start space-x-0 space-y-3;\n  }\n  \n  .opportunity-create-view .flex.items-center.space-x-3 > a {\n    @apply self-start;\n  }\n}\n\n/* Accessibility enhancements */\n@media (prefers-reduced-motion: reduce) {\n  * {\n    transition: none !important;\n  }\n}\n\n/* High contrast mode */\n@media (prefers-contrast: high) {\n  .opportunity-create-view .border-red-300 {\n    border-color: rgb(220 38 38);\n  }\n  \n  .opportunity-create-view .border-green-300 {\n    border-color: rgb(22 163 74);\n  }\n  \n  .opportunity-create-view .text-gray-500 {\n    color: rgb(31 41 55);\n  }\n  \n  .opportunity-create-view .text-gray-600 {\n    color: rgb(17 24 39);\n  }\n}\n\n/* Print styles */\n@media print {\n  .opportunity-create-view nav,\n  .opportunity-create-view button {\n    @apply hidden;\n  }\n  \n  .opportunity-create-view {\n    @apply shadow-none;\n  }\n}\n</style>"],"names":["router","useRouter","route","useRoute","submitError","ref","successMessage","contextData","computed","query","initialData","OpportunityContext","handleSuccess","data","count","handleCancel","handleError","error","clearError","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_createVNode","_component_router_link","_cache","_hoisted_6","_hoisted_7","_hoisted_8","OpportunityFormWrapper","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_toDisplayString","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16"],"mappings":"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"}