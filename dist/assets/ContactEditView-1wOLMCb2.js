import{d as T,j as N,c as p,e as w,b as r,k as C,t as V,C as E,i as m,B as S,r as x,y as O,o as R,f as l,w as u,g as G,u as H,p as b,v,n as g,x as J}from"./index-Dvtn0bXD.js";import{c as A}from"./contactsApi-DOcQFNMP.js";import{C as B}from"./contacts-BMobG5cv.js";import{_ as F}from"./Button.vue_vue_type_script_setup_true_lang-Bz-XoMEY.js";import"./supabaseClient-CM-h1Htk.js";import"./index.esm-DD28t5m0.js";const L={class:"space-y-1"},P=["for"],K={key:0,class:"text-danger"},Q={class:"relative"},W=["id"],y=T({__name:"FormGroup",props:{name:{},label:{},error:{},required:{type:Boolean}},setup(j){const z=j,U=N(()=>`field-${z.name}`),$=N(()=>`error-${z.name}`);return(n,q)=>(m(),p("div",L,[n.label?(m(),p("label",{key:0,for:U.value,class:"block text-sm font-medium text-gray-700"},[C(V(n.label)+" ",1),n.required?(m(),p("span",K,"*")):w("",!0)],8,P)):w("",!0),r("div",Q,[E(n.$slots,"default",{fieldId:U.value,hasError:!!n.error,errorId:$.value})]),n.error?(m(),p("p",{key:1,id:$.value,role:"alert",class:"text-sm text-danger"},V(n.error),9,W)):w("",!0)]))}}),X={class:"min-h-screen bg-gray-50 py-8"},Y={class:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8"},Z={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},ee={key:1,class:"bg-white rounded-lg shadow-sm border border-danger p-6"},re={class:"flex items-center mb-4"},te={class:"text-red-700"},oe={class:"flex space-x-3"},ae={key:2},ne={class:"mb-8"},ie={class:"flex items-center space-x-3 mb-4"},se={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},de={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},le=["id","aria-describedby","aria-invalid"],ue=["id","aria-describedby","aria-invalid"],ce=["id","aria-describedby","aria-invalid"],pe=["id","aria-describedby","aria-invalid"],me={class:"md:col-span-2"},fe=["id","aria-describedby","aria-invalid"],be={class:"md:col-span-2"},ve=["id","aria-describedby","aria-invalid"],ge={class:"md:col-span-2"},ye=["id","aria-describedby","aria-invalid"],_e={key:0,class:"mt-6 p-4 border border-danger rounded-md bg-red-50"},xe={class:"flex"},we={class:"mt-1 text-sm text-red-700"},he={class:"mt-8 flex justify-end space-x-3"},ke={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},Be=T({__name:"ContactEditView",setup(j){const z=S(),U=J(),$=z.params.id,n=x(null),q=x(!0),h=x(null),o=O({first_name:"",last_name:"",organization_id:"",position:"",purchase_influence:"Unknown",decision_authority:"End User",preferred_principals:[],phone:null,email:null,address:null,city:null,state:null,zip_code:null,website:null,account_manager:null,notes:null,is_primary:!1}),f=x({}),_=x(null),k=x(!1),M=async()=>{try{q.value=!0,h.value=null;const a=await A.getContact($);if(a.success&&a.data){n.value=a.data;const e=B.contactToForm(a.data);Object.assign(o,e)}else h.value=a.error||"Contact not found"}catch(a){h.value="An unexpected error occurred",console.error("Error loading contact:",a)}finally{q.value=!1}},I=async()=>{try{const a=await B.validateCreate(o);if(a.isValid)return f.value={},!0;{const e={};return a.errors.forEach(c=>{e[c.field]=c.message}),f.value=e,!1}}catch(a){return console.error("Form validation error:",a),_.value="Form validation failed",!1}},D=async()=>{if(n.value)try{if(k.value=!0,_.value=null,!await I())return;const e=B.formToUpdate(o),c=await A.updateContact(n.value.id,e);c.success&&c.data?U.push(`/contacts/${c.data.id}`):_.value=c.error||"Failed to update contact"}catch(a){console.error("Error updating contact:",a),_.value="An unexpected error occurred"}finally{k.value=!1}};return R(()=>{M()}),(a,e)=>{const c=G("router-link");return m(),p("div",X,[r("div",Y,[q.value?(m(),p("div",Z,e[7]||(e[7]=[r("div",{class:"flex justify-center"},[r("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})],-1)]))):h.value?(m(),p("div",ee,[r("div",re,[e[8]||(e[8]=r("svg",{class:"h-5 w-5 text-danger mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),r("span",te,V(h.value),1)]),r("div",oe,[l(c,{to:"/",class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"},{default:u(()=>e[9]||(e[9]=[C(" Back to Contacts ",-1)])),_:1,__:[9]}),l(F,{onClick:M,variant:"primary"},{default:u(()=>e[10]||(e[10]=[C(" Try Again ",-1)])),_:1,__:[10]})])])):n.value?(m(),p("div",ae,[r("div",ne,[r("div",ie,[l(c,{to:`/contacts/${n.value.id}`,class:"text-gray-500 hover:text-gray-700"},{default:u(()=>e[11]||(e[11]=[r("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),_:1,__:[11]},8,["to"]),e[12]||(e[12]=r("h1",{class:"text-3xl font-bold text-gray-900"},"Edit Contact",-1))]),e[13]||(e[13]=r("p",{class:"text-gray-600"},"Update contact information",-1))]),r("div",se,[r("form",{onSubmit:H(D,["prevent"])},[r("div",de,[l(y,{name:"first_name",label:"First Name",error:f.value.first_name,required:""},{default:u(({fieldId:i,hasError:t,errorId:s})=>[b(r("input",{id:i,"onUpdate:modelValue":e[0]||(e[0]=d=>o.first_name=d),type:"text",required:"",placeholder:"Enter first name","aria-describedby":t?s:void 0,"aria-invalid":t?"true":"false",class:g(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent transition duration-200 border-gray-300 focus:ring-primary",{"border-danger focus:ring-danger":t}])},null,10,le),[[v,o.first_name]])]),_:1},8,["error"]),l(y,{name:"last_name",label:"Last Name",error:f.value.last_name,required:""},{default:u(({fieldId:i,hasError:t,errorId:s})=>[b(r("input",{id:i,"onUpdate:modelValue":e[1]||(e[1]=d=>o.last_name=d),type:"text",required:"",placeholder:"Enter last name","aria-describedby":t?s:void 0,"aria-invalid":t?"true":"false",class:g(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent transition duration-200 border-gray-300 focus:ring-primary",{"border-danger focus:ring-danger":t}])},null,10,ue),[[v,o.last_name]])]),_:1},8,["error"]),l(y,{name:"email",label:"Email Address",error:f.value.email,required:""},{default:u(({fieldId:i,hasError:t,errorId:s})=>[b(r("input",{id:i,"onUpdate:modelValue":e[2]||(e[2]=d=>o.email=d),type:"email",required:"",placeholder:"Enter email address","aria-describedby":t?s:void 0,"aria-invalid":t?"true":"false",class:g(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent transition duration-200 border-gray-300 focus:ring-primary",{"border-danger focus:ring-danger":t}])},null,10,ce),[[v,o.email]])]),_:1},8,["error"]),l(y,{name:"phone",label:"Phone Number",error:f.value.phone},{default:u(({fieldId:i,hasError:t,errorId:s})=>[b(r("input",{id:i,"onUpdate:modelValue":e[3]||(e[3]=d=>o.phone=d),type:"tel",placeholder:"Enter phone number","aria-describedby":t?s:void 0,"aria-invalid":t?"true":"false",class:g(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent transition duration-200 border-gray-300 focus:ring-primary",{"border-danger focus:ring-danger":t}])},null,10,pe),[[v,o.phone]])]),_:1},8,["error"]),r("div",me,[l(y,{name:"organization",label:"Organization",error:f.value.organization,required:""},{default:u(({fieldId:i,hasError:t,errorId:s})=>[b(r("input",{id:i,"onUpdate:modelValue":e[4]||(e[4]=d=>o.organization_id=d),type:"text",required:"",placeholder:"Enter organization or company name","aria-describedby":t?s:void 0,"aria-invalid":t?"true":"false",class:g(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent transition duration-200 border-gray-300 focus:ring-primary",{"border-danger focus:ring-danger":t}])},null,10,fe),[[v,o.organization_id]])]),_:1},8,["error"])]),r("div",be,[l(y,{name:"title",label:"Job Title",error:f.value.title},{default:u(({fieldId:i,hasError:t,errorId:s})=>[b(r("input",{id:i,"onUpdate:modelValue":e[5]||(e[5]=d=>o.position=d),type:"text",placeholder:"Enter job title","aria-describedby":t?s:void 0,"aria-invalid":t?"true":"false",class:g(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent transition duration-200 border-gray-300 focus:ring-primary",{"border-danger focus:ring-danger":t}])},null,10,ve),[[v,o.position]])]),_:1},8,["error"])]),r("div",ge,[l(y,{name:"notes",label:"Notes",error:f.value.notes},{default:u(({fieldId:i,hasError:t,errorId:s})=>[b(r("textarea",{id:i,"onUpdate:modelValue":e[6]||(e[6]=d=>o.notes=d),rows:"4",placeholder:"Add any additional notes about this contact...","aria-describedby":t?s:void 0,"aria-invalid":t?"true":"false",class:g(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent transition duration-200 border-gray-300 focus:ring-primary",{"border-danger focus:ring-danger":t}])},null,10,ye),[[v,o.notes]])]),_:1},8,["error"])])]),_.value?(m(),p("div",_e,[r("div",xe,[e[15]||(e[15]=r("svg",{class:"h-5 w-5 text-danger mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),r("div",null,[e[14]||(e[14]=r("h3",{class:"text-sm font-medium text-red-800"},"Error updating contact",-1)),r("p",we,V(_.value),1)])])])):w("",!0),r("div",he,[l(c,{to:`/contacts/${n.value.id}`,class:"inline-flex items-center justify-center px-4 py-2 border text-sm font-semibold rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-primary"},{default:u(()=>e[16]||(e[16]=[C(" Cancel ",-1)])),_:1,__:[16]},8,["to"]),l(F,{type:"submit",variant:"primary",disabled:k.value},{default:u(()=>[k.value?(m(),p("svg",ke,e[17]||(e[17]=[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):w("",!0),C(" "+V(k.value?"Updating...":"Update Contact"),1)]),_:1},8,["disabled"])])],32)])])):w("",!0)])])}}});export{Be as default};
//# sourceMappingURL=ContactEditView-1wOLMCb2.js.map
