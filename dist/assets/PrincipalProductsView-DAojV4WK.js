import{a as d,j as n,b as t,d as K,r as p,c as f,y as X,o as Q,C as J,q as Y,w as tt,h as P,f as a,e as k,u,n as j,t as l,l as S,v as et,m as E,F as $,i as C,k as ot}from"./index-CtjJHjR0.js";import{_ as rt}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CSI_IRkI.js";import{P as st}from"./PrincipalSelector-Bvv7zegO.js";import{r as at,a as V,P as nt}from"./ManagePrincipalProductsButton.vue_vue_type_style_index_0_scoped_f75a9cbf_lang-CgdDeQZV.js";import{P as it}from"./PrincipalProductTable-GbfFDXJY.js";import{u as lt}from"./principalStore-DHqEcCuF.js";import"./PrincipalDashboard.vue_vue_type_style_index_0_scoped_daf2c332_lang-TY93HFqY.js";import"./supabaseClient-Dum322BS.js";/* empty css                                                                       *//* empty css                                                                          */import"./EngagementScoreRing-BkhISJFZ.js";/* empty css                                                                                     */import"./opportunityStore-B1hLuFtx.js";/* empty css                                                                       */import{r as dt}from"./Bars3Icon-BMAqEN-8.js";import{r as O}from"./TrendIndicator-CMQUPBAk.js";import{r as ct}from"./ChartBarIcon-DnppHkPB.js";import{r as ut}from"./CurrencyDollarIcon-DIE48oxp.js";import{r as B}from"./MagnifyingGlassIcon-C7DlFZAR.js";import{r as mt}from"./EyeIcon-DlqmecpP.js";import{r as pt}from"./PlusIcon-BeWH-K1A.js";import{r as ft}from"./ExclamationTriangleIcon-BvwA24I5.js";import{_ as gt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./dashboardStore-BEBNMsxJ.js";import"./productStore-9Dx38iZU.js";import"./organizationStore-nVvH6PxL.js";import"./index.esm-Do0MT1Iq.js";import"./XMarkIcon-D9bsmxiL.js";import"./UserGroupIcon-CL3csMZ9.js";import"./CalendarIcon-DPP_Fow2.js";import"./BuildingOfficeIcon-DckFZ7iO.js";import"./CheckIcon-B_41sR31.js";import"./ArrowDownTrayIcon-CO3_VHAU.js";import"./ChevronUpIcon-OFNtXdQa.js";import"./organizationsApi-DotikQjO.js";function _t(D,y){return n(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077 1.41-.513m14.095-5.13 1.41-.513M5.106 17.785l1.15-.964m11.49-9.642 1.149-.964M7.501 19.795l.75-1.3m7.5-12.99.75-1.3m-6.063 16.658.26-1.477m2.605-14.772.26-1.477m0 17.726-.26-1.477M10.698 4.614l-.26-1.477M16.5 19.794l-.75-1.299M7.5 4.205 12 12m6.894 5.785-1.149-.964M6.256 7.178l-1.15-.964m15.352 8.864-1.41-.513M4.954 9.435l-1.41-.514M12.002 12l-3.75 6.495"})])}function vt(D,y){return n(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z"})])}const ht={class:"principal-products-view"},xt={class:"mb-6"},bt={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},yt={class:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3"},wt=["disabled"],Mt={class:"flex rounded-md shadow-sm"},Pt={class:"mb-6"},kt={key:0,class:"flex items-center justify-center py-12"},St={key:1,class:"text-center py-12"},$t={key:2,class:"space-y-6"},Ct={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},Vt={class:"bg-white rounded-lg border border-gray-200 p-4"},Dt={class:"flex items-center"},At={class:"flex-shrink-0"},It={class:"ml-3"},Nt={class:"text-2xl font-bold text-gray-900"},Tt={class:"bg-white rounded-lg border border-gray-200 p-4"},jt={class:"flex items-center"},Et={class:"flex-shrink-0"},Ot={class:"ml-3"},Bt={class:"text-2xl font-bold text-gray-900"},Ht={class:"bg-white rounded-lg border border-gray-200 p-4"},Lt={class:"flex items-center"},Ft={class:"flex-shrink-0"},zt={class:"ml-3"},Rt={class:"text-2xl font-bold text-gray-900"},Ut={class:"bg-white rounded-lg border border-gray-200 p-4"},qt={class:"flex items-center"},Zt={class:"flex-shrink-0"},Wt={class:"ml-3"},Gt={class:"text-2xl font-bold text-gray-900"},Kt={class:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4"},Xt={class:"flex-1"},Qt={class:"relative"},Jt={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Yt={class:"p-6 pb-4"},te={class:"flex items-start justify-between"},ee={class:"flex-1 min-w-0"},oe={class:"text-lg font-medium text-gray-900 truncate"},re={class:"text-sm text-gray-500 mt-1"},se={class:"px-6 pb-4"},ae={class:"grid grid-cols-2 gap-4"},ne={class:"text-lg font-semibold text-gray-900 mt-1"},ie={class:"text-lg font-semibold text-gray-900 mt-1"},le={class:"px-6 py-4 bg-gray-50 rounded-b-lg"},de={class:"flex space-x-3"},ce=["onClick"],ue=["onClick"],me={key:0,class:"col-span-full text-center py-12"},pe={key:1,class:"bg-white rounded-lg border border-gray-200 overflow-hidden"},fe={class:"bg-white rounded-lg border border-gray-200 p-6"},ge={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},_e={class:"h-64"},ve={class:"space-y-6"},he={class:"space-y-2"},xe={class:"flex-1 min-w-0"},be={class:"text-sm font-medium text-gray-900 truncate"},ye={class:"text-xs text-gray-500"},we={class:"space-y-2"},Me={class:"flex-1 min-w-0"},Pe={class:"text-sm font-medium text-gray-900 truncate"},ke={class:"text-xs text-gray-500"},Se={key:3,class:"bg-red-50 border border-red-200 rounded-lg p-4"},$e={class:"flex"},Ce={class:"text-sm text-red-700 mt-1"},Ve=K({__name:"PrincipalProductsView",setup(D){const y=ot(),H=J(),g=lt(),i=p(null),_=p("grid"),v=p(""),h=p(""),w=p("performance"),x=p(!1),b=p(null),c=p([]),L=f(()=>g.loading),F=f(()=>g.error),z=f(()=>c.value.length?c.value.reduce((e,s)=>e+(s.product_performance_score||0),0)/c.value.length:0),R=f(()=>c.value.reduce((o,e)=>o+(e.total_opportunities||0),0)),U=f(()=>c.value.reduce((o,e)=>o+(e.total_value||0),0)),M=f(()=>{let o=[...c.value];if(v.value){const e=v.value.toLowerCase();o=o.filter(s=>s.product_name.toLowerCase().includes(e))}return h.value&&(o=o.filter(e=>{const s=e.product_performance_score||0;switch(h.value){case"high":return s>=70;case"medium":return s>=40&&s<70;case"low":return s<40;default:return!0}})),o.sort((e,s)=>{switch(w.value){case"name":return e.product_name.localeCompare(s.product_name);case"opportunities":return(s.total_opportunities||0)-(e.total_opportunities||0);case"value":return(s.total_value||0)-(e.total_value||0);case"performance":default:return(s.product_performance_score||0)-(e.product_performance_score||0)}}),o}),q=f(()=>[...c.value].sort((o,e)=>(e.product_performance_score||0)-(o.product_performance_score||0)).slice(0,3)),Z=f(()=>[...c.value].sort((o,e)=>(o.product_performance_score||0)-(e.product_performance_score||0)).slice(0,3)),A=async()=>{if(i.value){x.value=!0,b.value=null;try{await new Promise(e=>setTimeout(e,1e3));const o=["Premium Widget Pro","Standard Package Plus","Enterprise Solution Max","Basic Service Lite","Advanced Analytics Suite","Custom Integration Tool","Mobile App Platform","Cloud Platform Enterprise","Security Suite Premium","Data Visualization Tool","Workflow Automation","Communication Hub"];c.value=o.map((e,s)=>{var m,r;return{principal_id:((m=i.value)==null?void 0:m.id)||`principal_${s+1}`,principal_name:((r=i.value)==null?void 0:r.name)||`Principal ${s+1}`,product_id:`prod_${s+1}`,product_name:e,product_category:["Protein","Sauce","Seasoning","Beverage","Snack"][Math.floor(Math.random()*5)],product_sku:`SKU-${String(s+1).padStart(4,"0")}`,is_primary_principal:Math.random()>.5,exclusive_rights:Math.random()>.7,wholesale_price:Math.floor(Math.random()*1e3)+100,minimum_order_quantity:Math.floor(Math.random()*500)+50,lead_time_days:Math.floor(Math.random()*30)+7,contract_start_date:new Date(Date.now()-Math.random()*365*24*60*60*1e3).toISOString(),contract_end_date:new Date(Date.now()+Math.random()*730*24*60*60*1e3).toISOString(),territory_restrictions:null,opportunities_for_product:Math.floor(Math.random()*25)+5,won_opportunities_for_product:Math.floor(Math.random()*10)+1,active_opportunities_for_product:Math.floor(Math.random()*15)+3,latest_opportunity_date:new Date(Date.now()-Math.random()*90*24*60*60*1e3).toISOString(),avg_opportunity_probability:Math.floor(Math.random()*60)+20,total_opportunities:Math.floor(Math.random()*25)+5,win_rate:Math.floor(Math.random()*50)+25,total_value:Math.floor(Math.random()*2e5)+5e4,interactions_for_product:Math.floor(Math.random()*20)+5,recent_interactions_for_product:Math.floor(Math.random()*5)+1,last_interaction_date:new Date(Date.now()-Math.random()*60*24*60*60*1e3).toISOString(),product_is_active:Math.random()>.1,launch_date:new Date(Date.now()-Math.random()*1095*24*60*60*1e3).toISOString(),discontinue_date:null,unit_cost:Math.floor(Math.random()*500)+50,suggested_retail_price:Math.floor(Math.random()*1500)+200,contract_status:["ACTIVE","PENDING","EXPIRED","EXPIRING_SOON"][Math.floor(Math.random()*4)],product_performance_score:Math.floor(Math.random()*60)+30,relationship_created_at:new Date(Date.now()-Math.random()*730*24*60*60*1e3).toISOString(),relationship_updated_at:new Date(Date.now()-Math.random()*30*24*60*60*1e3).toISOString()}})}catch(o){b.value=o instanceof Error?o.message:"Failed to load product data",console.error("Error loading products data:",o)}finally{x.value=!1}}},I=o=>o>=1e6?`$${(o/1e6).toFixed(1)}M`:o>=1e3?`$${(o/1e3).toFixed(0)}K`:`$${o.toFixed(0)}`,N=o=>{var s;let e;typeof o=="string"?e=(s=c.value)==null?void 0:s.find(m=>m.product_id===o):e=o,e?console.log("Viewing product details:",e):console.warn("Product not found for details view")},T=o=>{var s,m;let e;typeof o=="string"?e=(s=c.value)==null?void 0:s.find(r=>r.product_id===o):e=o,e?(console.log("Creating opportunity for product:",e),y.push({path:"/opportunities/new",query:{principalId:(m=i.value)==null?void 0:m.id,productId:e.product_id}})):console.warn("Product not found for opportunity creation")},W=()=>{console.log("Opening manage products modal for principal:",i.value)};return X(i,()=>{i.value?A():c.value=[]},{immediate:!1}),Q(async()=>{g.principals.length===0&&await g.fetchPrincipals();const o=H.params.principalId;if(o){const e=g.principals.find(s=>s.id===o);e&&(i.value=e)}}),(o,e)=>(n(),Y(rt,null,{default:tt(()=>{var s,m;return[t("div",ht,[t("div",xt,[t("div",bt,[e[8]||(e[8]=t("div",{class:"mb-4 sm:mb-0"},[t("h1",{class:"text-2xl font-bold text-gray-900"},"Product Portfolio"),t("p",{class:"mt-1 text-sm text-gray-500"}," Manage products and analyze performance metrics ")],-1)),t("div",yt,[t("button",{onClick:W,disabled:!i.value,class:"inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed min-h-[44px]"},[a(u(_t),{class:"h-4 w-4 mr-2"}),e[7]||(e[7]=k(" Manage Products ",-1))],8,wt),t("div",Mt,[t("button",{onClick:e[0]||(e[0]=r=>_.value="grid"),class:j(["px-4 py-2 text-sm font-medium rounded-l-md border min-h-[44px]",_.value==="grid"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])},[a(u(vt),{class:"h-4 w-4"})],2),t("button",{onClick:e[1]||(e[1]=r=>_.value="table"),class:j(["px-4 py-2 text-sm font-medium rounded-r-md border-t border-r border-b min-h-[44px]",_.value==="table"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])},[a(u(dt),{class:"h-4 w-4"})],2)])])])]),t("div",Pt,[a(st,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=r=>i.value=r),loading:L.value,error:F.value,placeholder:"Select a principal to view their product portfolio...",class:"w-full"},null,8,["modelValue","loading","error"])]),x.value&&i.value?(n(),d("div",kt,e[9]||(e[9]=[t("div",{class:"text-center"},[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),t("p",{class:"mt-4 text-sm text-gray-500"},"Loading product portfolio...")],-1)]))):i.value?i.value?(n(),d("div",$t,[t("div",Ct,[t("div",Vt,[t("div",Dt,[t("div",At,[a(u(O),{class:"h-6 w-6 text-blue-500"})]),t("div",It,[e[12]||(e[12]=t("p",{class:"text-sm font-medium text-gray-500"},"Active Products",-1)),t("p",Nt,l(((s=c.value)==null?void 0:s.length)||0),1)])])]),t("div",Tt,[t("div",jt,[t("div",Et,[a(u(at),{class:"h-6 w-6 text-green-500"})]),t("div",Ot,[e[13]||(e[13]=t("p",{class:"text-sm font-medium text-gray-500"},"Avg Performance",-1)),t("p",Bt,l(Math.round(z.value)),1)])])]),t("div",Ht,[t("div",Lt,[t("div",Ft,[a(u(ct),{class:"h-6 w-6 text-purple-500"})]),t("div",zt,[e[14]||(e[14]=t("p",{class:"text-sm font-medium text-gray-500"},"Total Opportunities",-1)),t("p",Rt,l(R.value),1)])])]),t("div",Ut,[t("div",qt,[t("div",Zt,[a(u(ut),{class:"h-6 w-6 text-yellow-500"})]),t("div",Wt,[e[15]||(e[15]=t("p",{class:"text-sm font-medium text-gray-500"},"Total Value",-1)),t("p",Gt,l(I(U.value)),1)])])])]),t("div",Kt,[t("div",Xt,[t("div",Qt,[a(u(B),{class:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),S(t("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>v.value=r),type:"text",placeholder:"Search products...",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 min-h-[44px]"},null,512),[[et,v.value]])])]),S(t("select",{"onUpdate:modelValue":e[4]||(e[4]=r=>h.value=r),class:"block w-full sm:w-48 px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[44px]"},e[16]||(e[16]=[t("option",{value:""},"All Performance Levels",-1),t("option",{value:"high"},"High (70-100)",-1),t("option",{value:"medium"},"Medium (40-69)",-1),t("option",{value:"low"},"Low (0-39)",-1)]),512),[[E,h.value]]),S(t("select",{"onUpdate:modelValue":e[5]||(e[5]=r=>w.value=r),class:"block w-full sm:w-48 px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[44px]"},e[17]||(e[17]=[t("option",{value:"performance"},"Sort by Performance",-1),t("option",{value:"name"},"Sort by Name",-1),t("option",{value:"opportunities"},"Sort by Opportunities",-1),t("option",{value:"value"},"Sort by Value",-1)]),512),[[E,w.value]])]),_.value==="grid"?(n(),d("div",Jt,[(n(!0),d($,null,C(M.value,r=>(n(),d("div",{key:r.product_id,class:"bg-white rounded-lg border border-gray-200 hover:border-gray-300 transition-colors duration-200"},[t("div",Yt,[t("div",te,[t("div",ee,[t("h3",oe,l(r.product_name),1),t("p",re,l(r.total_opportunities)+" opportunities ",1)]),a(V,{score:r.product_performance_score||0,size:"md","show-label":!0},null,8,["score"])])]),t("div",se,[t("div",ae,[t("div",null,[e[18]||(e[18]=t("p",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide"},"Win Rate",-1)),t("p",ne,l(Math.round(r.win_rate||0))+"% ",1)]),t("div",null,[e[19]||(e[19]=t("p",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide"},"Total Value",-1)),t("p",ie,l(I(r.total_value||0)),1)])])]),t("div",le,[t("div",de,[t("button",{onClick:G=>N(r),class:"flex-1 text-center px-3 py-2 text-sm font-medium text-blue-600 bg-blue-100 rounded-md hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-[44px] flex items-center justify-center"},[a(u(mt),{class:"h-4 w-4 mr-1"}),e[20]||(e[20]=k(" View Details ",-1))],8,ce),t("button",{onClick:G=>T(r),class:"flex-1 text-center px-3 py-2 text-sm font-medium text-green-600 bg-green-100 rounded-md hover:bg-green-200 focus:outline-none focus:ring-2 focus:ring-green-500 min-h-[44px] flex items-center justify-center"},[a(u(pt),{class:"h-4 w-4 mr-1"}),e[21]||(e[21]=k(" New Opp ",-1))],8,ue)])])]))),128)),M.value.length===0?(n(),d("div",me,[a(u(B),{class:"mx-auto h-12 w-12 text-gray-400"}),e[22]||(e[22]=t("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"No products found",-1)),e[23]||(e[23]=t("p",{class:"mt-2 text-sm text-gray-500"}," Try adjusting your search or filter criteria. ",-1))])):P("",!0)])):(n(),d("div",pe,[a(it,{products:M.value,loading:x.value,"view-mode":"table","show-actions":!0,onViewDetails:N,onCreateOpportunity:e[6]||(e[6]=r=>T(r))},null,8,["products","loading"])])),t("div",fe,[e[26]||(e[26]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Performance Analysis",-1)),t("div",ge,[t("div",_e,[a(u(nt),{data:c.value||[],"principal-name":(m=i.value)==null?void 0:m.name},null,8,["data","principal-name"])]),t("div",ve,[t("div",null,[e[24]||(e[24]=t("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"Top Performers",-1)),t("div",he,[(n(!0),d($,null,C(q.value,r=>(n(),d("div",{key:`top-${r.product_id}`,class:"flex items-center justify-between p-3 bg-green-50 rounded-lg"},[t("div",xe,[t("p",be,l(r.product_name),1),t("p",ye,l(r.total_opportunities)+" opps • "+l(Math.round(r.win_rate||0))+"% win rate ",1)]),a(V,{score:r.product_performance_score||0,size:"sm","show-label":!1},null,8,["score"])]))),128))])]),t("div",null,[e[25]||(e[25]=t("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"Needs Attention",-1)),t("div",we,[(n(!0),d($,null,C(Z.value,r=>(n(),d("div",{key:`bottom-${r.product_id}`,class:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg"},[t("div",Me,[t("p",Pe,l(r.product_name),1),t("p",ke,l(r.total_opportunities)+" opps • "+l(Math.round(r.win_rate||0))+"% win rate ",1)]),a(V,{score:r.product_performance_score||0,size:"sm","show-label":!1},null,8,["score"])]))),128))])])])])])])):P("",!0):(n(),d("div",St,[a(u(O),{class:"mx-auto h-16 w-16 text-gray-400"}),e[10]||(e[10]=t("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"Product Portfolio",-1)),e[11]||(e[11]=t("p",{class:"mt-2 text-sm text-gray-500"}," Select a principal above to view and manage their product portfolio and performance metrics. ",-1))])),b.value?(n(),d("div",Se,[t("div",$e,[a(u(ft),{class:"h-5 w-5 text-red-400 mr-3 flex-shrink-0"}),t("div",null,[e[27]||(e[27]=t("h3",{class:"text-sm font-medium text-red-800"},"Error Loading Products",-1)),t("p",Ce,l(b.value),1),t("button",{onClick:A,class:"mt-2 text-sm font-medium text-red-800 hover:text-red-900"}," Try again ")])])])):P("",!0)])]}),_:1}))}}),mo=gt(Ve,[["__scopeId","data-v-9e6a9af6"]]);export{mo as default};
//# sourceMappingURL=PrincipalProductsView-DAojV4WK.js.map
