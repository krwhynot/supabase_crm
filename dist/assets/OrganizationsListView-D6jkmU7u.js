import{a as n,j as a,b as t,d as Q,r as g,c as p,y as j,o as R,h as b,f as o,l as H,u as i,v as J,w as N,g as K,F as S,i as V,t as d,e as f,n as O,s as E,k as W}from"./index-Br7bM97V.js";import{u as X}from"./organizationStore-C4EDmZw3.js";import{r as F}from"./MagnifyingGlassIcon-BepCswCi.js";import{r as Y}from"./ExclamationTriangleIcon-3AUMR-W2.js";import{r as ee}from"./ArrowPathIcon-D9Yw9nnG.js";import{r as T}from"./BuildingOfficeIcon-CE9ZCi7A.js";import{r as te}from"./ChevronLeftIcon-CzDNyMc4.js";import{r as se}from"./ChevronRightIcon-DBAMD-2N.js";import{r as B}from"./PlusIcon-88x01lis.js";import{r as re}from"./GlobeAltIcon-DEWq-ghJ.js";import{r as oe,a as ne}from"./PhoneIcon-CrBznpFF.js";import{r as ae}from"./PencilIcon-DNym4K5n.js";import{r as le}from"./TrashIcon-C97BRO8M.js";import"./supabaseClient-CwaY5m9F.js";import"./index.esm-DHR-h0Sg.js";function ie(I,h){return a(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"})])}const de={class:"space-y-6"},ce={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},ue={class:"mt-4 sm:mt-0 flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-3"},me={class:"relative"},ge={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},xe={class:"border-b border-gray-200"},be={class:"-mb-px flex space-x-8"},ve=["onClick"],ye={key:0,class:"text-center py-12"},pe={key:1,class:"text-center py-12"},fe={class:"text-red-600 mb-4"},he={class:"text-gray-600 mb-4"},_e={key:2,class:"text-center py-12"},we={key:3,class:"text-center py-12"},ke={class:"text-gray-600 mb-4"},Ce={key:4,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},$e=["onClick"],ze={class:"p-6"},Oe={class:"flex items-start justify-between mb-4"},Le={class:"flex items-center space-x-3"},Me={class:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center"},Pe={class:"min-w-0 flex-1"},Ae={class:"text-lg font-medium text-gray-900 truncate"},je={key:0,class:"text-sm text-gray-500 truncate"},Ne={class:"space-y-2 mb-4"},Se={key:0,class:"flex items-center text-sm text-gray-600"},Ve={class:"truncate"},Ee={key:1,class:"flex items-center text-sm text-gray-600"},Fe={key:2,class:"flex items-center text-sm text-gray-600"},Te={class:"truncate"},Be={class:"flex items-center justify-between pt-4 border-t border-gray-200"},Ie={class:"flex items-center text-sm text-gray-500"},De={class:"flex items-center space-x-1"},Ue=["onClick","aria-label"],Ze=["onClick","aria-label"],qe={key:5,class:"flex items-center justify-between pt-6"},Ge={class:"text-sm text-gray-700"},Qe={class:"flex items-center space-x-2"},Re=["disabled"],He={class:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700"},Je=["disabled"],ut=Q({__name:"OrganizationsListView",setup(I){const h=W(),_=X(),c=g(""),x=g("all"),w=g(!1),v=g(null),u=g(1),k=g(12),L=g([{key:"all",label:"All Organizations",count:0},{key:"active",label:"Active",count:0},{key:"inactive",label:"Inactive",count:0},{key:"prospect",label:"Prospects",count:0}]),C=p(()=>_.organizations),y=p(()=>{let r=C.value;if(x.value!=="all"&&(r=r.filter(e=>{var l;return((l=e.status)==null?void 0:l.toLowerCase())===x.value})),c.value.trim()){const e=c.value.toLowerCase().trim();r=r.filter(l=>{var s,m,A;return l.name.toLowerCase().includes(e)||((s=l.industry)==null?void 0:s.toLowerCase().includes(e))||((m=l.website)==null?void 0:m.toLowerCase().includes(e))||((A=l.email)==null?void 0:A.toLowerCase().includes(e))})}return r}),$=p(()=>y.value.length),z=p(()=>Math.ceil($.value/k.value)),M=async()=>{w.value=!0,v.value=null;try{await _.fetchOrganizations(),P()}catch(r){console.error("Error loading organizations:",r),v.value="Failed to load organizations. Please try again."}finally{w.value=!1}},P=()=>{const r=C.value.reduce((e,l)=>{var m;e.all++;const s=((m=l.status)==null?void 0:m.toLowerCase())||"unknown";return e[s]=(e[s]||0)+1,e},{all:0,active:0,inactive:0,prospect:0});L.value.forEach(e=>{e.count=r[e.key]||0})},D=r=>{h.push(`/organizations/${r}`)},U=r=>{h.push(`/organizations/${r}/edit`)},Z=async r=>{const e=C.value.find(l=>l.id===r);if(e&&confirm(`Are you sure you want to delete "${e.name}"? This action cannot be undone.`))try{await _.deleteOrganization(r),P()}catch(l){console.error("Error deleting organization:",l),alert("Failed to delete organization. Please try again.")}},q=r=>{if(!r)return"bg-gray-100 text-gray-800";const e={Active:"bg-green-100 text-green-800",Inactive:"bg-gray-100 text-gray-800",Prospect:"bg-blue-100 text-blue-800",Customer:"bg-purple-100 text-purple-800",Partner:"bg-yellow-100 text-yellow-800",Vendor:"bg-indigo-100 text-indigo-800"};return e[r]||e.Inactive},G=r=>r||"Unknown";return j(c,()=>{u.value=1}),j(x,()=>{u.value=1}),R(()=>{M()}),(r,e)=>{const l=K("router-link");return a(),n("div",de,[t("div",ce,[e[5]||(e[5]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900"},"Organizations"),t("p",{class:"mt-1 text-sm text-gray-500"}," Manage your business organizations and client companies ")],-1)),t("div",ue,[t("div",me,[t("div",ge,[o(i(F),{class:"h-5 w-5 text-gray-400"})]),H(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),type:"text",placeholder:"Search organizations...",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},null,512),[[J,c.value]])]),o(l,{to:"/organizations/new",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:N(()=>[o(i(B),{class:"h-4 w-4 mr-2"}),e[4]||(e[4]=f(" Add Organization ",-1))]),_:1,__:[4]})])]),t("div",xe,[t("nav",be,[(a(!0),n(S,null,V(L.value,s=>(a(),n("button",{key:s.key,onClick:m=>x.value=s.key,class:O(["py-2 px-1 border-b-2 font-medium text-sm",x.value===s.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[f(d(s.label)+" ",1),s.count?(a(),n("span",{key:0,class:O(["ml-2 py-0.5 px-2 rounded-full text-xs",x.value===s.key?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"])},d(s.count),3)):b("",!0)],10,ve))),128))])]),w.value?(a(),n("div",ye,e[6]||(e[6]=[t("div",{class:"inline-flex items-center"},[t("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-3"}),t("span",{class:"text-gray-600"},"Loading organizations...")],-1)]))):v.value?(a(),n("div",pe,[t("div",fe,[o(i(Y),{class:"h-12 w-12 mx-auto"})]),e[8]||(e[8]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Error Loading Organizations",-1)),t("p",he,d(v.value),1),t("button",{onClick:M,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-600 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[o(i(ee),{class:"h-4 w-4 mr-2"}),e[7]||(e[7]=f(" Try Again ",-1))])])):y.value.length===0&&!c.value?(a(),n("div",_e,[o(i(T),{class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e[10]||(e[10]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No organizations yet",-1)),e[11]||(e[11]=t("p",{class:"text-gray-600 mb-6"},"Get started by adding your first organization.",-1)),o(l,{to:"/organizations/new",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:N(()=>[o(i(B),{class:"h-4 w-4 mr-2"}),e[9]||(e[9]=f(" Add Organization ",-1))]),_:1,__:[9]})])):y.value.length===0&&c.value?(a(),n("div",we,[o(i(F),{class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e[12]||(e[12]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No organizations found",-1)),t("p",ke,'No organizations match "'+d(c.value)+'"',1),t("button",{onClick:e[1]||(e[1]=s=>c.value=""),class:"text-blue-600 hover:text-blue-500 font-medium"}," Clear search ")])):(a(),n("div",Ce,[(a(!0),n(S,null,V(y.value,s=>(a(),n("div",{key:s.id,class:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow cursor-pointer",onClick:m=>D(s.id)},[t("div",ze,[t("div",Oe,[t("div",Le,[t("div",Me,[o(i(T),{class:"h-6 w-6 text-blue-600"})]),t("div",Pe,[t("h3",Ae,d(s.name),1),s.industry?(a(),n("p",je,d(s.industry),1)):b("",!0)])]),t("span",{class:O(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",q(s.status)])},d(G(s.status)),3)]),t("div",Ne,[s.website?(a(),n("div",Se,[o(i(re),{class:"h-4 w-4 mr-2 flex-shrink-0"}),t("span",Ve,d(s.website),1)])):b("",!0),s.primary_phone?(a(),n("div",Ee,[o(i(oe),{class:"h-4 w-4 mr-2 flex-shrink-0"}),t("span",null,d(s.primary_phone),1)])):b("",!0),s.email?(a(),n("div",Fe,[o(i(ne),{class:"h-4 w-4 mr-2 flex-shrink-0"}),t("span",Te,d(s.email),1)])):b("",!0)]),t("div",Be,[t("div",Ie,[o(i(ie),{class:"h-4 w-4 mr-1"}),t("span",null,d(s.employees_count||0)+" employees",1)]),t("div",De,[t("button",{onClick:E(m=>U(s.id),["stop"]),class:"p-1.5 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100","aria-label":`Edit ${s.name}`},[o(i(ae),{class:"h-4 w-4"})],8,Ue),t("button",{onClick:E(m=>Z(s.id),["stop"]),class:"p-1.5 text-red-400 hover:text-red-600 rounded-md hover:bg-red-50","aria-label":`Delete ${s.name}`},[o(i(le),{class:"h-4 w-4"})],8,Ze)])])])],8,$e))),128))])),z.value>1?(a(),n("div",qe,[t("div",Ge," Showing "+d((u.value-1)*k.value+1)+" to "+d(Math.min(u.value*k.value,$.value))+" of "+d($.value)+" organizations ",1),t("div",Qe,[t("button",{onClick:e[2]||(e[2]=s=>u.value--),disabled:u.value===1,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[o(i(te),{class:"h-5 w-5"})],8,Re),t("span",He,d(u.value)+" of "+d(z.value),1),t("button",{onClick:e[3]||(e[3]=s=>u.value++),disabled:u.value===z.value,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[o(i(se),{class:"h-5 w-5"})],8,Je)])])):b("",!0)])}}});export{ut as default};
//# sourceMappingURL=OrganizationsListView-D6jkmU7u.js.map
