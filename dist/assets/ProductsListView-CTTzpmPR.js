import{d as K,c as $,a as r,b as e,n as k,t as g,j as a,r as S,h as y,F as ee,i as te,s as N,l as A,K as oe,o as se,y as ae,f as R,w as Y,g as re,v as ne,m as T,p as W,q as ie,e as Q,k as le}from"./index-Br7bM97V.js";import{u as U}from"./productStore-tgpLBWvz.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as Z,e as de,a as ce,b as D,d as ue}from"./index.esm-DHR-h0Sg.js";import"./supabaseClient-CwaY5m9F.js";const pe={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 lg:gap-6",role:"region","aria-label":"Product Key Performance Indicators"},ve={class:"kpi-card-content"},ge={class:"kpi-details"},me={key:0,class:"loading-placeholder"},be={key:1},he={class:"kpi-card-content"},xe={class:"kpi-details"},ke={key:0,class:"loading-placeholder"},ye={key:1},fe={class:"kpi-card-content"},we={class:"kpi-details"},_e={key:0,class:"loading-placeholder"},Ce={key:1},$e={class:"kpi-subtitle"},Se={class:"kpi-card-content"},Me={class:"kpi-details"},Be={key:0,class:"loading-placeholder"},Pe={key:1},De=K({__name:"ProductKPICards",props:{loading:{type:Boolean,default:!1},customStats:{default:null}},emits:["cardClick"],setup(h){const _=h,m=U(),v=$(()=>_.customStats||m.stats),p=$(()=>_.loading||m.isLoading),i=l=>l>=1e9?(l/1e9).toFixed(1)+"B":l>=1e6?(l/1e6).toFixed(1)+"M":l>=1e3?(l/1e3).toFixed(1)+"K":l.toString(),x=l=>Math.round(l)+"%",u=()=>{var l;return(l=v.value)!=null&&l.products_by_category?Object.values(v.value.products_by_category).filter(o=>o>0).length:0},M=()=>{var l;return(l=v.value)!=null&&l.most_common_category?`Most: ${v.value.most_common_category}`:"No category"},f=()=>{var w;const l=((w=v.value)==null?void 0:w.active_products)||0;return l===0?0:Math.floor(l*.85)/l*100};return(l,o)=>{var w,j;return a(),r("div",pe,[e("div",{class:"kpi-card",onClick:o[0]||(o[0]=b=>l.$emit("cardClick","total")),tabindex:"0",role:"button","aria-label":"View all products"},[e("div",ve,[o[6]||(o[6]=e("div",{class:"kpi-icon kpi-icon-blue"},[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})])],-1)),e("div",ge,[o[4]||(o[4]=e("div",{class:"kpi-label"},"Total Products",-1)),e("div",{class:k(["kpi-value",{"kpi-loading":p.value}])},[p.value?(a(),r("span",me,"--")):(a(),r("span",be,g(i(((w=v.value)==null?void 0:w.total_products)||0)),1))],2),o[5]||(o[5]=e("div",{class:"kpi-subtitle"},"In catalog",-1))])])]),e("div",{class:"kpi-card",onClick:o[1]||(o[1]=b=>l.$emit("cardClick","active")),tabindex:"0",role:"button","aria-label":"View active products"},[e("div",he,[o[9]||(o[9]=e("div",{class:"kpi-icon kpi-icon-green"},[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",xe,[o[7]||(o[7]=e("div",{class:"kpi-label"},"Active Products",-1)),e("div",{class:k(["kpi-value",{"kpi-loading":p.value}])},[p.value?(a(),r("span",ke,"--")):(a(),r("span",ye,g(i(((j=v.value)==null?void 0:j.active_products)||0)),1))],2),o[8]||(o[8]=e("div",{class:"kpi-subtitle"},"Available for sale",-1))])])]),e("div",{class:"kpi-card",onClick:o[2]||(o[2]=b=>l.$emit("cardClick","categories")),tabindex:"0",role:"button","aria-label":"View categories breakdown"},[e("div",fe,[o[11]||(o[11]=e("div",{class:"kpi-icon kpi-icon-purple"},[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})])],-1)),e("div",we,[o[10]||(o[10]=e("div",{class:"kpi-label"},"Categories",-1)),e("div",{class:k(["kpi-value",{"kpi-loading":p.value}])},[p.value?(a(),r("span",_e,"--")):(a(),r("span",Ce,g(u()),1))],2),e("div",$e,g(M()),1)])])]),e("div",{class:"kpi-card",onClick:o[3]||(o[3]=b=>l.$emit("cardClick","principals")),tabindex:"0",role:"button","aria-label":"View principal assignments"},[e("div",Se,[o[14]||(o[14]=e("div",{class:"kpi-icon kpi-icon-emerald"},[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])],-1)),e("div",Me,[o[12]||(o[12]=e("div",{class:"kpi-label"},"Principal Coverage",-1)),e("div",{class:k(["kpi-value",{"kpi-loading":p.value}])},[p.value?(a(),r("span",Be,"--%")):(a(),r("span",Pe,g(x(f())),1))],2),o[13]||(o[13]=e("div",{class:"kpi-subtitle"},"With assignments",-1))])])])])}}}),je=q(De,[["__scopeId","data-v-b7a03d6f"]]);var J=(h=>(h.PROTEIN="Protein",h.SAUCE="Sauce",h.SEASONING="Seasoning",h.BEVERAGE="Beverage",h.SNACK="Snack",h.FROZEN="Frozen",h.DAIRY="Dairy",h.BAKERY="Bakery",h.OTHER="Other",h))(J||{});Z({name:D().required("Product name is required").min(2,"Name must be at least 2 characters").max(200,"Name must be less than 200 characters"),description:D().max(1e3,"Description must be less than 1000 characters").nullable(),category:D().required("Category is required").oneOf(Object.values(J),"Invalid category selected").nullable(),unit_price:ue().min(0,"Price cannot be negative").nullable(),sku:D().max(50,"SKU must be less than 50 characters").nullable(),is_active:ce().default(!0),principal_ids:de(D().uuid("Invalid principal ID")).min(1,"At least one principal must be assigned").required("Principal assignment is required")});Z({product_id:D().required("Product ID is required").uuid("Invalid product ID"),principal_id:D().required("Principal ID is required").uuid("Invalid principal ID")});const Ie={Protein:"ðŸ¥©",Sauce:"ðŸ¥«",Seasoning:"ðŸ§‚",Beverage:"ðŸ¥¤",Snack:"ðŸ¿",Frozen:"ðŸ§Š",Dairy:"ðŸ¥›",Bakery:"ðŸž",Other:"ðŸ“¦"},Ae={class:"product-table-container"},Ne={key:0,class:"bg-blue-50 border border-blue-200 rounded-t-lg p-4"},Fe={class:"flex items-center justify-between"},Ve={class:"flex items-center space-x-3"},Oe={class:"text-sm font-medium text-blue-900"},ze={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},Ee={class:"overflow-x-auto"},He={class:"min-w-full divide-y divide-gray-200"},Le={class:"bg-gray-50"},Re={scope:"col",class:"px-4 py-3 text-left"},Te=["checked",".indeterminate"],Ke={class:"flex items-center space-x-1"},Ue={class:"flex items-center space-x-1"},qe={class:"flex items-center space-x-1"},Ge={class:"flex items-center space-x-1"},Ye={class:"bg-white divide-y divide-gray-200"},We={key:0},Qe=["onClick"],Ze=["value","aria-label"],Je={class:"px-6 py-4 whitespace-nowrap"},Xe={class:"flex items-center"},et={class:"flex-shrink-0 h-10 w-10"},tt={class:"h-10 w-10 rounded-lg bg-gray-100 flex items-center justify-center"},ot={class:"text-lg"},st={class:"ml-4"},at={class:"text-sm font-medium text-gray-900"},rt={key:0,class:"text-sm text-gray-500"},nt={class:"px-6 py-4 whitespace-nowrap"},it={key:1,class:"text-gray-400 text-sm"},lt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},dt={key:0},ct={key:1,class:"text-gray-400"},ut={class:"px-6 py-4 whitespace-nowrap"},pt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},vt={class:"flex items-center"},gt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},mt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},bt={class:"flex items-center space-x-2"},ht=["onClick","aria-label"],xt=["onClick","aria-label"],kt=["onClick","aria-label"],yt={key:1,class:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6"},ft={class:"flex items-center justify-between"},wt={class:"text-sm text-gray-700"},_t=K({__name:"ProductTable",props:{loading:{type:Boolean,default:!1}},emits:["rowClick","edit","delete","duplicate","bulkDelete","createNew","sortChange"],setup(h,{emit:_}){const m=_,v=U(),p=$(()=>v.products),i=S([]),x=S("created_at"),u=S("desc"),M=$(()=>p.value.length>0&&i.value.length===p.value.length),f=$(()=>i.value.length>0&&i.value.length<p.value.length),l=()=>{M.value?i.value=[]:i.value=p.value.map(n=>n.id)},o=()=>{i.value=[]},w=async()=>{if(i.value.length===0)return;const n={operation:"activate",product_ids:i.value,parameters:{is_active:!0}};await v.performBulkOperation(n)&&o()},j=async()=>{if(i.value.length===0)return;const n={operation:"deactivate",product_ids:i.value,parameters:{is_active:!1}};await v.performBulkOperation(n)&&o()},b=()=>{i.value.length!==0&&(m("bulkDelete",[...i.value]),o())},C=n=>{x.value===n?u.value=u.value==="asc"?"desc":"asc":(x.value=n,u.value="asc"),m("sortChange",n,u.value)},F=n=>{m("rowClick",n)},V=n=>{m("edit",n)},O=n=>{m("delete",n)},I=n=>{m("duplicate",n)},z=n=>n&&Ie[n]||"ðŸ“¦",E=n=>({Protein:"bg-red-100 text-red-800",Sauce:"bg-orange-100 text-orange-800",Seasoning:"bg-green-100 text-green-800",Beverage:"bg-blue-100 text-blue-800",Snack:"bg-yellow-100 text-yellow-800",Frozen:"bg-cyan-100 text-cyan-800",Dairy:"bg-purple-100 text-purple-800",Bakery:"bg-pink-100 text-pink-800",Other:"bg-gray-100 text-gray-800"})[n]||"bg-gray-100 text-gray-800",H=n=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(n),L=n=>n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Unknown";return(n,t)=>(a(),r("div",Ae,[i.value.length>0?(a(),r("div",Ne,[e("div",Fe,[e("div",Ve,[e("span",Oe,g(i.value.length)+" product"+g(i.value.length===1?"":"s")+" selected ",1),e("button",{onClick:o,class:"text-blue-600 hover:text-blue-800 text-sm font-medium"}," Clear selection ")]),e("div",{class:"flex items-center space-x-2"},[e("button",{onClick:w,class:"px-3 py-1 text-sm font-medium text-green-700 bg-green-100 border border-green-200 rounded-md hover:bg-green-200"}," Activate "),e("button",{onClick:j,class:"px-3 py-1 text-sm font-medium text-yellow-700 bg-yellow-100 border border-yellow-200 rounded-md hover:bg-yellow-200"}," Deactivate "),e("button",{onClick:b,class:"px-3 py-1 text-sm font-medium text-red-700 bg-red-100 border border-red-200 rounded-md hover:bg-red-200"}," Delete ")])])])):y("",!0),e("div",ze,[e("div",Ee,[e("table",He,[e("thead",Le,[e("tr",null,[e("th",Re,[e("input",{type:"checkbox",checked:M.value,".indeterminate":f.value,onChange:l,class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded","aria-label":"Select all products"},null,40,Te)]),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:t[0]||(t[0]=d=>C("name"))},[e("div",Ke,[t[7]||(t[7]=e("span",null,"Product",-1)),x.value==="name"?(a(),r("svg",{key:0,class:k(["h-4 w-4",u.value==="asc"?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[6]||(t[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2)):y("",!0)])]),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:t[1]||(t[1]=d=>C("category"))},[e("div",Ue,[t[9]||(t[9]=e("span",null,"Category",-1)),x.value==="category"?(a(),r("svg",{key:0,class:k(["h-4 w-4",u.value==="asc"?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[8]||(t[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2)):y("",!0)])]),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:t[2]||(t[2]=d=>C("unit_price"))},[e("div",qe,[t[11]||(t[11]=e("span",null,"Price",-1)),x.value==="unit_price"?(a(),r("svg",{key:0,class:k(["h-4 w-4",u.value==="asc"?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[10]||(t[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2)):y("",!0)])]),t[14]||(t[14]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status ",-1)),t[15]||(t[15]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Principals ",-1)),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:t[3]||(t[3]=d=>C("created_at"))},[e("div",Ge,[t[13]||(t[13]=e("span",null,"Created",-1)),x.value==="created_at"?(a(),r("svg",{key:0,class:k(["h-4 w-4",u.value==="asc"?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[12]||(t[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2)):y("",!0)])]),t[16]||(t[16]=e("th",{scope:"col",class:"relative px-6 py-3"},[e("span",{class:"sr-only"},"Actions")],-1))])]),e("tbody",Ye,[n.loading&&p.value.length===0?(a(),r("tr",We,t[17]||(t[17]=[e("td",{colspan:"8",class:"px-6 py-12 text-center"},[e("div",{class:"flex justify-center"},[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})]),e("p",{class:"text-gray-500 mt-4"},"Loading products...")],-1)]))):y("",!0),(a(!0),r(ee,null,te(p.value,d=>(a(),r("tr",{key:d.id,class:"hover:bg-gray-50 cursor-pointer transition-colors duration-150",onClick:B=>F(d)},[e("td",{class:"px-4 py-4",onClick:t[5]||(t[5]=N(()=>{},["stop"]))},[A(e("input",{type:"checkbox",value:d.id,"onUpdate:modelValue":t[4]||(t[4]=B=>i.value=B),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded","aria-label":`Select ${d.name}`},null,8,Ze),[[oe,i.value]])]),e("td",Je,[e("div",Xe,[e("div",et,[e("div",tt,[e("span",ot,g(z(d.category)),1)])]),e("div",st,[e("div",at,g(d.name),1),d.sku?(a(),r("div",rt," SKU: "+g(d.sku),1)):y("",!0)])])]),e("td",nt,[d.category?(a(),r("span",{key:0,class:k(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",E(d.category)])},g(d.category),3)):(a(),r("span",it,"No category"))]),e("td",lt,[d.unit_price?(a(),r("span",dt," $"+g(H(d.unit_price)),1)):(a(),r("span",ct,"Not set"))]),e("td",ut,[e("span",{class:k(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",d.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},g(d.is_active?"Active":"Inactive"),3)]),e("td",pt,[e("div",vt,[t[18]||(t[18]=e("svg",{class:"h-4 w-4 text-gray-400 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),e("span",null,g(d.principal_count||0),1)])]),e("td",gt,g(L(d.created_at)),1),e("td",mt,[e("div",bt,[e("button",{onClick:N(B=>V(d),["stop"]),class:"text-blue-600 hover:text-blue-900 p-1 rounded-md hover:bg-blue-50","aria-label":`Edit ${d.name}`},t[19]||(t[19]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,ht),e("button",{onClick:N(B=>I(d),["stop"]),class:"text-gray-600 hover:text-gray-900 p-1 rounded-md hover:bg-gray-50","aria-label":`Duplicate ${d.name}`},t[20]||(t[20]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)]),8,xt),e("button",{onClick:N(B=>O(d),["stop"]),class:"text-red-600 hover:text-red-900 p-1 rounded-md hover:bg-red-50","aria-label":`Delete ${d.name}`},t[21]||(t[21]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,kt)])])],8,Qe))),128))])])])]),p.value.length>0?(a(),r("div",yt,[e("div",ft,[e("div",wt," Showing "+g(p.value.length)+" products ",1)])])):y("",!0)]))}}),Ct=q(_t,[["__scopeId","data-v-ba03aa28"]]),$t={class:"products-list-view","data-testid":"products-list-view"},St={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-8","data-testid":"products-header"},Mt={class:"flex items-center space-x-3"},Bt=["disabled","aria-label"],Pt={class:"mb-8","data-testid":"kpi-cards-section"},Dt={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},jt={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},It={class:"flex-1 max-w-md"},At={class:"relative"},Nt={class:"flex items-center space-x-3"},Ft=["aria-label"],Vt={class:"h-5 w-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ot=["d"],zt={class:"space-y-6"},Et={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8","data-testid":"loading-spinner"},Ht={key:1,class:"bg-white rounded-lg shadow-sm border border-red-200 p-6","data-testid":"error-message"},Lt={class:"flex items-center"},Rt={class:"text-red-700"},Tt={key:2,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center"},Kt={class:"text-lg font-medium text-gray-900 mb-2"},Ut={class:"text-gray-500 mb-6"},qt={class:"flex justify-center space-x-3"},Gt={key:3,"data-testid":"product-table-section"},Yt=K({__name:"ProductsListView",setup(h){const _=le(),m=U(),v=S(""),p=S("created_at"),i=S("desc"),x=S(!1),u=S({search:"",category:[],is_active:void 0,price_min:void 0,price_max:void 0}),M=$(()=>m.products),f=$(()=>m.isLoading),l=$(()=>m.error),o=$(()=>{var c;return!!(v.value||(c=u.value.category)!=null&&c.length||u.value.is_active!==void 0||u.value.price_min!==void 0||u.value.price_max!==void 0||u.value.principal_id||u.value.created_after||u.value.created_before)});let w;const j=()=>{clearTimeout(w),w=setTimeout(()=>{b()},300)},b=async()=>{const c={...u.value};v.value.trim()&&(c.search=v.value.trim());const s={page:1,limit:20,sort_by:p.value,sort_order:i.value};await m.fetchProducts({...c,...s})},C=()=>{v.value="",u.value={search:"",category:[],is_active:void 0,price_min:void 0,price_max:void 0},p.value="created_at",i.value="desc",b()},F=()=>{b()},V=()=>{i.value=i.value==="asc"?"desc":"asc",b()},O=(c,s)=>{p.value=c,i.value=s,b()},I=async()=>{await Promise.all([z(),E()])},z=async()=>{const c={...u.value};v.value.trim()&&(c.search=v.value.trim());const s={page:1,limit:20,sort_by:p.value,sort_order:i.value};await m.fetchProducts({...c,...s})},E=async()=>{x.value=!0;try{await m.fetchStats()}finally{x.value=!1}},H=c=>{switch(console.log("KPI card clicked:",c),c){case"total":C();break;case"active":u.value.is_active=!0,b();break;case"inactive":u.value.is_active=!1,b();break}},L=c=>{_.push(`/products/${c.id}`)},n=c=>{_.push(`/products/${c.id}/edit`)},t=async c=>{confirm(`Are you sure you want to delete "${c.name}"? This will deactivate the product but preserve the data.`)&&await m.deleteProduct(c.id)},d=c=>{console.log("Duplicate product:",c.id)},B=async c=>{if(confirm(`Are you sure you want to deactivate ${c.length} products? This action can be reversed later.`)){const s={operation:"deactivate",product_ids:c};await m.performBulkOperation(s)}},X=()=>{_.push("/products/new")};return se(async()=>{await I()}),ae(()=>_.currentRoute.value.fullPath,c=>{c==="/products"&&I()}),(c,s)=>{const G=re("router-link");return a(),r("div",$t,[e("div",St,[s[7]||(s[7]=e("div",{class:"mb-4 lg:mb-0"},[e("h1",{class:"text-3xl font-bold text-gray-900","data-testid":"page-title"},"Products"),e("p",{class:"mt-2 text-gray-600"}," Manage your product catalog and principal assignments ")],-1)),e("div",Mt,[e("button",{onClick:I,disabled:f.value,class:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50","aria-label":f.value?"Refreshing...":"Refresh data"},[(a(),r("svg",{class:k(["h-4 w-4",{"animate-spin":f.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},s[4]||(s[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]),2)),s[5]||(s[5]=e("span",{class:"ml-2 hidden sm:inline"},"Refresh",-1))],8,Bt),R(G,{to:"/products/new",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:Y(()=>s[6]||(s[6]=[e("svg",{class:"-ml-1 mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),Q(" New Product ",-1)])),_:1,__:[6]})])]),e("div",Pt,[R(je,{loading:x.value,onCardClick:H,"data-testid":"kpi-cards"},null,8,["loading"])]),e("div",Dt,[e("div",jt,[e("div",It,[s[9]||(s[9]=e("label",{for:"search",class:"sr-only"},"Search products",-1)),e("div",At,[s[8]||(s[8]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),A(e("input",{id:"search","onUpdate:modelValue":s[0]||(s[0]=P=>v.value=P),type:"text",placeholder:"Search products...",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500",onInput:j},null,544),[[ne,v.value]])])]),e("div",Nt,[A(e("select",{"onUpdate:modelValue":s[1]||(s[1]=P=>u.value.category=P),class:"block w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",onChange:b},s[10]||(s[10]=[W('<option value="" data-v-0d9e3253>All Categories</option><option value="Protein" data-v-0d9e3253>Protein</option><option value="Sauce" data-v-0d9e3253>Sauce</option><option value="Seasoning" data-v-0d9e3253>Seasoning</option><option value="Beverage" data-v-0d9e3253>Beverage</option><option value="Snack" data-v-0d9e3253>Snack</option><option value="Frozen" data-v-0d9e3253>Frozen</option><option value="Dairy" data-v-0d9e3253>Dairy</option><option value="Bakery" data-v-0d9e3253>Bakery</option><option value="Other" data-v-0d9e3253>Other</option>',10)]),544),[[T,u.value.category]]),A(e("select",{"onUpdate:modelValue":s[2]||(s[2]=P=>u.value.is_active=P),class:"block w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",onChange:b},s[11]||(s[11]=[e("option",{value:""},"All Products",-1),e("option",{value:!0},"Active Only",-1),e("option",{value:!1},"Inactive Only",-1)]),544),[[T,u.value.is_active]]),A(e("select",{"onUpdate:modelValue":s[3]||(s[3]=P=>p.value=P),class:"block w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",onChange:F},s[12]||(s[12]=[W('<option value="created_at" data-v-0d9e3253>Sort by Created Date</option><option value="name" data-v-0d9e3253>Sort by Name</option><option value="category" data-v-0d9e3253>Sort by Category</option><option value="unit_price" data-v-0d9e3253>Sort by Price</option><option value="updated_at" data-v-0d9e3253>Sort by Updated Date</option>',5)]),544),[[T,p.value]]),e("button",{onClick:V,class:k(["p-2 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-blue-500",{"bg-gray-50":i.value==="desc"}]),"aria-label":`Sort ${i.value==="asc"?"descending":"ascending"}`},[(a(),r("svg",Vt,[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:i.value==="asc"?"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12":"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"},null,8,Ot)]))],10,Ft),o.value?(a(),r("button",{key:0,onClick:C,class:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800 focus:outline-none focus:ring-1 focus:ring-blue-500 rounded-md"}," Clear Filters ")):y("",!0)])])]),e("div",zt,[f.value&&M.value.length===0?(a(),r("div",Et,s[13]||(s[13]=[e("div",{class:"flex justify-center"},[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})],-1),e("p",{class:"text-center text-gray-500 mt-4"},"Loading products...",-1)]))):l.value?(a(),r("div",Ht,[e("div",Lt,[s[14]||(s[14]=e("svg",{class:"h-5 w-5 text-red-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",Rt,g(l.value),1)]),e("div",{class:"mt-4 flex space-x-3"},[e("button",{onClick:I,class:"px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700","data-testid":"retry-button"}," Try Again "),e("button",{onClick:C,class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"}," Clear Filters ")])])):M.value.length===0&&!f.value?(a(),r("div",Tt,[s[16]||(s[16]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1)),e("h3",Kt,g(o.value?"No products match your search":"No products found"),1),e("p",Ut,g(o.value?"Try adjusting your search terms or filters.":"Get started by adding your first product to the catalog."),1),e("div",qt,[o.value?y("",!0):(a(),ie(G,{key:0,to:"/products/new",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700"},{default:Y(()=>s[15]||(s[15]=[e("svg",{class:"-ml-1 mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),Q(" Add Your First Product ",-1)])),_:1,__:[15]})),o.value?(a(),r("button",{key:1,onClick:C,class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"}," Clear All Filters ")):y("",!0)])])):(a(),r("div",Gt,[R(Ct,{loading:f.value,onRowClick:L,onEdit:n,onDelete:t,onDuplicate:d,onBulkDelete:B,onCreateNew:X,onSortChange:O,"data-testid":"product-table"},null,8,["loading"])]))])])}}}),eo=q(Yt,[["__scopeId","data-v-0d9e3253"]]);export{eo as default};
//# sourceMappingURL=ProductsListView-CTTzpmPR.js.map
