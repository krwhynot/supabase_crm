import{a as g,j as p,b as e,H as _t,r as k,c as h,x as Ae,y as Ne,d as pe,F as te,i as ae,t as D,h as U,e as R,A as ke,s as ne,f as P,k as He,n as K,q as ht,z as vt,L as E,o as Be,u as z,w as Y,l as G,m as Ue,v as ue,K as ze,g as yt}from"./index-Br7bM97V.js";import{D as bt,a as Ve}from"./PrincipalDashboard.vue_vue_type_style_index_0_scoped_daf2c332_lang-BIJTg4sV.js";import{p as Z,E as wt}from"./EngagementScoreRing-DT1wV0O8.js";import{u as xt}from"./principalStore-JxlbTJes.js";import{P as kt}from"./PrincipalSelector-BnLK-7If.js";import{P as Pt}from"./PrincipalKPICards-VC-jnROq.js";import{r as Dt,S as Ct,Y as Mt,h as Re,G as Tt,V as St,P as $t,a as Et,b as It,C as Ut,M as At}from"./ManagePrincipalProductsButton-C35igKQe.js";import{P as Bt}from"./PrincipalProductTable-DamRyvpV.js";import{D as Ft}from"./DistributorRelationshipTable-D5OL9Gck.js";import{S as Ot}from"./StageTag-D7sxksDU.js";import{P as jt}from"./ProbabilityBar-Bu_0yKcY.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as Lt}from"./productStore-tgpLBWvz.js";import{u as zt}from"./interactionStore-Do0zDCsY.js";import{r as Vt}from"./XMarkIcon-Bq58FYA6.js";import{r as qe}from"./ExclamationTriangleIcon-3AUMR-W2.js";import{r as Rt}from"./StarIcon-BOg-5s6P.js";import{r as Nt}from"./UserGroupIcon-Bll1C4SH.js";import"./ManagePrincipalProductsButton.vue_vue_type_style_index_0_scoped_f75a9cbf_lang-BYCK-O3L.js";import"./supabaseClient-CwaY5m9F.js";/* empty css                                                                       *//* empty css                                                                          */import"./opportunityStore-MF-7Z0oO.js";/* empty css                                                                                     *//* empty css                                                                       */import"./index.esm-DHR-h0Sg.js";import"./organizationsApi-ByKMXw3t.js";import"./MagnifyingGlassIcon-BepCswCi.js";import"./CalendarIcon-CBoVSP04.js";import"./BuildingOfficeIcon-CE9ZCi7A.js";import"./CheckIcon-0UoNe-IG.js";import"./TrendIndicator-BEIfMvpj.js";import"./ClockIcon-_yqAmiAM.js";import"./TrophyIcon-CXbi3cSE.js";import"./DocumentIcon-Bs8VjWfc.js";import"./PhoneIcon-CrBznpFF.js";import"./OpportunityPipelineChart-BahNKFfp.js";import"./FunnelIcon-BWby5dJb.js";import"./CurrencyDollarIcon-1X_qr0xd.js";import"./ArrowPathIcon-D9Yw9nnG.js";import"./PlusIcon-88x01lis.js";import"./ArrowDownTrayIcon-CCm-ihbv.js";import"./ChevronUpIcon-DaM_MkII.js";import"./CheckCircleIcon-Ct_Yhl-Z.js";function Ht(I,O){return p(),g("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}const Ge=_t("principalActivity",()=>{const I=k([]),O=k(!1),l=k(null),r=k(null),$=k(null),S=k(null),M=k(null),A=k(""),B=k(null),s=h({get:()=>I.value,set:a=>{I.value=[...a]}}),m=h({get:()=>O.value,set:a=>{O.value=a}}),C=h({get:()=>l.value,set:a=>{l.value=a}}),b=h({get:()=>r.value,set:a=>{r.value=a}}),j=h({get:()=>$.value,set:a=>{$.value=a}}),y=h({get:()=>S.value,set:a=>{S.value=a}}),f=h({get:()=>M.value,set:a=>{M.value=a}}),v=h({get:()=>A.value,set:a=>{A.value=a,t.searchQuery=a}}),q=h({get:()=>B.value||t.lastFetched,set:a=>{B.value=a,t.lastFetched=a}}),V=h(()=>t.principals),oe=h(()=>t.metricsSummary),ie=h(()=>t.selectedPrincipal),re=h(()=>t.dashboardData),le=h({get:()=>t.analytics,set:a=>{t.analytics=a}}),d=h({get:()=>t.activeFilters,set:a=>{t.activeFilters=a}}),n=h(()=>t.principalOptions),W=h({get:()=>t.loading,set:a=>{t.loading=a}}),J=h(()=>t.dataStale),N=k({page:1,limit:20,total:0,total_pages:0,has_next:!1,has_previous:!1}),se=h({get:()=>N.value||t.pagination,set:a=>{N.value={...a},t.pagination={...a}}}),t=Ae({principals:[],selectedPrincipal:null,distributorRelationships:[],productPerformance:[],timelineEntries:[],dashboardData:null,principalOptions:[],loading:!1,loadingDashboard:!1,loadingTimeline:!1,calculatingAnalytics:!1,refreshing:!1,processingBatch:!1,error:null,dashboardError:null,timelineError:null,analyticsError:null,searchQuery:"",activeFilters:{...Ve},sortConfig:{...bt},pagination:{page:1,limit:20,total:0,total_pages:0,has_next:!1,has_previous:!1},analytics:null,metricsSummary:null,realTimeMetrics:{last_updated:null,update_frequency:3e4,auto_refresh:!0},batchMode:!1,maxSelections:null,lastFetched:null,cacheDuration:3e5,dataStale:!1});let H=null;const X=h(()=>t.loading||t.loadingDashboard||t.loadingTimeline||t.calculatingAnalytics||t.refreshing||t.processingBatch),Pe=h(()=>!!(r.value||$.value||S.value||M.value)),De=h(()=>[r.value,$.value,S.value,M.value].filter(Boolean).join("; ")),Ce=h(()=>t.principals.length),Me=h(()=>t.principals.filter(a=>a.activity_status==="ACTIVE").length),ge=h(()=>{var o,w,x,F,T;const a=d.value;return!!(a.search||(o=a.activity_status)!=null&&o.length||(w=a.organization_status)!=null&&w.length||(x=a.organization_type)!=null&&x.length||(F=a.product_categories)!=null&&F.length||a.has_opportunities!==void 0&&a.has_opportunities!==null||a.has_products!==void 0&&a.has_products!==null||a.engagement_score_range||a.lead_score_range||(T=a.country)!=null&&T.length||a.is_principal!==void 0&&a.is_principal!==null||a.is_distributor!==void 0&&a.is_distributor!==null||a.created_after||a.created_before)}),fe=h(()=>I.value.length),_e=h(()=>l.value?I.value.length>=l.value:!1),he=h(()=>a=>t.principals.find(o=>o.principal_id===a)),ve=h(()=>t.principals.filter(a=>I.value.includes(a.principal_id))),ye=h(()=>{const a=new Map;return t.principals.forEach(o=>{const w=o.activity_status;a.has(w)||a.set(w,[]),a.get(w).push(o)}),a}),be=h(()=>{const a=new Map;return t.principals.forEach(o=>{const w=o.organization_type||"Unknown";a.has(w)||a.set(w,[]),a.get(w).push(o)}),a}),Te=h(()=>[...t.principals].sort((a,o)=>o.engagement_score-a.engagement_score).slice(0,10)),c=h(()=>t.principals.filter(a=>a.follow_ups_required>0)),u=h(()=>t.lastFetched?Date.now()-t.lastFetched.getTime()>t.cacheDuration:!0),L=async(a={},o={},w={})=>{t.loading=!0,r.value=null;try{const x={...t.activeFilters,...a},F={...t.sortConfig,...o},T={page:w.page||t.pagination.page,limit:w.limit||t.pagination.limit},i=await Z.getPrincipalSummaries(x,F,T);if(i.success&&i.data){const _=i.data;console.log("DEBUG: fetchPrincipals response =",i),console.log("DEBUG: listResponse =",_),console.log("DEBUG: listResponse.data =",_.data),t.principals=_.data,t.pagination=_.pagination,N.value={..._.pagination},t.activeFilters=_.filters,t.sortConfig=_.sort,_.analytics_summary&&(t.metricsSummary={total_principals:_.analytics_summary.total_count,active_this_month:_.analytics_summary.active_count,top_engagement_score:Math.max(..._.data.map(ee=>ee.engagement_score)),opportunities_created_this_month:_.data.reduce((ee,de)=>ee+de.opportunities_last_30_days,0),interactions_this_week:Math.floor(_.data.reduce((ee,de)=>ee+de.interactions_last_30_days,0)/4),pending_follow_ups:_.data.reduce((ee,de)=>ee+de.follow_ups_required,0)});const Q=new Date;B.value=Q,t.lastFetched=Q,t.dataStale=!1}else r.value=i.error||"Failed to fetch principals"}catch(x){r.value=x instanceof Error?x.message:"Unexpected error occurred",console.error("Principal fetch error:",x)}finally{t.loading=!1}},we=async a=>{t.loadingDashboard=!0,$.value=null;try{const o=await Z.getPrincipalDashboard(a);o.success&&o.data?(t.dashboardData=o.data,t.selectedPrincipal=t.dashboardData.summary):$.value=o.error||"Failed to fetch principal dashboard"}catch(o){$.value=o instanceof Error?o.message:"Dashboard fetch failed",console.error("Dashboard fetch error:",o)}finally{t.loadingDashboard=!1}},xe=async(a,o=50)=>{t.loadingTimeline=!0,S.value=null;try{const w=await Z.getPrincipalTimeline(a,o);w.success&&w.data?t.timelineEntries=w.data:S.value=w.error||"Failed to fetch timeline"}catch(w){S.value=w instanceof Error?w.message:"Timeline fetch failed",console.error("Timeline fetch error:",w)}finally{t.loadingTimeline=!1}},Fe=async()=>{t.loading=!0,r.value=null;try{const a=await Z.getDistributorRelationships();a.success&&a.data?t.distributorRelationships=a.data:r.value=a.error||"Failed to fetch distributor relationships"}catch(a){r.value=a instanceof Error?a.message:"Failed to fetch relationships",console.error("Distributor relationships fetch error:",a)}finally{t.loading=!1}},Oe=async a=>{t.loading=!0,r.value=null;try{const o=await Z.getProductPerformance(a);o.success&&o.data?t.productPerformance=o.data:r.value=o.error||"Failed to fetch product performance"}catch(o){r.value=o instanceof Error?o.message:"Product performance fetch failed",console.error("Product performance fetch error:",o)}finally{t.loading=!1}},ce=async(a=!1)=>{if(!(t.analytics&&!a&&t.realTimeMetrics.last_updated&&Date.now()-t.realTimeMetrics.last_updated.getTime()<t.realTimeMetrics.update_frequency)){t.calculatingAnalytics=!0,M.value=null;try{const o=await Z.calculateAnalytics(t.principals);o.success&&o.data?(t.analytics=o.data,t.realTimeMetrics.last_updated=new Date):M.value=o.error||"Analytics calculation failed"}catch(o){M.value=o instanceof Error?o.message:"Analytics calculation error",console.error("Analytics calculation error:",o)}finally{t.calculatingAnalytics=!1}}},Qe=async()=>{t.principals.length===0?await L():await ce(!0)},Ze=async(a,o={})=>{A.value=a,t.searchQuery=a;const w={...o,search:a};await L(w,{},{page:1})},Ye=async a=>{const o={...t.activeFilters,...a};await L(o,{},{page:1})},Ke=async()=>{A.value="",t.searchQuery="",await L(Ve,{},{page:1})},We=async a=>{const o={...t.sortConfig,...a};await L({},o,{page:1})},Se=async a=>{const o=N.value||t.pagination;a<1||a>o.total_pages||await L({},{},{page:a})},Je=async()=>{const a=N.value||t.pagination;a.has_next&&await Se(a.page+1)},Xe=async()=>{const a=N.value||t.pagination;a.has_previous&&await Se(a.page-1)},et=async a=>{await L({},{},{page:1,limit:a})},tt=a=>{const o=I.value,w=o.indexOf(a);w>-1?I.value=o.filter((x,F)=>F!==w):(!l.value||o.length<l.value)&&(I.value=[...o,a])},je=a=>{const o=l.value?a.slice(0,l.value):a;I.value=[...o]},$e=()=>{I.value=[]},at=()=>{const a=t.principals.map(o=>o.principal_id);je(a)},ot=a=>I.value.includes(a),st=(a,o)=>{O.value=a,l.value=o||null,a||$e()},nt=async a=>{if(console.log("DEBUG: batchUpdatePrincipals called, selectedIds =",I.value),I.value.length===0)return!1;t.processingBatch=!0,r.value=null;try{const o=await Z.batchUpdatePrincipals(I.value,a);return console.log("DEBUG: API response =",o),o.success?(await L(),$e(),!0):(console.log("DEBUG: Setting error =",o.error),r.value=o.error||"Batch update failed",console.log("DEBUG: state.error after setting =",t.error),!1)}catch(o){return r.value=o instanceof Error?o.message:"Batch update failed",!1}finally{t.processingBatch=!1}},it=(a="csv")=>{const o=ve.value;if(a==="json")return JSON.stringify(o,null,2);const w=["Principal Name","Organization Type","Activity Status","Engagement Score","Total Interactions","Total Opportunities","Last Activity Date"],x=o.map(T=>[T.principal_name,T.organization_type||"",T.activity_status,T.engagement_score.toString(),T.total_interactions.toString(),T.total_opportunities.toString(),T.last_activity_date||""]);let F=w.join(",")+`
`;return F+=x.map(T=>T.map(i=>`"${i}"`).join(",")).join(`
`),F},rt=async()=>{t.refreshing=!0;try{await Promise.all([L(),Fe(),Oe()]),t.principals.length>0&&await ce(!0)}catch(a){r.value=a instanceof Error?a.message:"Refresh failed"}finally{t.refreshing=!1}},lt=()=>{r.value=null,$.value=null,S.value=null,M.value=null},ct=a=>{t.selectedPrincipal={...a}},dt=()=>{t.selectedPrincipal=null,t.dashboardData=null},ut=async(a={},o=!1)=>{o&&(t.lastFetched=null),await L(a),t.principals.length>0&&await ce()},pt=async a=>{try{const o=await Z.getPrincipalOptions(a);return o.success&&o.data?(t.principalOptions=o.data,t.principalOptions):(r.value=o.error||"Failed to fetch principal options",[])}catch(o){return r.value=o instanceof Error?o.message:"Failed to fetch options",[]}},mt=async a=>{t.calculatingAnalytics=!0,M.value=null;try{const o=a?t.principals.filter(x=>x.principal_id===a):t.principals;if(o.length===0){M.value="No principal data available for engagement breakdown";return}const w={high_engagement:o.filter(x=>x.engagement_score>=80).length,medium_engagement:o.filter(x=>x.engagement_score>=50&&x.engagement_score<80).length,low_engagement:o.filter(x=>x.engagement_score<50).length,total_interactions:o.reduce((x,F)=>x+F.total_interactions,0),avg_engagement_score:o.reduce((x,F)=>x+F.engagement_score,0)/o.length,active_principals:o.filter(x=>x.activity_status==="ACTIVE").length,principals_with_recent_activity:o.filter(x=>{if(!x.last_activity_date)return!1;const F=new Date(x.last_activity_date),T=new Date(Date.now()-30*24*60*60*1e3);return F>T}).length};t.analytics={...t.analytics,engagement_breakdown:w,total_principals:o.length,last_updated:new Date().toISOString()},t.realTimeMetrics.last_updated=new Date}catch(o){M.value=o instanceof Error?o.message:"Failed to load engagement breakdown",console.error("Engagement breakdown calculation error:",o)}finally{t.calculatingAnalytics=!1}},gt=async a=>{t.calculatingAnalytics=!0,M.value=null;try{const o=a?t.principals.filter(i=>i.principal_id===a):t.principals;if(o.length===0){M.value="No principal data available for statistics";return}const w=new Date,x=new Date(w.getTime()-30*24*60*60*1e3),F=new Date(w.getTime()-90*24*60*60*1e3),T={total_principals:o.length,active_principals:o.filter(i=>i.activity_status==="ACTIVE").length,inactive_principals:o.filter(i=>i.activity_status==="INACTIVE").length,high_value_principals:o.filter(i=>i.engagement_score>=80).length,avg_engagement_score:Math.round(o.reduce((i,_)=>i+_.engagement_score,0)/o.length*100)/100,total_interactions:o.reduce((i,_)=>i+_.total_interactions,0),interactions_last_30_days:o.reduce((i,_)=>i+_.interactions_last_30_days,0),interactions_last_90_days:o.reduce((i,_)=>i+_.interactions_last_90_days,0),total_opportunities:o.reduce((i,_)=>i+_.total_opportunities,0),active_opportunities:o.reduce((i,_)=>i+_.active_opportunities,0),won_opportunities:o.reduce((i,_)=>i+_.won_opportunities,0),opportunities_last_30_days:o.reduce((i,_)=>i+_.opportunities_last_30_days,0),avg_probability_percent:Math.round(o.reduce((i,_)=>i+(_.avg_probability_percent||0),0)/o.length*100)/100,total_contacts:o.reduce((i,_)=>i+_.contact_count,0),active_contacts:o.reduce((i,_)=>i+_.active_contacts,0),follow_ups_required:o.reduce((i,_)=>i+_.follow_ups_required,0),principals_by_type:o.reduce((i,_)=>{const Q=_.organization_type||"Unknown";return i[Q]=(i[Q]||0)+1,i},{}),principals_by_industry:o.reduce((i,_)=>{const Q=_.industry||"Unknown";return i[Q]=(i[Q]||0)+1,i},{}),top_performing_principals:o.sort((i,_)=>_.engagement_score-i.engagement_score).slice(0,5).map(i=>({principal_id:i.principal_id,principal_name:i.principal_name,engagement_score:i.engagement_score,total_opportunities:i.total_opportunities,total_interactions:i.total_interactions})),recent_activity_trend:{last_30_days:o.filter(i=>i.last_activity_date?new Date(i.last_activity_date)>x:!1).length,last_90_days:o.filter(i=>i.last_activity_date?new Date(i.last_activity_date)>F:!1).length}};t.metricsSummary={total_principals:T.total_principals,active_this_month:T.recent_activity_trend.last_30_days,top_engagement_score:Math.max(...o.map(i=>i.engagement_score)),opportunities_created_this_month:T.opportunities_last_30_days,interactions_this_week:Math.floor(T.interactions_last_30_days/4),pending_follow_ups:T.follow_ups_required},t.analytics={...t.analytics,principal_stats:T,total_principals:T.total_principals,active_principals:T.active_principals,avg_engagement_score:T.avg_engagement_score,total_interactions:T.total_interactions,total_opportunities:T.total_opportunities,last_updated:new Date().toISOString()},t.realTimeMetrics.last_updated=new Date}catch(o){M.value=o instanceof Error?o.message:"Failed to load principal statistics",console.error("Principal statistics calculation error:",o)}finally{t.calculatingAnalytics=!1}},Ee=()=>{H||(t.realTimeMetrics.auto_refresh=!0,console.log("DEBUG: Starting real-time timer with frequency:",t.realTimeMetrics.update_frequency),H=setInterval(()=>{console.log("DEBUG: Timer callback executed, checking conditions:",{auto_refresh:t.realTimeMetrics.auto_refresh,isLoading:X.value}),t.realTimeMetrics.auto_refresh&&!X.value?(console.log("DEBUG: Calling calculateAnalytics from timer"),ce(!0).catch(a=>{console.error("Real-time analytics update failed:",a)})):console.log("Real-time update skipped:",{auto_refresh:t.realTimeMetrics.auto_refresh,isLoading:X.value})},t.realTimeMetrics.update_frequency),console.log("DEBUG: Timer created with ID:",H))},Ie=()=>{H&&(clearInterval(H),H=null),t.realTimeMetrics.auto_refresh=!1},ft=(a,o)=>{t.realTimeMetrics.auto_refresh=a,o&&(t.realTimeMetrics.update_frequency=o),a?Ee():Ie()};Ne(u,a=>{t.dataStale=a},{immediate:!0}),t.realTimeMetrics.auto_refresh&&Ee();const Le=()=>{Ie()};return typeof window<"u"&&window.addEventListener("beforeunload",Le),{principals:V,selectedPrincipal:ie,distributorRelationships:t.distributorRelationships,productPerformance:t.productPerformance,timelineEntries:t.timelineEntries,dashboardData:re,principalOptions:n,loading:W,loadingDashboard:t.loadingDashboard,loadingTimeline:t.loadingTimeline,calculatingAnalytics:t.calculatingAnalytics,refreshing:t.refreshing,processingBatch:t.processingBatch,error:b,dashboardError:j,timelineError:y,analyticsError:f,searchQuery:v,activeFilters:d,sortConfig:t.sortConfig,pagination:se,analytics:le,metricsSummary:oe,realTimeMetrics:t.realTimeMetrics,selectedPrincipalIds:s,batchMode:m,maxSelections:C,lastFetched:q,cacheDuration:t.cacheDuration,dataStale:J,isLoading:X,hasError:Pe,allErrors:De,principalCount:Ce,activePrincipalCount:Me,hasActiveFilters:ge,selectionCount:fe,isMaxSelectionsReached:_e,getPrincipalById:he,getSelectedPrincipals:ve,principalsByActivityStatus:ye,principalsByOrganizationType:be,topPerformingPrincipals:Te,principalsRequiringFollowUp:c,isDataStale:u,fetchPrincipals:L,fetchPrincipalDashboard:we,fetchPrincipalTimeline:xe,fetchDistributorRelationships:Fe,fetchProductPerformance:Oe,calculateAnalytics:ce,refreshMetrics:Qe,searchPrincipals:Ze,updateFilters:Ye,clearFilters:Ke,updateSort:We,goToPage:Se,nextPage:Je,previousPage:Xe,updatePageSize:et,toggleSelection:tt,selectPrincipals:je,clearSelections:$e,selectAll:at,isSelected:ot,setBatchMode:st,batchUpdatePrincipals:nt,exportSelectedPrincipals:it,refreshAll:rt,clearErrors:lt,selectPrincipal:ct,clearSelectedPrincipal:dt,loadActivitySummaries:ut,getPrincipalOptions:pt,loadEngagementBreakdown:mt,loadPrincipalStats:gt,startRealTimeUpdates:Ee,stopRealTimeUpdates:Ie,configureRealTimeUpdates:ft,cleanup:Le}}),qt={class:"principal-opportunity-list"},Gt={key:0,class:"animate-pulse space-y-4"},Qt={key:1,class:"text-center py-8"},Zt={class:"text-sm text-gray-500"},Yt={key:2,class:"space-y-3"},Kt=["onClick","onKeypress"],Wt={class:"flex items-start justify-between mb-3"},Jt={class:"flex-1 min-w-0"},Xt={class:"text-sm font-medium text-gray-900 truncate"},ea={class:"flex items-center mt-1 space-x-3 text-xs text-gray-500"},ta={key:0,class:"flex items-center"},aa={key:1,class:"flex items-center"},oa={class:"flex items-center justify-between"},sa={class:"flex items-center space-x-4 text-sm text-gray-600"},na={key:0,class:"flex items-center"},ia={class:"text-xs"},ra={key:1,class:"text-xs text-gray-500 truncate max-w-32"},la={class:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity"},ca=["onClick","aria-label"],da=["onClick","aria-label"],ua={key:0,class:"mt-3 pt-3 border-t border-gray-100"},pa={class:"text-xs text-gray-600 line-clamp-2"},ma={key:0,class:"text-center pt-4"},ga=["disabled"],fa={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_a=pe({__name:"PrincipalOpportunityList",props:{principalId:{},principalName:{},loading:{type:Boolean,default:!1},loadingMore:{type:Boolean,default:!1},hasMore:{type:Boolean,default:!1},limit:{default:10},customOpportunities:{default:void 0}},emits:["opportunityClick","edit","delete","load-more"],setup(I,{emit:O}){const l=I,r=O,$=He(),S=h(()=>l.customOpportunities?l.customOpportunities.slice(0,l.limit):[{id:"1",name:`${l.principalName} - Q4 Initiative`,stage:"INITIAL_OUTREACH",probability_percent:25,expected_close_date:"2024-12-31",organization_name:"Sample Organization",organization_type:"DISTRIBUTOR",product_name:"Product A",deal_owner:"John Doe",is_won:!1,principal_name:l.principalName||"Unknown Principal",notes:"Initial outreach completed, waiting for response from decision maker.",product_category:"CHEMICALS",days_since_created:15,days_to_close:45,stage_duration_days:5,created_at:"2024-11-01T10:00:00Z",updated_at:"2024-11-15T14:30:00Z",deleted_at:null,organization_id:"org-1",principal_id:l.principalId},{id:"2",name:`${l.principalName} - Expansion Project`,stage:"SAMPLE_VISIT_OFFERED",probability_percent:60,expected_close_date:"2024-11-30",organization_name:"Another Organization",organization_type:"RETAILER",product_name:"Product B",deal_owner:"Jane Smith",is_won:!1,principal_name:l.principalName||"Unknown Principal",notes:"Sample visit scheduled for next week. High interest level.",product_category:"EQUIPMENT",days_since_created:32,days_to_close:15,stage_duration_days:12,created_at:"2024-10-15T09:00:00Z",updated_at:"2024-11-10T16:45:00Z",deleted_at:null,organization_id:"org-2",principal_id:l.principalId}].filter(()=>l.principalId)),M=m=>{r("opportunityClick",m),$.push(`/opportunities/${m.id}`)},A=m=>{r("edit",m),$.push(`/opportunities/${m.id}/edit`)},B=m=>{confirm(`Are you sure you want to delete "${m.name}"? This action cannot be undone.`)&&r("delete",m)},s=m=>{const C=new Date(m);return C.toLocaleDateString("en-US",{month:"short",day:"numeric",year:C.getFullYear()!==new Date().getFullYear()?"numeric":void 0})};return(m,C)=>(p(),g("div",qt,[m.loading?(p(),g("div",Gt,[(p(),g(te,null,ae(3,b=>e("div",{key:b,class:"bg-gray-200 h-16 rounded-lg"})),64))])):S.value.length===0?(p(),g("div",Qt,[C[1]||(C[1]=e("div",{class:"mx-auto h-12 w-12 text-gray-400 mb-4"},[e("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),C[2]||(C[2]=e("h3",{class:"text-sm font-medium text-gray-900 mb-1"},"No opportunities found",-1)),e("p",Zt,D(m.principalName?`No opportunities for ${m.principalName}`:"No opportunities to display"),1)])):(p(),g("div",Yt,[(p(!0),g(te,null,ae(S.value,b=>(p(),g("div",{key:b.id,class:"opportunity-card bg-white border border-gray-200 rounded-lg p-4 hover:border-gray-300 hover:shadow-sm transition-all cursor-pointer",onClick:j=>M(b),role:"button",tabindex:"0",onKeypress:[ke(j=>M(b),["enter"]),ke(ne(j=>M(b),["prevent"]),["space"])]},[e("div",Wt,[e("div",Jt,[e("h4",Xt,D(b.name),1),e("div",ea,[b.organization_name?(p(),g("span",ta,[C[3]||(C[3]=e("svg",{class:"h-3 w-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-4m-5 0H3m2 0h3M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})],-1)),R(" "+D(b.organization_name),1)])):U("",!0),b.expected_close_date?(p(),g("span",aa,[C[4]||(C[4]=e("svg",{class:"h-3 w-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),R(" "+D(s(b.expected_close_date)),1)])):U("",!0)])]),P(Ot,{stage:b.stage,size:"sm",class:"ml-2 flex-shrink-0"},null,8,["stage"])]),e("div",oa,[e("div",sa,[b.probability_percent!==null?(p(),g("div",na,[P(jt,{probability:b.probability_percent||0,size:"sm",class:"mr-2"},null,8,["probability"]),e("span",ia,D(b.probability_percent)+"%",1)])):U("",!0),b.product_name?(p(),g("span",ra,D(b.product_name),1)):U("",!0)]),e("div",la,[e("button",{onClick:ne(j=>A(b),["stop"]),class:"p-1 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100","aria-label":`Edit ${b.name}`},C[5]||(C[5]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,ca),e("button",{onClick:ne(j=>B(b),["stop"]),class:"p-1 text-gray-400 hover:text-red-600 rounded-md hover:bg-red-50","aria-label":`Delete ${b.name}`},C[6]||(C[6]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,da)])]),b.notes?(p(),g("div",ua,[e("p",pa,D(b.notes),1)])):U("",!0)],40,Kt))),128)),m.hasMore?(p(),g("div",ma,[e("button",{onClick:C[0]||(C[0]=b=>m.$emit("load-more")),disabled:m.loadingMore,class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[m.loadingMore?(p(),g("svg",fa,C[7]||(C[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))):U("",!0),R(" "+D(m.loadingMore?"Loading...":"Load More"),1)],8,ga)])):U("",!0)]))]))}}),ha=me(_a,[["__scopeId","data-v-6d074277"]]),va={class:"principal-interaction-list"},ya={key:0,class:"animate-pulse space-y-4"},ba={key:1,class:"text-center py-8"},wa={class:"text-sm text-gray-500"},xa={key:2,class:"flow-root"},ka={class:"-mb-8",role:"list"},Pa={key:0,class:"absolute left-4 top-8 -ml-px h-full w-0.5 bg-gray-200","aria-hidden":"true"},Da={class:"relative flex items-start space-x-3 group"},Ca={class:"flex-1 min-w-0"},Ma=["onClick","onKeypress"],Ta={class:"flex items-start justify-between mb-2"},Sa={class:"flex-1 min-w-0"},$a={class:"text-sm font-medium text-gray-900"},Ea={class:"flex items-center mt-1 space-x-3 text-xs text-gray-500"},Ia={class:"flex items-center"},Ua={key:0,class:"flex items-center"},Aa={key:0,class:"flex items-center ml-2 flex-shrink-0"},Ba={class:"flex items-center space-x-1"},Fa={class:"text-xs text-gray-600 ml-1"},Oa={key:0,class:"mb-3"},ja={class:"text-sm text-gray-700 line-clamp-2"},La={class:"flex items-center justify-between"},za={class:"flex items-center space-x-2"},Va={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},Ra={class:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity"},Na=["onClick"],Ha={key:0,class:"text-center pt-6"},qa=["disabled"],Ga={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Qa=pe({__name:"PrincipalInteractionList",props:{principalId:{},principalName:{},loading:{type:Boolean,default:!1},loadingMore:{type:Boolean,default:!1},hasMore:{type:Boolean,default:!1},limit:{default:10},customInteractions:{default:void 0}},emits:["interactionClick","edit","load-more"],setup(I,{emit:O}){const l=I,r=O,$=He(),S=h(()=>l.customInteractions?l.customInteractions.slice(0,l.limit):[{id:"1",type:"Phone",interaction_type:"Phone",subject:`Follow-up call with ${l.principalName}`,summary:"Discussed upcoming project requirements and timeline. Very positive response, showing strong interest in our solution.",interaction_date:"2024-11-15T14:30:00Z",sample_rating:4,rating:4,follow_up_date:"2024-11-20",follow_up_required:!0,organization_name:"Sample Organization",organization_id:"org-1",principal_id:l.principalId,opportunity_id:"opp-1",status:"COMPLETED",outcome:"POSITIVE",duration_minutes:30,location:null,notes:"Discussed upcoming project requirements and timeline. Very positive response, showing strong interest in our solution.",contact_method:"Phone",participants:null,attachments:null,tags:null,custom_fields:null,next_action:"Follow up next week",follow_up_notes:"Schedule product demo",created_by:null,created_at:"2024-11-15T14:35:00Z",updated_at:"2024-11-15T14:35:00Z",deleted_at:null,days_since_interaction:7,days_until_followup:2},{id:"2",type:"Email",interaction_type:"Email",subject:"Product information request",summary:"Sent detailed product specifications and pricing information as requested.",interaction_date:"2024-11-10T09:15:00Z",sample_rating:null,rating:null,follow_up_date:null,follow_up_required:!1,organization_name:"Another Organization",organization_id:"org-2",principal_id:l.principalId,opportunity_id:"opp-2",status:"COMPLETED",outcome:"NEUTRAL",duration_minutes:null,location:null,notes:"Sent detailed product specifications and pricing information as requested.",contact_method:"Email",participants:null,attachments:null,tags:null,custom_fields:null,next_action:null,follow_up_notes:null,created_by:null,created_at:"2024-11-10T09:20:00Z",updated_at:"2024-11-10T09:20:00Z",deleted_at:null,days_since_interaction:12,days_until_followup:null},{id:"3",type:"Meeting",interaction_type:"Meeting",subject:"Quarterly business review",summary:"Comprehensive review of product performance and relationship status. Identified new opportunities for expansion.",interaction_date:"2024-11-05T11:00:00Z",sample_rating:5,rating:5,follow_up_date:null,follow_up_required:!1,organization_name:"Sample Organization",organization_id:"org-1",principal_id:l.principalId,opportunity_id:"opp-3",status:"COMPLETED",outcome:"POSITIVE",duration_minutes:90,location:"Client Office",notes:"Comprehensive review of product performance and relationship status. Identified new opportunities for expansion.",contact_method:"In Person",participants:null,attachments:null,tags:null,custom_fields:null,next_action:null,follow_up_notes:null,created_by:null,created_at:"2024-11-05T11:30:00Z",updated_at:"2024-11-05T11:30:00Z",deleted_at:null,days_since_interaction:17,days_until_followup:null}].filter(()=>l.principalId)),M=y=>{r("interactionClick",y),$.push(`/interactions/${y.id}`)},A=y=>{r("edit",y),$.push(`/interactions/${y.id}/edit`)},B=y=>({Phone:"Phone Call",Email:"Email",Meeting:"Meeting",Demo:"Demo",Event:"Event",Other:"Other",Proposal:"Proposal",Contract:"Contract",Note:"Note",Task:"Task",Social:"Social",Website:"Website"})[y]||y,s=y=>{const f={Phone:()=>E("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})]),Email:()=>E("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})]),Meeting:()=>E("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})]),Demo:()=>E("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]),Event:()=>E("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),Proposal:()=>E("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),Contract:()=>E("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),Note:()=>E("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]),Task:()=>E("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})]),Social:()=>E("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})]),Website:()=>E("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})]),Other:()=>E("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[E("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})])};return f[y]||f.Other},m=y=>{const f={Phone:"bg-blue-500 text-white",Email:"bg-green-500 text-white",Meeting:"bg-purple-500 text-white",Demo:"bg-orange-500 text-white",Event:"bg-indigo-500 text-white",Proposal:"bg-yellow-500 text-white",Contract:"bg-red-500 text-white",Note:"bg-teal-500 text-white",Task:"bg-pink-500 text-white",Social:"bg-cyan-500 text-white",Website:"bg-emerald-500 text-white",Other:"bg-gray-500 text-white"};return f[y]||f.Other},C=y=>{const f={Phone:"bg-blue-100 text-blue-800",Email:"bg-green-100 text-green-800",Meeting:"bg-purple-100 text-purple-800",Demo:"bg-orange-100 text-orange-800",Event:"bg-indigo-100 text-indigo-800",Proposal:"bg-yellow-100 text-yellow-800",Contract:"bg-red-100 text-red-800",Note:"bg-teal-100 text-teal-800",Task:"bg-pink-100 text-pink-800",Social:"bg-cyan-100 text-cyan-800",Website:"bg-emerald-100 text-emerald-800",Other:"bg-gray-100 text-gray-800"};return f[y]||f.Other},b=y=>{const f=new Date(y);return f.toLocaleDateString("en-US",{month:"short",day:"numeric",year:f.getFullYear()!==new Date().getFullYear()?"numeric":void 0})},j=y=>{const f=new Date(y);return f.toLocaleDateString("en-US",{month:"short",day:"numeric",year:f.getFullYear()!==new Date().getFullYear()?"numeric":void 0,hour:"numeric",minute:"2-digit"})};return(y,f)=>(p(),g("div",va,[y.loading?(p(),g("div",ya,[(p(),g(te,null,ae(3,v=>e("div",{key:v,class:"flex items-start space-x-3"},f[1]||(f[1]=[e("div",{class:"w-8 h-8 bg-gray-200 rounded-full flex-shrink-0"},null,-1),e("div",{class:"flex-1 space-y-2"},[e("div",{class:"h-4 bg-gray-200 rounded w-3/4"}),e("div",{class:"h-3 bg-gray-200 rounded w-1/2"})],-1)]))),64))])):S.value.length===0?(p(),g("div",ba,[f[2]||(f[2]=e("div",{class:"mx-auto h-12 w-12 text-gray-400 mb-4"},[e("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})])],-1)),f[3]||(f[3]=e("h3",{class:"text-sm font-medium text-gray-900 mb-1"},"No interactions found",-1)),e("p",wa,D(y.principalName?`No interactions recorded for ${y.principalName}`:"No interactions to display"),1)])):(p(),g("div",xa,[e("ul",ka,[(p(!0),g(te,null,ae(S.value,(v,q)=>(p(),g("li",{key:v.id,class:"relative"},[q!==S.value.length-1?(p(),g("div",Pa)):U("",!0),e("div",Da,[e("div",{class:K(["relative flex h-8 w-8 items-center justify-center rounded-full ring-8 ring-white",m(v.interaction_type||v.type||"Other")])},[(p(),ht(vt(s(v.interaction_type||v.type||"Other")),{class:"h-4 w-4","aria-hidden":"true"}))],2),e("div",Ca,[e("div",{class:"interaction-card bg-white border border-gray-200 rounded-lg p-4 hover:border-gray-300 hover:shadow-sm transition-all cursor-pointer",onClick:V=>M(v),role:"button",tabindex:"0",onKeypress:[ke(V=>M(v),["enter"]),ke(ne(V=>M(v),["prevent"]),["space"])]},[e("div",Ta,[e("div",Sa,[e("h4",$a,D(v.subject||B(v.interaction_type||v.type||"Other")),1),e("div",Ea,[e("span",Ia,[f[4]||(f[4]=e("svg",{class:"h-3 w-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),R(" "+D(j(v.interaction_date)),1)]),v.organization_name?(p(),g("span",Ua,[f[5]||(f[5]=e("svg",{class:"h-3 w-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-4m-5 0H3m2 0h3M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})],-1)),R(" "+D(v.organization_name),1)])):U("",!0)])]),v.sample_rating?(p(),g("div",Aa,[e("div",Ba,[(p(),g(te,null,ae(5,V=>e("svg",{key:V,class:K(["h-3 w-3",V<=v.sample_rating?"text-yellow-400 fill-current":"text-gray-300"]),viewBox:"0 0 20 20"},f[6]||(f[6]=[e("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"},null,-1)]),2)),64)),e("span",Fa,D(v.sample_rating)+"/5",1)])])):U("",!0)]),v.summary?(p(),g("div",Oa,[e("p",ja,D(v.summary),1)])):U("",!0),e("div",La,[e("div",za,[e("span",{class:K(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",C(v.interaction_type||v.type||"Other")])},D(B(v.interaction_type||v.type||"Other")),3),v.follow_up_date?(p(),g("span",Va,[f[7]||(f[7]=e("svg",{class:"h-3 w-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),R(" Follow-up "+D(b(v.follow_up_date)),1)])):U("",!0)]),e("div",Ra,[e("button",{onClick:ne(V=>A(v),["stop"]),class:"p-1 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100","aria-label":"Edit interaction"},f[8]||(f[8]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,Na)])])],40,Ma)])])]))),128))]),y.hasMore?(p(),g("div",Ha,[e("button",{onClick:f[0]||(f[0]=v=>y.$emit("load-more")),disabled:y.loadingMore,class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[y.loadingMore?(p(),g("svg",Ga,f[9]||(f[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))):U("",!0),R(" "+D(y.loadingMore?"Loading...":"Load More"),1)],8,qa)])):U("",!0)]))]))}}),Za=me(Qa,[["__scopeId","data-v-66bdae05"]]),Ya={class:"log-principal-interaction-button"},Ka=["disabled"],Wa={class:"fixed inset-0 z-10 w-screen overflow-y-auto"},Ja={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},Xa={class:"flex items-center justify-between mb-4"},eo={class:"mt-1 text-sm text-gray-600"},to={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md"},ao={class:"flex"},oo={class:"ml-3"},so={class:"text-sm text-red-700"},no={class:"space-y-6"},io={class:"bg-gray-50 p-4 rounded-lg"},ro={class:"flex items-center justify-between"},lo={class:"flex items-center space-x-3"},co={class:"flex-shrink-0"},uo={class:"text-sm font-medium text-gray-900"},po={class:"text-sm text-gray-600"},mo={class:"text-right"},go={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},fo={key:0,class:"mt-1 text-sm text-red-600"},_o=["max"],ho={key:0,class:"mt-1 text-sm text-red-600"},vo={key:0,class:"mt-1 text-sm text-red-600"},yo={key:0,class:"mt-1 text-sm text-red-600"},bo={class:"flex items-center space-x-2"},wo=["onClick"],xo={class:"ml-2 text-sm text-gray-600"},ko={class:"space-y-2 max-h-32 overflow-y-auto"},Po=["value"],Do={class:"ml-2 text-sm text-gray-700"},Co={class:"flex items-center"},Mo={key:0,class:"pl-6 space-y-4 border-l-2 border-blue-200"},To={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},So=["min"],$o={class:"mt-6 flex items-center justify-end space-x-3"},Eo=["disabled"],Io={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 border-2 border-white rounded-full border-t-transparent"},Uo=pe({__name:"LogPrincipalInteractionButton",props:{principal:{default:null}},emits:["logged"],setup(I,{emit:O}){const l=I,r=O,$=Lt(),S=zt(),M=k(!1),A=k(!1),B=k(null),s=Ae({type:"",dateTime:"",subject:"",notes:"",rating:0,productIds:[],outcome:"",scheduleFollowUp:!1,followUpType:"Phone",followUpDate:"",followUpNotes:""}),m=Ae({type:"",dateTime:"",subject:"",notes:""}),C=h(()=>$.products.filter(d=>d.is_active)),b=h(()=>s.type!==""&&s.dateTime!==""&&s.subject.trim()!==""&&s.notes.trim()!==""),j=()=>{l.principal&&(v(),oe(),M.value=!0)},y=()=>{M.value=!1,v(),B.value=null},f=async()=>{if(!(!b.value||!l.principal)&&(q(),!!V())){A.value=!0,B.value=null;try{const d={type:s.type,interaction_date:new Date(s.dateTime).toISOString(),subject:s.subject,notes:s.notes,rating:s.rating||null,outcome:s.outcome||null,organization_id:l.principal.principal_id,principal_id:l.principal.principal_id,opportunity_id:null,product_ids:s.productIds.length>0?s.productIds:null,follow_up_required:s.scheduleFollowUp,follow_up_type:s.scheduleFollowUp?s.followUpType:null,follow_up_date:s.scheduleFollowUp&&s.followUpDate?new Date(s.followUpDate).toISOString():null,follow_up_notes:s.scheduleFollowUp?s.followUpNotes:null},n=await S.createInteraction(d);n?(r("logged",n),y(),console.log("Interaction logged successfully:",n)):B.value="Failed to log interaction. Please try again."}catch(d){B.value=d instanceof Error?d.message:"An unexpected error occurred"}finally{A.value=!1}}},v=()=>{s.type="",s.dateTime="",s.subject="",s.notes="",s.rating=0,s.productIds=[],s.outcome="",s.scheduleFollowUp=!1,s.followUpType="Phone",s.followUpDate="",s.followUpNotes="",q()},q=()=>{m.type="",m.dateTime="",m.subject="",m.notes=""},V=()=>{let d=!0;return s.type||(m.type="Interaction type is required",d=!1),s.dateTime||(m.dateTime="Date and time are required",d=!1),s.subject.trim()||(m.subject="Subject is required",d=!1),s.notes.trim()||(m.notes="Detailed notes are required",d=!1),d},oe=()=>{const d=new Date;d.setMinutes(d.getMinutes()-d.getTimezoneOffset()),s.dateTime=d.toISOString().slice(0,16)},ie=()=>{const d=new Date;return d.setMinutes(d.getMinutes()-d.getTimezoneOffset()),d.toISOString().slice(0,16)},re=()=>{const d=new Date;return d.setDate(d.getDate()+1),d.toISOString().split("T")[0]},le=d=>({0:"No rating",1:"Poor",2:"Fair",3:"Good",4:"Very Good",5:"Excellent"})[d]||"No rating";return Be(async()=>{$.products.length===0&&await $.fetchProducts()}),(d,n)=>(p(),g("div",Ya,[e("button",{onClick:j,disabled:!d.principal||A.value,class:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"},[P(z(Dt),{class:"h-4 w-4 mr-1"}),R(" "+D(A.value?"Logging...":"Log Interaction"),1)],8,Ka),P(z(Ct),{as:"template",show:M.value},{default:Y(()=>[P(z(Mt),{as:"div",class:"relative z-50",onClose:y},{default:Y(()=>[P(z(Re),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:Y(()=>n[10]||(n[10]=[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)])),_:1,__:[10]}),e("div",Wa,[e("div",Ja,[P(z(Re),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:Y(()=>[P(z(Tt),{class:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl sm:p-6"},{default:Y(()=>{var W,J,N,se;return[e("div",Xa,[e("div",null,[P(z(St),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900"},{default:Y(()=>n[11]||(n[11]=[R(" Log Interaction ",-1)])),_:1,__:[11]}),e("p",eo," Record an interaction with "+D((W=d.principal)==null?void 0:W.principal_name),1)]),e("button",{onClick:y,class:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500"},[P(z(Vt),{class:"h-6 w-6"})])]),B.value?(p(),g("div",to,[e("div",ao,[P(z(qe),{class:"h-5 w-5 text-red-400"}),e("div",oo,[e("p",so,D(B.value),1)])])])):U("",!0),e("form",{onSubmit:ne(f,["prevent"])},[e("div",no,[e("div",io,[e("div",ro,[e("div",lo,[e("div",co,[P(z(Ht),{class:"h-10 w-10 text-gray-400"})]),e("div",null,[e("h4",uo,D((J=d.principal)==null?void 0:J.principal_name),1),e("p",po,D(((N=d.principal)==null?void 0:N.organization_type)||"Organization"),1)])]),e("div",mo,[P(wt,{score:((se=d.principal)==null?void 0:se.engagement_score)||0,size:"sm"},null,8,["score"]),n[12]||(n[12]=e("p",{class:"text-xs text-gray-500 mt-1"}," Current Score ",-1))])])]),e("div",go,[e("div",null,[n[14]||(n[14]=e("label",{for:"interaction-type",class:"block text-sm font-medium text-gray-700"}," Interaction Type * ",-1)),G(e("select",{id:"interaction-type","onUpdate:modelValue":n[0]||(n[0]=t=>s.type=t),required:"",class:K(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",{"border-red-300":m.type}])},n[13]||(n[13]=[e("option",{value:""},"Select type...",-1),e("option",{value:"Phone"},"Phone Call",-1),e("option",{value:"Email"},"Email",-1),e("option",{value:"Meeting"},"In-Person Meeting",-1),e("option",{value:"Demo"},"Product Demo",-1),e("option",{value:"Event"},"Sample Visit",-1),e("option",{value:"Other"},"Follow-up",-1)]),2),[[Ue,s.type]]),m.type?(p(),g("p",fo,D(m.type),1)):U("",!0)]),e("div",null,[n[15]||(n[15]=e("label",{for:"interaction-date",class:"block text-sm font-medium text-gray-700"}," Date & Time * ",-1)),G(e("input",{id:"interaction-date","onUpdate:modelValue":n[1]||(n[1]=t=>s.dateTime=t),type:"datetime-local",required:"",max:ie(),class:K(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",{"border-red-300":m.dateTime}])},null,10,_o),[[ue,s.dateTime]]),m.dateTime?(p(),g("p",ho,D(m.dateTime),1)):U("",!0)])]),e("div",null,[n[16]||(n[16]=e("label",{for:"subject",class:"block text-sm font-medium text-gray-700"}," Subject * ",-1)),G(e("input",{id:"subject","onUpdate:modelValue":n[2]||(n[2]=t=>s.subject=t),type:"text",required:"",class:K(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",{"border-red-300":m.subject}]),placeholder:"Brief description of the interaction..."},null,2),[[ue,s.subject]]),m.subject?(p(),g("p",vo,D(m.subject),1)):U("",!0)]),e("div",null,[n[17]||(n[17]=e("label",{for:"notes",class:"block text-sm font-medium text-gray-700"}," Detailed Notes * ",-1)),G(e("textarea",{id:"notes","onUpdate:modelValue":n[3]||(n[3]=t=>s.notes=t),rows:"4",required:"",class:K(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",{"border-red-300":m.notes}]),placeholder:"Detailed description of what was discussed, outcomes, next steps..."},null,2),[[ue,s.notes]]),m.notes?(p(),g("p",yo,D(m.notes),1)):U("",!0)]),e("div",null,[n[18]||(n[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Interaction Rating ",-1)),e("div",bo,[(p(),g(te,null,ae(5,t=>e("button",{key:t,type:"button",onClick:H=>s.rating=t,class:"focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-full p-1"},[P(z(Rt),{class:K(["h-6 w-6 transition-colors duration-150",[t<=s.rating?"text-yellow-400 fill-current":"text-gray-300 hover:text-yellow-200"]])},null,8,["class"])],8,wo)),64)),e("span",xo,D(le(s.rating)),1)])]),e("div",null,[n[19]||(n[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Products Discussed ",-1)),e("div",ko,[(p(!0),g(te,null,ae(C.value,t=>(p(),g("label",{key:t.id,class:"flex items-center p-2 rounded-md hover:bg-gray-50 cursor-pointer"},[G(e("input",{"onUpdate:modelValue":n[4]||(n[4]=H=>s.productIds=H),type:"checkbox",value:t.id,class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,8,Po),[[ze,s.productIds]]),e("span",Do,D(t.name),1)]))),128))])]),e("div",null,[n[21]||(n[21]=e("label",{for:"outcome",class:"block text-sm font-medium text-gray-700"}," Outcome ",-1)),G(e("select",{id:"outcome","onUpdate:modelValue":n[5]||(n[5]=t=>s.outcome=t),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},n[20]||(n[20]=[e("option",{value:""},"Select outcome...",-1),e("option",{value:"POSITIVE"},"Positive - Strong Interest",-1),e("option",{value:"NEUTRAL"},"Neutral - Information Gathering",-1),e("option",{value:"NEGATIVE"},"Negative - Not Interested",-1),e("option",{value:"FOLLOW_UP_REQUIRED"},"Follow-up Required",-1),e("option",{value:"SAMPLE_REQUESTED"},"Sample Requested",-1),e("option",{value:"QUOTE_REQUESTED"},"Quote Requested",-1)]),512),[[Ue,s.outcome]])]),e("div",Co,[G(e("input",{id:"schedule-follow-up","onUpdate:modelValue":n[6]||(n[6]=t=>s.scheduleFollowUp=t),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[ze,s.scheduleFollowUp]]),n[22]||(n[22]=e("label",{for:"schedule-follow-up",class:"ml-2 block text-sm text-gray-700"}," Schedule follow-up activity ",-1))]),s.scheduleFollowUp?(p(),g("div",Mo,[e("div",To,[e("div",null,[n[24]||(n[24]=e("label",{for:"follow-up-type",class:"block text-sm font-medium text-gray-700"}," Follow-up Type ",-1)),G(e("select",{id:"follow-up-type","onUpdate:modelValue":n[7]||(n[7]=t=>s.followUpType=t),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},n[23]||(n[23]=[e("option",{value:"Phone"},"Phone Call",-1),e("option",{value:"Email"},"Email",-1),e("option",{value:"Meeting"},"In-Person Meeting",-1),e("option",{value:"Event"},"Sample Delivery",-1)]),512),[[Ue,s.followUpType]])]),e("div",null,[n[25]||(n[25]=e("label",{for:"follow-up-date",class:"block text-sm font-medium text-gray-700"}," Follow-up Date ",-1)),G(e("input",{id:"follow-up-date","onUpdate:modelValue":n[8]||(n[8]=t=>s.followUpDate=t),type:"date",min:re(),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},null,8,So),[[ue,s.followUpDate]])])]),e("div",null,[n[26]||(n[26]=e("label",{for:"follow-up-notes",class:"block text-sm font-medium text-gray-700"}," Follow-up Notes ",-1)),G(e("textarea",{id:"follow-up-notes","onUpdate:modelValue":n[9]||(n[9]=t=>s.followUpNotes=t),rows:"2",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"What should be discussed in the follow-up..."},null,512),[[ue,s.followUpNotes]])])])):U("",!0)]),e("div",$o,[e("button",{type:"button",onClick:y,class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Cancel "),e("button",{type:"submit",disabled:A.value||!b.value,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[A.value?(p(),g("div",Io)):U("",!0),R(" "+D(A.value?"Logging...":"Log Interaction"),1)],8,Eo)])],32)]}),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])]))}}),Ao=me(Uo,[["__scopeId","data-v-a3ed6d65"]]),Bo={class:"principal-dashboard bg-gray-50 min-h-screen",role:"main","aria-label":"Principal Activity Dashboard"},Fo={class:"bg-white shadow-sm border-b border-gray-200"},Oo={class:"px-4 sm:px-6 lg:px-8"},jo={class:"py-6"},Lo={class:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between sm:space-y-0"},zo={class:"mt-6"},Vo={key:0,class:"flex items-center justify-center py-12"},Ro={key:1,class:"px-4 sm:px-6 lg:px-8 py-8"},No={class:"bg-red-50 border border-red-200 rounded-md p-4"},Ho={class:"flex"},qo={class:"ml-3"},Go={class:"mt-1 text-sm text-red-700"},Qo={key:2,class:"px-4 sm:px-6 lg:px-8 py-8"},Zo={class:"mb-8"},Yo={key:0,class:"space-y-8"},Ko={class:"bg-white rounded-lg shadow-sm border border-gray-200"},Wo={class:"px-6 py-4 border-b border-gray-200"},Jo={class:"text-sm text-gray-600 mt-1"},Xo={class:"p-6"},es={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},ts={class:"bg-white rounded-lg shadow-sm border border-gray-200 h-full"},as={class:"p-6"},os={class:"bg-white rounded-lg shadow-sm border border-gray-200 h-full"},ss={class:"px-6 py-4 border-b border-gray-200 flex items-center justify-between"},ns={class:"p-6"},is={class:"grid grid-cols-1 xl:grid-cols-2 gap-8"},rs={class:"bg-white rounded-lg shadow-sm border border-gray-200"},ls={class:"px-6 py-4 border-b border-gray-200 flex items-center justify-between"},cs={class:"p-6"},ds={class:"bg-white rounded-lg shadow-sm border border-gray-200"},us={class:"p-6"},ps={class:"bg-white rounded-lg shadow-sm border border-gray-200"},ms={class:"px-6 py-4 border-b border-gray-200 flex items-center justify-between"},gs={class:"p-6"},fs={key:1,class:"text-center py-12"},_s=pe({__name:"PrincipalDashboard",setup(I){const O=xt(),l=Ge(),r=k(""),$=k(!1),S=k(null),M=k(!1),A=k(!1),B=k(!1),s=k(!1),m=k(!1),C=k(!1),b=k(!1),j=k(!1),y=k([]),f=k([]),v=k([]),q=k([]),V=k(null),oe=k(null),ie=k(null),re=h(()=>!!S.value||l.hasError),le=c=>({principal_id:c.id,principal_name:c.name,principal_status:null,organization_type:c.organization_type,industry:null,organization_size:null,is_active:c.is_active,lead_score:null,contact_count:c.contact_count,active_contacts:0,primary_contact_name:null,primary_contact_email:null,last_contact_update:null,total_interactions:0,interactions_last_30_days:0,interactions_last_90_days:0,last_interaction_date:null,last_interaction_type:null,next_follow_up_date:null,avg_interaction_rating:0,positive_interactions:0,follow_ups_required:0,total_opportunities:c.opportunity_count,active_opportunities:0,won_opportunities:0,opportunities_last_30_days:0,latest_opportunity_stage:null,latest_opportunity_date:null,avg_probability_percent:0,highest_value_opportunity:null,product_count:c.product_count,active_product_count:0,product_categories:null,primary_product_category:null,is_principal:!0,is_distributor:!1,last_activity_date:null,activity_status:"NO_ACTIVITY",engagement_score:0,principal_created_at:c.created_at,principal_updated_at:c.updated_at,summary_generated_at:new Date().toISOString()}),d=h(()=>{if(!r.value)return null;const c=O.getPrincipalById(r.value);return c?le(c):null}),n=async c=>{c?(r.value=c.principal_id,await fe(c.principal_id)):(r.value="",Te())},W=async()=>{r.value&&await fe(r.value),await ge()},J=c=>{const u=c||d.value;console.log("Create opportunity for principal:",u==null?void 0:u.principal_name)},N=()=>{var c;console.log("Log interaction for principal:",(c=d.value)==null?void 0:c.principal_name)},se=()=>{var c;console.log("Manage products for principal:",(c=d.value)==null?void 0:c.principal_name)},t=()=>{r.value&&ye(r.value)},H=c=>{},X=()=>{console.log("Export data")},Pe=c=>{console.log("Distributor selected:",c)},De=c=>{console.log("Contact distributor:",c)},Ce=()=>{r.value&&(_e(r.value),be(r.value))},Me=()=>{r.value&&he(r.value)},ge=async()=>{A.value=!0,S.value=null;try{await l.loadEngagementBreakdown(),await l.loadPrincipalStats(),await l.loadActivitySummaries(),l.analytics&&(V.value=l.analytics.engagement_breakdown||null,oe.value=l.analytics.principal_stats||null),y.value=l.principals}catch(c){S.value=c instanceof Error?c.message:"Failed to load dashboard data"}finally{A.value=!1}},fe=async c=>{$.value=!0,S.value=null;try{await Promise.all([_e(c),he(c),ve(c),ye(c),be(c)])}catch(u){S.value=u instanceof Error?u.message:"Failed to load principal data"}finally{$.value=!1}},_e=async c=>{s.value=!0;try{await l.fetchPrincipalTimeline([c]),f.value=l.timelineEntries}catch(u){console.error("Failed to load timeline data:",u)}finally{s.value=!1}},he=async c=>{C.value=!0;try{await l.fetchProductPerformance([c]),v.value=l.productPerformance}catch(u){console.error("Failed to load product data:",u)}finally{C.value=!1}},ve=async c=>{b.value=!0;try{await l.fetchDistributorRelationships(),q.value=l.distributorRelationships}catch(u){console.error("Failed to load distributor data:",u)}finally{b.value=!1}},ye=async c=>{m.value=!0;try{await new Promise(u=>setTimeout(u,500))}finally{m.value=!1}},be=async c=>{j.value=!0;try{await new Promise(u=>setTimeout(u,500))}finally{j.value=!1}},Te=()=>{f.value=[],v.value=[],q.value=[]};return Be(async()=>{await ge(),await O.fetchPrincipalOptions()}),Ne([()=>O.error,()=>l.error],([c,u])=>{c?S.value=c:u&&(S.value=u)}),(c,u)=>{var L,we;return p(),g("div",Bo,[e("div",Fo,[e("div",Oo,[e("div",jo,[e("div",Lo,[u[2]||(u[2]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Principal Activity Dashboard"),e("p",{class:"mt-1 text-sm text-gray-500"}," Comprehensive relationship insights and performance analytics ")],-1)),P($t,{"selected-principal":d.value,onRefresh:W,onCreateOpportunity:J,onLogInteraction:N,onManageProducts:se},null,8,["selected-principal"])]),e("div",zo,[P(kt,{modelValue:r.value,"onUpdate:modelValue":u[0]||(u[0]=xe=>r.value=xe),loading:M.value,error:ie.value,onChange:n},null,8,["modelValue","loading","error"])])])])]),$.value?(p(),g("div",Vo,u[3]||(u[3]=[e("div",{class:"flex items-center space-x-3"},[e("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e("span",{class:"text-gray-600"},"Loading principal analytics...")],-1)]))):re.value?(p(),g("div",Ro,[e("div",No,[e("div",Ho,[P(z(qe),{class:"h-5 w-5 text-red-400"}),e("div",qo,[u[4]||(u[4]=e("h3",{class:"text-sm font-medium text-red-800"},"Error Loading Data",-1)),e("p",Go,D(S.value),1),e("button",{onClick:W,class:"mt-2 bg-red-100 px-3 py-1 rounded text-sm text-red-800 hover:bg-red-200"}," Try Again ")])])])])):(p(),g("div",Qo,[e("section",Zo,[P(Pt,{"activity-summary":y.value,"engagement-breakdown":V.value,stats:oe.value,loading:A.value},null,8,["activity-summary","engagement-breakdown","stats","loading"])]),d.value?(p(),g("div",Yo,[e("section",null,[e("div",Ko,[e("div",Wo,[u[5]||(u[5]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Performance Analytics",-1)),e("p",Jo," Engagement trends and performance metrics for "+D(d.value.principal_name),1)]),e("div",Xo,[P(Et,{"principal-id":r.value,"activity-data":f.value,"product-performance":v.value,loading:B.value},null,8,["principal-id","activity-data","product-performance","loading"])])])]),e("div",es,[e("section",null,[e("div",ts,[u[6]||(u[6]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Activity Timeline"),e("p",{class:"text-sm text-gray-600 mt-1"},"Recent interactions and milestones")],-1)),e("div",as,[P(It,{"principal-id":r.value,"timeline-data":f.value,loading:s.value},null,8,["principal-id","timeline-data","loading"])])])]),e("section",null,[e("div",os,[e("div",ss,[u[7]||(u[7]=e("div",null,[e("h3",{class:"text-lg font-medium text-gray-900"},"Active Opportunities"),e("p",{class:"text-sm text-gray-600 mt-1"},"Current sales pipeline")],-1)),P(Ut,{principal:d.value,onCreated:t},null,8,["principal"])]),e("div",ns,[P(ha,{"principal-id":r.value,loading:m.value},null,8,["principal-id","loading"])])])])]),e("div",is,[e("section",null,[e("div",rs,[e("div",ls,[u[8]||(u[8]=e("div",null,[e("h3",{class:"text-lg font-medium text-gray-900"},"Product Performance"),e("p",{class:"text-sm text-gray-600 mt-1"},"Product associations and success rates")],-1)),P(At,{principal:d.value,onUpdated:Me},null,8,["principal"])]),e("div",cs,[P(Bt,{products:v.value,loading:C.value,"principal-name":(L=d.value)==null?void 0:L.principal_name,onProductSelected:H,onCreateOpportunity:u[1]||(u[1]=xe=>J(d.value)),onExportData:X},null,8,["products","loading","principal-name"])])])]),e("section",null,[e("div",ds,[u[9]||(u[9]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Distributor Network"),e("p",{class:"text-sm text-gray-600 mt-1"},"Relationship hierarchy and connections")],-1)),e("div",us,[P(Ft,{relationships:q.value,loading:b.value,"principal-name":(we=d.value)==null?void 0:we.principal_name,onExportData:X,onDistributorSelected:Pe,onContactDistributor:De},null,8,["relationships","loading","principal-name"])])])])]),e("section",null,[e("div",ps,[e("div",ms,[u[10]||(u[10]=e("div",null,[e("h3",{class:"text-lg font-medium text-gray-900"},"Recent Interactions"),e("p",{class:"text-sm text-gray-600 mt-1"},"Communication history and ratings")],-1)),P(Ao,{principal:d.value,onLogged:Ce},null,8,["principal"])]),e("div",gs,[P(Za,{"principal-id":r.value,loading:j.value},null,8,["principal-id","loading"])])])])])):(p(),g("div",fs,[P(z(Nt),{class:"mx-auto h-12 w-12 text-gray-400"}),u[11]||(u[11]=e("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"Select a Principal",-1)),u[12]||(u[12]=e("p",{class:"mt-2 text-gray-600"}," Choose a principal from the dropdown above to view their activity dashboard and analytics. ",-1))]))]))])}}}),hs=me(_s,[["__scopeId","data-v-daf2c332"]]),vs={class:"principal-dashboard-view"},ys={class:"flex items-center justify-between mb-6"},bs={class:"flex items-center space-x-3"},ws=pe({__name:"PrincipalDashboardView",setup(I){const O=Ge();return Be(async()=>{try{await O.loadActivitySummaries()}catch(l){console.error("Failed to initialize principal dashboard:",l)}}),(l,r)=>{const $=yt("router-link");return p(),g("div",vs,[e("div",ys,[r[2]||(r[2]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Principal Activity Dashboard"),e("p",{class:"mt-1 text-sm text-gray-500"}," Comprehensive relationship insights and performance analytics ")],-1)),e("div",bs,[P($,{to:"/interactions",class:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:Y(()=>r[0]||(r[0]=[e("svg",{class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1),R(" Interactions ",-1)])),_:1,__:[0]}),P($,{to:"/opportunities",class:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:Y(()=>r[1]||(r[1]=[e("svg",{class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),R(" Opportunities ",-1)])),_:1,__:[1]})])]),P(z(hs))])}}}),mn=me(ws,[["__scopeId","data-v-32f308e0"]]);export{mn as default};
//# sourceMappingURL=PrincipalDashboardView-BGfgk_Up.js.map
