{"version":3,"file":"OpportunityFormWrapper-BavdCTUU.js","sources":["../../src/components/opportunities/OpportunityNameField.vue","../../src/components/opportunities/PrincipalMultiSelect.vue","../../src/components/opportunities/ProductSelect.vue","../../src/components/opportunities/StageSelect.vue","../../src/components/opportunities/OpportunityFormWrapper.vue"],"sourcesContent":["<template>\n  <div class=\"space-y-3\">\n    <!-- Field Label -->\n    <label\n      :for=\"fieldId\"\n      :class=\"labelClasses\"\n    >\n      {{ label }}\n      <span v-if=\"required\" class=\"text-danger ml-1\" aria-label=\"required\">*</span>\n    </label>\n\n    <!-- Description -->\n    <p\n      v-if=\"description\"\n      :id=\"descriptionId\"\n      class=\"text-sm text-gray-600\"\n    >\n      {{ description }}\n    </p>\n\n    <!-- Auto-generate Toggle -->\n    <div class=\"flex items-center space-x-3\">\n      <label class=\"flex items-center space-x-2 cursor-pointer\">\n        <input\n          type=\"checkbox\"\n          :checked=\"autoGenerate\"\n          @change=\"handleAutoGenerateToggle\"\n          class=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\n        />\n        <span class=\"text-sm text-gray-700\">Auto-generate opportunity name</span>\n      </label>\n      \n      <!-- Auto-generate info icon -->\n      <div class=\"relative group\">\n        <svg\n          class=\"h-4 w-4 text-gray-400 cursor-help\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path\n            stroke-linecap=\"round\"\n            stroke-linejoin=\"round\"\n            stroke-width=\"2\"\n            d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n          />\n        </svg>\n        \n        <!-- Tooltip -->\n        <div class=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 text-xs text-white bg-gray-900 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap\">\n          Names follow pattern: Organization - Principal - Context - Month Year\n        </div>\n      </div>\n    </div>\n\n    <!-- Live Preview (shown when auto-generate is enabled) -->\n    <div\n      v-if=\"autoGenerate && previewName\"\n      class=\"bg-blue-50 border border-blue-200 rounded-md p-3\"\n    >\n      <div class=\"flex items-start space-x-2\">\n        <svg\n          class=\"h-5 w-5 text-blue-500 mt-0.5 flex-shrink-0\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path\n            stroke-linecap=\"round\"\n            stroke-linejoin=\"round\"\n            stroke-width=\"2\"\n            d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\"\n          />\n          <path\n            stroke-linecap=\"round\"\n            stroke-linejoin=\"round\"\n            stroke-width=\"2\"\n            d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\"\n          />\n        </svg>\n        <div class=\"flex-1\">\n          <p class=\"text-sm font-medium text-blue-900\">Generated Name Preview:</p>\n          <p class=\"text-sm text-blue-700 font-mono mt-1\">{{ previewName }}</p>\n          <p v-if=\"nameTemplate\" class=\"text-xs text-blue-600 mt-1\">\n            Template: <span class=\"font-mono\">{{ nameTemplate }}</span>\n          </p>\n        </div>\n      </div>\n    </div>\n\n    <!-- Multiple Preview Names (for batch creation) -->\n    <div\n      v-if=\"autoGenerate && previewNames && previewNames.length > 1\"\n      class=\"bg-green-50 border border-green-200 rounded-md p-3\"\n    >\n      <div class=\"flex items-start space-x-2\">\n        <svg\n          class=\"h-5 w-5 text-green-500 mt-0.5 flex-shrink-0\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path\n            stroke-linecap=\"round\"\n            stroke-linejoin=\"round\"\n            stroke-width=\"2\"\n            d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n          />\n        </svg>\n        <div class=\"flex-1\">\n          <p class=\"text-sm font-medium text-green-900\">\n            Batch Creation Preview ({{ previewNames.length }} opportunities):\n          </p>\n          <div class=\"mt-2 space-y-1 max-h-32 overflow-y-auto\">\n            <div\n              v-for=\"preview in previewNames.slice(0, maxPreviewDisplay)\"\n              :key=\"preview.principal_id\"\n              class=\"text-xs font-mono text-green-700 bg-white bg-opacity-50 rounded px-2 py-1\"\n            >\n              {{ preview.generated_name }}\n            </div>\n            <p\n              v-if=\"previewNames.length > maxPreviewDisplay\"\n              class=\"text-xs text-green-600 italic\"\n            >\n              ... and {{ previewNames.length - maxPreviewDisplay }} more\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Manual Input Field (shown when auto-generate is disabled) -->\n    <div\n      v-if=\"!autoGenerate\"\n      class=\"relative\"\n    >\n      <input\n        :id=\"fieldId\"\n        type=\"text\"\n        :name=\"name\"\n        :placeholder=\"placeholder\"\n        :disabled=\"disabled\"\n        :required=\"required\"\n        :maxlength=\"maxlength\"\n        :value=\"modelValue\"\n        :aria-describedby=\"ariaDescribedBy\"\n        :aria-invalid=\"hasError\"\n        :aria-required=\"required\"\n        :class=\"inputClasses\"\n        @input=\"handleManualInput\"\n        @blur=\"handleBlur\"\n        @focus=\"handleFocus\"\n      />\n\n      <!-- Character count -->\n      <div\n        v-if=\"showCharacterCount && modelValue\"\n        class=\"absolute inset-y-0 right-0 flex items-center pr-3\"\n      >\n        <span\n          class=\"text-xs text-gray-400\"\n          :class=\"{ 'text-red-500': modelValue.length > (maxlength || 255) }\"\n        >\n          {{ modelValue.length }}{{ maxlength ? `/${maxlength}` : '' }}\n        </span>\n      </div>\n    </div>\n\n    <!-- Manual Override Button (when auto-generate is enabled) -->\n    <div\n      v-if=\"autoGenerate && !showManualOverride\"\n      class=\"flex justify-start\"\n    >\n      <button\n        type=\"button\"\n        @click=\"enableManualOverride\"\n        class=\"text-sm text-primary-600 hover:text-primary-700 focus:outline-none focus:underline\"\n      >\n        Want to customize the name? Click to override\n      </button>\n    </div>\n\n    <!-- Manual Override Input (when enabled) -->\n    <div\n      v-if=\"autoGenerate && showManualOverride\"\n      class=\"space-y-2\"\n    >\n      <div class=\"flex items-center justify-between\">\n        <label class=\"text-sm font-medium text-gray-700\">Custom Name Override:</label>\n        <button\n          type=\"button\"\n          @click=\"disableManualOverride\"\n          class=\"text-xs text-gray-500 hover:text-gray-700 focus:outline-none\"\n        >\n          Cancel override\n        </button>\n      </div>\n      \n      <input\n        :id=\"`${fieldId}-override`\"\n        type=\"text\"\n        :placeholder=\"previewName || 'Enter custom opportunity name...'\"\n        :value=\"manualOverride\"\n        :maxlength=\"maxlength\"\n        :class=\"overrideInputClasses\"\n        @input=\"handleOverrideInput\"\n        @blur=\"handleOverrideBlur\"\n      />\n    </div>\n\n    <!-- Error Message -->\n    <p\n      v-if=\"error\"\n      :id=\"errorId\"\n      role=\"alert\"\n      class=\"text-sm text-danger flex items-center space-x-1\"\n    >\n      <svg\n        class=\"h-4 w-4 flex-shrink-0\"\n        fill=\"none\"\n        stroke=\"currentColor\"\n        viewBox=\"0 0 24 24\"\n        aria-hidden=\"true\"\n      >\n        <path\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n          stroke-width=\"2\"\n          d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n        />\n      </svg>\n      <span>{{ error }}</span>\n    </p>\n\n    <!-- Help Text -->\n    <p\n      v-if=\"helpText && !error\"\n      :id=\"helpTextId\"\n      class=\"text-sm text-gray-500\"\n    >\n      {{ helpText }}\n    </p>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref, watch, nextTick } from 'vue'\nimport { opportunityNaming } from '@/services/opportunityNaming'\nimport type { \n  OpportunityNamePreview, \n  OpportunityContext \n} from '@/types/opportunities'\n\n/**\n * Props interface for OpportunityNameField component\n */\ninterface Props {\n  /** Field name for form identification */\n  name: string\n  /** Visual label for the field */\n  label: string\n  /** Current field value */\n  modelValue: string\n  /** Auto-generation enabled state */\n  autoGenerate: boolean\n  /** Organization name for auto-generation */\n  organizationName?: string\n  /** Principal name for single opportunity */\n  principalName?: string\n  /** Principal data for batch opportunities */\n  principalData?: Array<{ id: string; name: string }>\n  /** Opportunity context */\n  context?: OpportunityContext | null\n  /** Custom context string */\n  customContext?: string\n  /** Validation error message */\n  error?: string\n  /** Placeholder text for manual input */\n  placeholder?: string\n  /** Field description */\n  description?: string\n  /** Help text */\n  helpText?: string\n  /** Whether field is required */\n  required?: boolean\n  /** Whether field is disabled */\n  disabled?: boolean\n  /** Maximum character length */\n  maxlength?: number\n  /** Show character count */\n  showCharacterCount?: boolean\n  /** Maximum preview names to display */\n  maxPreviewDisplay?: number\n  /** Custom CSS classes for the input */\n  inputClass?: string\n  /** Custom CSS classes for the label */\n  labelClass?: string\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  placeholder: 'Enter opportunity name...',\n  maxlength: 255,\n  showCharacterCount: true,\n  maxPreviewDisplay: 5,\n  helpText: 'Auto-generated names help maintain consistency across opportunities'\n})\n\n/**\n * Event emissions\n */\ninterface Emits {\n  'update:modelValue': [value: string]\n  'update:autoGenerate': [value: boolean]\n  'update:nameTemplate': [value: string | null]\n  'blur': [event: FocusEvent]\n  'focus': [event: FocusEvent]\n  'input': [event: Event]\n  'name-generated': [name: string, template: string]\n  'batch-names-generated': [previews: OpportunityNamePreview[]]\n}\n\nconst emit = defineEmits<Emits>()\n\n// Reactive state\nconst isFocused = ref(false)\nconst showManualOverride = ref(false)\nconst manualOverride = ref('')\nconst previewName = ref('')\nconst nameTemplate = ref<string | null>(null)\nconst previewNames = ref<OpportunityNamePreview[]>([])\n\n/**\n * Computed properties for accessibility and styling\n */\nconst fieldId = computed(() => `name-field-${props.name}`)\nconst errorId = computed(() => `error-${props.name}`)\nconst descriptionId = computed(() => `desc-${props.name}`)\nconst helpTextId = computed(() => `help-${props.name}`)\n\nconst hasError = computed(() => !!props.error)\n\nconst ariaDescribedBy = computed(() => {\n  const ids: string[] = []\n  if (props.description) ids.push(descriptionId.value)\n  if (props.error) ids.push(errorId.value)\n  if (props.helpText && !props.error) ids.push(helpTextId.value)\n  return ids.length > 0 ? ids.join(' ') : undefined\n})\n\n/**\n * Styling with state-aware classes\n */\nconst labelClasses = computed(() => {\n  const base = 'block text-sm font-medium transition-colors duration-200'\n  const stateClasses = hasError.value \n    ? 'text-red-700' \n    : isFocused.value \n      ? 'text-primary-600' \n      : 'text-gray-700'\n  const disabledClasses = props.disabled ? 'opacity-60' : ''\n  const customClasses = props.labelClass || ''\n  \n  return `${base} ${stateClasses} ${disabledClasses} ${customClasses}`.trim()\n})\n\nconst inputClasses = computed(() => {\n  const base = 'w-full px-3 py-2 border rounded-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:border-transparent'\n  \n  const stateClasses = hasError.value\n    ? 'border-red-500 bg-red-50 focus:ring-red-500 focus:bg-white'\n    : isFocused.value\n      ? 'border-primary-500 bg-white focus:ring-primary-500'\n      : 'border-gray-300 bg-white hover:border-gray-400 focus:ring-primary-500'\n  \n  const disabledClasses = props.disabled \n    ? 'bg-gray-100 text-gray-500 cursor-not-allowed border-gray-200' \n    : ''\n  \n  const paddingClasses = props.showCharacterCount && props.modelValue \n    ? 'pr-16' \n    : ''\n  \n  const customClasses = props.inputClass || ''\n  \n  return `${base} ${stateClasses} ${disabledClasses} ${paddingClasses} ${customClasses}`.trim()\n})\n\nconst overrideInputClasses = computed(() => {\n  return 'w-full px-3 py-2 border border-amber-300 bg-amber-50 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent text-amber-900 placeholder-amber-600'\n})\n\n/**\n * Name generation logic\n */\nconst generatePreviewName = () => {\n  if (!props.autoGenerate || !props.organizationName) {\n    previewName.value = ''\n    nameTemplate.value = null\n    return\n  }\n\n  if (props.principalName) {\n    // Single opportunity preview\n    const generated = opportunityNaming.generateOpportunityName({\n      organization_name: props.organizationName,\n      principal_name: props.principalName,\n      context: props.context,\n      custom_context: props.customContext\n    })\n    \n    const template = opportunityNaming.generateNameTemplate({\n      organization_name: props.organizationName,\n      principal_name: props.principalName,\n      context: props.context,\n      custom_context: props.customContext\n    })\n    \n    previewName.value = generated\n    nameTemplate.value = template\n    \n    // Update model value if auto-generate is enabled and no manual override\n    if (!showManualOverride.value) {\n      emit('update:modelValue', generated)\n      emit('update:nameTemplate', template)\n      emit('name-generated', generated, template)\n    }\n  } else if (props.principalData && props.principalData.length > 0) {\n    // Batch opportunity previews\n    const previews = opportunityNaming.generateBatchNamePreviews({\n      organization_name: props.organizationName,\n      principal_data: props.principalData,\n      context: props.context,\n      custom_context: props.customContext\n    })\n    \n    previewNames.value = previews\n    \n    // Set first preview as main preview\n    if (previews.length > 0) {\n      previewName.value = previews[0].generated_name\n      nameTemplate.value = previews[0].name_template\n    }\n    \n    emit('batch-names-generated', previews)\n  }\n}\n\n/**\n * Event handlers\n */\nconst handleAutoGenerateToggle = (event: Event) => {\n  const target = event.target as HTMLInputElement\n  const enabled = target.checked\n  \n  emit('update:autoGenerate', enabled)\n  \n  if (enabled) {\n    generatePreviewName()\n    showManualOverride.value = false\n    manualOverride.value = ''\n  } else {\n    previewName.value = ''\n    nameTemplate.value = null\n    previewNames.value = []\n    emit('update:nameTemplate', null)\n  }\n}\n\nconst handleManualInput = (event: Event) => {\n  const target = event.target as HTMLInputElement\n  emit('update:modelValue', target.value)\n  emit('input', event)\n}\n\nconst handleOverrideInput = (event: Event) => {\n  const target = event.target as HTMLInputElement\n  manualOverride.value = target.value\n  emit('update:modelValue', target.value)\n}\n\nconst handleBlur = (event: FocusEvent) => {\n  isFocused.value = false\n  emit('blur', event)\n}\n\nconst handleFocus = (event: FocusEvent) => {\n  isFocused.value = true\n  emit('focus', event)\n}\n\nconst handleOverrideBlur = (_event: FocusEvent) => {\n  // If override is empty, revert to generated name\n  if (!manualOverride.value.trim() && previewName.value) {\n    emit('update:modelValue', previewName.value)\n  }\n}\n\nconst enableManualOverride = () => {\n  showManualOverride.value = true\n  manualOverride.value = props.modelValue\n  \n  nextTick(() => {\n    const overrideInput = document.getElementById(`${fieldId.value}-override`)\n    overrideInput?.focus()\n  })\n}\n\nconst disableManualOverride = () => {\n  showManualOverride.value = false\n  manualOverride.value = ''\n  \n  // Revert to generated name\n  if (previewName.value) {\n    emit('update:modelValue', previewName.value)\n  }\n}\n\n/**\n * Watchers for reactive updates\n */\nwatch(\n  [\n    () => props.autoGenerate,\n    () => props.organizationName,\n    () => props.principalName,\n    () => props.principalData,\n    () => props.context,\n    () => props.customContext\n  ],\n  () => {\n    if (props.autoGenerate) {\n      generatePreviewName()\n    }\n  },\n  { immediate: true }\n)\n\n/**\n * Public methods for parent component interaction\n */\ndefineExpose({\n  focus: () => {\n    const input = document.getElementById(fieldId.value) as HTMLInputElement\n    input?.focus()\n  },\n  generateName: generatePreviewName,\n  getPreviewNames: () => previewNames.value,\n  getNameTemplate: () => nameTemplate.value\n})\n</script>","<template>\n  <div class=\"space-y-1\">\n    <!-- Label -->\n    <label\n      :for=\"fieldId\"\n      :class=\"labelClasses\"\n    >\n      {{ label }}\n      <span v-if=\"required\" class=\"text-danger ml-1\" aria-label=\"required\">*</span>\n    </label>\n\n    <!-- Description -->\n    <p\n      v-if=\"description\"\n      :id=\"descriptionId\"\n      class=\"text-sm text-gray-600\"\n    >\n      {{ description }}\n    </p>\n\n    <!-- Multi-Select Dropdown -->\n    <div class=\"relative\">\n      <div\n        :class=\"containerClasses\"\n        @click=\"toggleDropdown\"\n      >\n        <!-- Selected Items Display -->\n        <div class=\"flex flex-wrap gap-1 min-h-[2.5rem] items-center p-2\">\n          <!-- Selected Principal Chips -->\n          <div\n            v-for=\"principalId in modelValue\"\n            :key=\"principalId\"\n            class=\"inline-flex items-center gap-1 px-2 py-1 bg-primary-100 text-primary-800 text-sm rounded-md border border-primary-200\"\n          >\n            <span class=\"font-medium\">{{ getPrincipalName(principalId) }}</span>\n            <button\n              type=\"button\"\n              @click.stop=\"removePrincipal(principalId)\"\n              :aria-label=\"`Remove ${getPrincipalName(principalId)}`\"\n              class=\"text-primary-600 hover:text-primary-800 focus:outline-none focus:ring-1 focus:ring-primary-500 rounded\"\n            >\n              <svg class=\"h-3 w-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\n              </svg>\n            </button>\n          </div>\n\n          <!-- Placeholder when no selection -->\n          <span \n            v-if=\"modelValue.length === 0 && placeholder\"\n            class=\"text-gray-500 text-sm\"\n          >\n            {{ placeholder }}\n          </span>\n        </div>\n\n        <!-- Dropdown Arrow -->\n        <div\n          class=\"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none\"\n          aria-hidden=\"true\"\n        >\n          <svg\n            :class=\"[\n              'h-4 w-4 transition-transform duration-200',\n              isOpen ? 'rotate-180' : '',\n              hasError ? 'text-red-500' : 'text-gray-400'\n            ]\"\n            fill=\"none\"\n            stroke=\"currentColor\"\n            viewBox=\"0 0 24 24\"\n          >\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 9l-7 7-7-7\" />\n          </svg>\n        </div>\n      </div>\n\n      <!-- Dropdown Options -->\n      <div\n        v-if=\"isOpen\"\n        :class=\"dropdownClasses\"\n        role=\"listbox\"\n        :aria-labelledby=\"fieldId\"\n        :aria-expanded=\"isOpen\"\n      >\n        <!-- Search Input -->\n        <div class=\"p-2 border-b border-gray-200\">\n          <input\n            ref=\"searchInput\"\n            v-model=\"searchTerm\"\n            type=\"text\"\n            placeholder=\"Search principals...\"\n            class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent text-sm\"\n            @click.stop\n          />\n        </div>\n\n        <!-- Options List -->\n        <div class=\"max-h-48 overflow-y-auto\">\n          <div\n            v-for=\"principal in filteredPrincipals\"\n            :key=\"principal.id\"\n            :class=\"optionClasses(principal.id)\"\n            role=\"option\"\n            :aria-selected=\"isSelected(principal.id)\"\n            @click=\"toggleSelection(principal.id)\"\n          >\n            <!-- Checkbox -->\n            <div class=\"flex items-center\">\n              <input\n                type=\"checkbox\"\n                :checked=\"isSelected(principal.id)\"\n                :disabled=\"disabled\"\n                class=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\n                @click.stop\n              />\n              <div class=\"ml-3 flex-1\">\n                <div class=\"flex items-center justify-between\">\n                  <span class=\"font-medium text-gray-900\">{{ principal.name }}</span>\n                  <span class=\"text-xs text-gray-500\">{{ principal.organization_type || 'Unknown' }}</span>\n                </div>\n                <p class=\"text-sm text-gray-600\">{{ principal.organization_name }}</p>\n                <p class=\"text-xs text-gray-500\">\n                  {{ principal.available_products.length }} product{{ principal.available_products.length !== 1 ? 's' : '' }} available\n                </p>\n              </div>\n            </div>\n          </div>\n\n          <!-- Empty State -->\n          <div\n            v-if=\"filteredPrincipals.length === 0\"\n            class=\"px-4 py-6 text-center text-gray-500\"\n          >\n            <svg class=\"mx-auto h-8 w-8 text-gray-400 mb-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\n            </svg>\n            <p>{{ searchTerm ? 'No principals found matching your search' : 'No principals available' }}</p>\n          </div>\n        </div>\n\n        <!-- Action Buttons -->\n        <div class=\"p-2 border-t border-gray-200 flex justify-between\">\n          <button\n            type=\"button\"\n            @click=\"clearSelection\"\n            class=\"text-sm text-gray-600 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500 rounded px-2 py-1\"\n          >\n            Clear All\n          </button>\n          <button\n            type=\"button\"\n            @click=\"selectAll\"\n            class=\"text-sm text-primary-600 hover:text-primary-800 focus:outline-none focus:ring-2 focus:ring-primary-500 rounded px-2 py-1\"\n          >\n            Select All ({{ filteredPrincipals.length }})\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Batch Creation Preview -->\n    <div\n      v-if=\"modelValue.length > 0 && showBatchPreview\"\n      class=\"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-md\"\n    >\n      <div class=\"flex items-start space-x-2\">\n        <svg class=\"h-5 w-5 text-blue-500 mt-0.5 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n        </svg>\n        <div class=\"flex-1\">\n          <h4 class=\"text-sm font-medium text-blue-800\">Batch Opportunity Creation</h4>\n          <p class=\"text-sm text-blue-700 mt-1\">\n            {{ modelValue.length }} opportunities will be created, one for each selected principal:\n          </p>\n          <ul class=\"text-sm text-blue-700 mt-2 space-y-1\">\n            <li\n              v-for=\"principalId in modelValue\"\n              :key=\"principalId\"\n              class=\"flex items-center space-x-2\"\n            >\n              <span class=\"w-2 h-2 bg-blue-400 rounded-full flex-shrink-0\"></span>\n              <span>{{ generateOpportunityName(principalId) }}</span>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n    <!-- Error Message -->\n    <p\n      v-if=\"error\"\n      :id=\"errorId\"\n      role=\"alert\"\n      class=\"text-sm text-danger flex items-center space-x-1\"\n    >\n      <svg\n        class=\"h-4 w-4 flex-shrink-0\"\n        fill=\"none\"\n        stroke=\"currentColor\"\n        viewBox=\"0 0 24 24\"\n        aria-hidden=\"true\"\n      >\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n      </svg>\n      <span>{{ error }}</span>\n    </p>\n\n    <!-- Help Text -->\n    <p\n      v-if=\"helpText && !error\"\n      :id=\"helpTextId\"\n      class=\"text-sm text-gray-500\"\n    >\n      {{ helpText }}\n    </p>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref, onMounted, onUnmounted, watch } from 'vue'\nimport { usePrincipalStore } from '@/stores/principalStore'\nimport type { PrincipalOption } from '@/stores/principalStore'\n\n/**\n * Props interface for PrincipalMultiSelect component\n */\ninterface Props {\n  /** Field name for form identification */\n  name: string\n  /** Visual label for the field */\n  label: string\n  /** Array of selected principal IDs */\n  modelValue: string[]\n  /** Validation error message */\n  error?: string\n  /** Placeholder text */\n  placeholder?: string\n  /** Field description for additional context */\n  description?: string\n  /** Help text shown when no error is present */\n  helpText?: string\n  /** Whether field is required */\n  required?: boolean\n  /** Whether field is disabled */\n  disabled?: boolean\n  /** Show batch creation preview */\n  showBatchPreview?: boolean\n  /** Base opportunity name for batch creation */\n  baseOpportunityName?: string\n  /** Custom CSS classes for the container */\n  containerClass?: string\n  /** Custom CSS classes for the label */\n  labelClass?: string\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  placeholder: 'Select principals...',\n  showBatchPreview: true,\n  baseOpportunityName: 'New Opportunity'\n})\n\n/**\n * Event emissions\n */\ninterface Emits {\n  'update:modelValue': [value: string[]]\n  'selection-changed': [selectedIds: string[], selectedPrincipals: PrincipalOption[]]\n  'principal-added': [principalId: string, principal: PrincipalOption]\n  'principal-removed': [principalId: string, principal: PrincipalOption | undefined]\n}\n\nconst emit = defineEmits<Emits>()\n\n// Store\nconst principalStore = usePrincipalStore()\n\n// Reactive state\nconst isOpen = ref(false)\nconst searchTerm = ref('')\nconst searchInput = ref<HTMLInputElement>()\n\n/**\n * Computed properties for accessibility and styling\n */\nconst fieldId = computed(() => `principal-multiselect-${props.name}`)\nconst errorId = computed(() => `error-${props.name}`)\nconst descriptionId = computed(() => `desc-${props.name}`)\nconst helpTextId = computed(() => `help-${props.name}`)\n\nconst hasError = computed(() => !!props.error)\n\n/**\n * Styling with state-aware classes\n */\nconst labelClasses = computed(() => {\n  const base = 'block text-sm font-medium transition-colors duration-200'\n  const stateClasses = hasError.value \n    ? 'text-red-700' \n    : 'text-gray-700'\n  const disabledClasses = props.disabled ? 'opacity-60' : ''\n  const customClasses = props.labelClass || ''\n  \n  return `${base} ${stateClasses} ${disabledClasses} ${customClasses}`.trim()\n})\n\nconst containerClasses = computed(() => {\n  const base = 'relative w-full border rounded-md transition-all duration-200 cursor-pointer focus-within:ring-2 focus-within:border-transparent'\n  \n  let stateClasses = ''\n  if (hasError.value) {\n    stateClasses = 'border-red-500 bg-red-50 focus-within:ring-red-500'\n  } else if (isOpen.value) {\n    stateClasses = 'border-primary-500 bg-white ring-2 ring-primary-500'\n  } else {\n    stateClasses = 'border-gray-300 bg-white hover:border-gray-400 focus-within:ring-primary-500'\n  }\n  \n  const disabledClasses = props.disabled \n    ? 'bg-gray-100 cursor-not-allowed border-gray-200' \n    : ''\n  \n  const customClasses = props.containerClass || ''\n  \n  return `${base} ${stateClasses} ${disabledClasses} ${customClasses}`.trim()\n})\n\nconst dropdownClasses = computed(() => {\n  const base = 'absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg'\n  return base\n})\n\nconst optionClasses = (principalId: string) => {\n  const base = 'px-4 py-2 cursor-pointer transition-colors duration-150'\n  const selected = isSelected(principalId)\n  const stateClasses = selected\n    ? 'bg-primary-50 text-primary-900'\n    : 'hover:bg-gray-50 text-gray-900'\n  \n  return `${base} ${stateClasses}`\n}\n\n/**\n * Filtered principals based on search term\n */\nconst filteredPrincipals = computed(() => {\n  if (!searchTerm.value) {\n    return principalStore.principalOptions\n  }\n  \n  const search = searchTerm.value.toLowerCase()\n  return principalStore.principalOptions.filter(principal => \n    principal.name.toLowerCase().includes(search) ||\n    principal.organization_name.toLowerCase().includes(search) ||\n    (principal.organization_type || '').toLowerCase().includes(search)\n  )\n})\n\n/**\n * Utility functions\n */\nconst isSelected = (principalId: string): boolean => {\n  return props.modelValue.includes(principalId)\n}\n\nconst getPrincipalName = (principalId: string): string => {\n  const principal = principalStore.principalOptions.find(p => p.id === principalId)\n  return principal ? principal.name : 'Unknown Principal'\n}\n\nconst generateOpportunityName = (principalId: string): string => {\n  const principal = principalStore.principalOptions.find(p => p.id === principalId)\n  if (!principal) return props.baseOpportunityName\n  \n  return `${props.baseOpportunityName} - ${principal.organization_name}`\n}\n\n/**\n * Selection management\n */\nconst toggleSelection = (principalId: string): void => {\n  if (props.disabled) return\n  \n  const newSelection = [...props.modelValue]\n  const index = newSelection.indexOf(principalId)\n  const principal = principalStore.principalOptions.find(p => p.id === principalId)\n  \n  if (index > -1) {\n    newSelection.splice(index, 1)\n    emit('principal-removed', principalId, principal)\n  } else {\n    newSelection.push(principalId)\n    if (principal) {\n      emit('principal-added', principalId, principal)\n    }\n  }\n  \n  emit('update:modelValue', newSelection)\n  emitSelectionChanged(newSelection)\n}\n\nconst removePrincipal = (principalId: string): void => {\n  if (props.disabled) return\n  \n  const newSelection = props.modelValue.filter(id => id !== principalId)\n  const principal = principalStore.principalOptions.find(p => p.id === principalId)\n  \n  emit('update:modelValue', newSelection)\n  emit('principal-removed', principalId, principal)\n  emitSelectionChanged(newSelection)\n}\n\nconst clearSelection = (): void => {\n  if (props.disabled) return\n  \n  emit('update:modelValue', [])\n  emitSelectionChanged([])\n}\n\nconst selectAll = (): void => {\n  if (props.disabled) return\n  \n  const allIds = filteredPrincipals.value.map(p => p.id)\n  emit('update:modelValue', allIds)\n  emitSelectionChanged(allIds)\n}\n\nconst emitSelectionChanged = (selectedIds: string[]): void => {\n  const selectedPrincipals = principalStore.principalOptions.filter(p => \n    selectedIds.includes(p.id)\n  )\n  emit('selection-changed', selectedIds, selectedPrincipals)\n}\n\n/**\n * Dropdown management\n */\nconst toggleDropdown = (): void => {\n  if (props.disabled) return\n  \n  isOpen.value = !isOpen.value\n  \n  if (isOpen.value) {\n    // Focus search input when dropdown opens\n    setTimeout(() => {\n      searchInput.value?.focus()\n    }, 100)\n  }\n}\n\nconst closeDropdown = (): void => {\n  isOpen.value = false\n  searchTerm.value = ''\n}\n\n/**\n * Click outside handler\n */\nconst handleClickOutside = (event: Event): void => {\n  const target = event.target as Element\n  const container = document.getElementById(fieldId.value)\n  \n  if (container && !container.contains(target)) {\n    closeDropdown()\n  }\n}\n\n/**\n * Lifecycle hooks\n */\nonMounted(async () => {\n  // Load principal options if not already loaded\n  if (principalStore.principalOptions.length === 0) {\n    await principalStore.fetchPrincipalOptions()\n  }\n  \n  // Add click outside listener\n  document.addEventListener('click', handleClickOutside)\n})\n\nonUnmounted(() => {\n  document.removeEventListener('click', handleClickOutside)\n})\n\n/**\n * Watch for changes to emit selection events\n */\nwatch(() => props.modelValue, (newValue) => {\n  emitSelectionChanged(newValue)\n}, { immediate: true })\n\n/**\n * Public methods for parent component interaction\n */\ndefineExpose({\n  focus: () => {\n    const container = document.getElementById(fieldId.value)\n    container?.focus()\n  },\n  openDropdown: () => {\n    isOpen.value = true\n  },\n  closeDropdown,\n  clearSelection,\n  selectAll,\n  getSelectedPrincipals: () => {\n    return principalStore.principalOptions.filter(p => \n      props.modelValue.includes(p.id)\n    )\n  }\n})\n</script>","<template>\n  <div class=\"space-y-1\">\n    <!-- Label -->\n    <label\n      :for=\"fieldId\"\n      :class=\"labelClasses\"\n    >\n      {{ label }}\n      <span v-if=\"required\" class=\"text-danger ml-1\" aria-label=\"required\">*</span>\n    </label>\n\n    <!-- Description -->\n    <p\n      v-if=\"description\"\n      :id=\"descriptionId\"\n      class=\"text-sm text-gray-600\"\n    >\n      {{ description }}\n    </p>\n\n    <!-- Principal Context Info -->\n    <div\n      v-if=\"selectedPrincipals.length > 0 && showPrincipalContext\"\n      class=\"flex items-center space-x-2 text-xs text-gray-600 bg-gray-50 px-2 py-1 rounded\"\n    >\n      <svg class=\"h-3 w-3 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n      </svg>\n      <span>\n        Showing products available to {{ selectedPrincipals.length }} selected principal{{ selectedPrincipals.length !== 1 ? 's' : '' }}\n      </span>\n    </div>\n\n    <!-- Product Select Field -->\n    <div class=\"relative\">\n      <select\n        :id=\"fieldId\"\n        :name=\"name\"\n        :disabled=\"disabled || isFiltering\"\n        :required=\"required\"\n        :value=\"modelValue\"\n        :aria-describedby=\"ariaDescribedBy\"\n        :aria-invalid=\"hasError\"\n        :aria-required=\"required\"\n        :class=\"selectClasses\"\n        @change=\"handleChange\"\n        @blur=\"handleBlur\"\n        @focus=\"handleFocus\"\n      >\n        <!-- Loading option -->\n        <option\n          v-if=\"isFiltering\"\n          value=\"\"\n          disabled\n        >\n          Loading products...\n        </option>\n\n        <!-- Placeholder option -->\n        <option\n          v-else-if=\"placeholder\"\n          value=\"\"\n          :disabled=\"required\"\n        >\n          {{ placeholder }}\n        </option>\n\n        <!-- No principals selected state -->\n        <option\n          v-else-if=\"selectedPrincipals.length === 0\"\n          value=\"\"\n          disabled\n        >\n          Please select principals first\n        </option>\n\n        <!-- Product options grouped by category -->\n        <template v-if=\"!isFiltering && availableProducts.length > 0 && productCategories.length > 0\">\n          <optgroup\n            v-for=\"category in productCategories\"\n            :key=\"category.name\"\n            :label=\"category.label\"\n          >\n            <option\n              v-for=\"product in category.products\"\n              :key=\"product.id\"\n              :value=\"product.id\"\n              :disabled=\"!product.is_active\"\n            >\n              {{ product.name }}\n              <template v-if=\"showProductDetails\">\n                - {{ product.category }} ({{ product.available_principals.length }} principal{{ product.available_principals.length !== 1 ? 's' : '' }})\n              </template>\n            </option>\n          </optgroup>\n        </template>\n\n        <!-- Ungrouped products (fallback) -->\n        <template v-else-if=\"!isFiltering && availableProducts.length > 0\">\n          <option\n            v-for=\"product in availableProducts\"\n            :key=\"product.id\"\n            :value=\"product.id\"\n            :disabled=\"!product.is_active\"\n          >\n            {{ product.name }}\n            <template v-if=\"showProductDetails\">\n              ({{ product.available_principals.length }} principal{{ product.available_principals.length !== 1 ? 's' : '' }})\n            </template>\n          </option>\n        </template>\n      </select>\n\n      <!-- Custom dropdown arrow with loading spinner -->\n      <div\n        class=\"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none\"\n        aria-hidden=\"true\"\n      >\n        <!-- Loading Spinner -->\n        <svg\n          v-if=\"isFiltering\"\n          class=\"animate-spin h-4 w-4 text-primary-500\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n        >\n          <circle\n            class=\"opacity-25\"\n            cx=\"12\"\n            cy=\"12\"\n            r=\"10\"\n            stroke=\"currentColor\"\n            stroke-width=\"4\"\n          />\n          <path\n            class=\"opacity-75\"\n            fill=\"currentColor\"\n            d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n          />\n        </svg>\n\n        <!-- Regular Arrow -->\n        <svg\n          v-else\n          class=\"h-4 w-4 text-gray-400\"\n          :class=\"{ 'text-red-500': hasError }\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path\n            stroke-linecap=\"round\"\n            stroke-linejoin=\"round\"\n            stroke-width=\"2\"\n            d=\"M19 9l-7 7-7-7\"\n          />\n        </svg>\n      </div>\n    </div>\n\n    <!-- Product Information Display -->\n    <div\n      v-if=\"selectedProduct && showProductInfo\"\n      class=\"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-md\"\n    >\n      <div class=\"flex items-start space-x-3\">\n        <div class=\"flex-shrink-0\">\n          <div class=\"w-2 h-2 bg-blue-400 rounded-full mt-2\"></div>\n        </div>\n        <div class=\"flex-1\">\n          <h4 class=\"text-sm font-medium text-blue-900\">{{ selectedProduct.name }}</h4>\n          <p v-if=\"selectedProduct.category\" class=\"text-sm text-blue-700\">\n            Category: {{ selectedProduct.category }}\n          </p>\n          <p class=\"text-sm text-blue-700\">\n            Available to {{ selectedProduct.available_principals.length }} principal{{ selectedProduct.available_principals.length !== 1 ? 's' : '' }}\n          </p>\n          <div v-if=\"selectedProduct.description\" class=\"mt-1\">\n            <p class=\"text-xs text-blue-600\">{{ selectedProduct.description }}</p>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Empty State Message -->\n    <div\n      v-if=\"!isFiltering && selectedPrincipals.length > 0 && availableProducts.length === 0\"\n      class=\"mt-2 p-4 bg-gray-50 border border-gray-200 rounded-md text-center\"\n    >\n      <svg class=\"mx-auto h-8 w-8 text-gray-400 mb-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2 2v-5m16 0h-2M4 13h2m13-8l-1 1m0 0l-1 1m1-1v4M6 5l1 1v4\" />\n      </svg>\n      <p class=\"text-sm text-gray-600\">\n        No products available for the selected principals.\n      </p>\n      <p class=\"text-xs text-gray-500 mt-1\">\n        Try selecting different principals or contact your administrator.\n      </p>\n    </div>\n\n    <!-- Product Count Summary -->\n    <div\n      v-if=\"!isFiltering && availableProducts.length > 0 && showProductCount\"\n      class=\"text-xs text-gray-500 mt-1\"\n    >\n      {{ availableProducts.length }} product{{ availableProducts.length !== 1 ? 's' : '' }} available\n      <template v-if=\"productCategories.length > 1\">\n        across {{ productCategories.length }} categories\n      </template>\n    </div>\n\n    <!-- Error Message -->\n    <p\n      v-if=\"error\"\n      :id=\"errorId\"\n      role=\"alert\"\n      class=\"text-sm text-danger flex items-center space-x-1\"\n    >\n      <svg\n        class=\"h-4 w-4 flex-shrink-0\"\n        fill=\"none\"\n        stroke=\"currentColor\"\n        viewBox=\"0 0 24 24\"\n        aria-hidden=\"true\"\n      >\n        <path\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n          stroke-width=\"2\"\n          d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n        />\n      </svg>\n      <span>{{ error }}</span>\n    </p>\n\n    <!-- Help Text -->\n    <p\n      v-if=\"helpText && !error\"\n      :id=\"helpTextId\"\n      class=\"text-sm text-gray-500\"\n    >\n      {{ helpText }}\n    </p>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref, watch, onMounted } from 'vue'\nimport { useProductStore } from '@/stores/productStore'\nimport type { ProductOption } from '@/types/products'\n\n/**\n * Props interface for ProductSelect component\n */\ninterface Props {\n  /** Field name for form identification */\n  name: string\n  /** Visual label for the field */\n  label: string\n  /** Currently selected product ID */\n  modelValue: string\n  /** Array of selected principal IDs to filter products */\n  selectedPrincipals: string[]\n  /** Validation error message */\n  error?: string\n  /** Placeholder text */\n  placeholder?: string\n  /** Field description for additional context */\n  description?: string\n  /** Help text shown when no error is present */\n  helpText?: string\n  /** Whether field is required */\n  required?: boolean\n  /** Whether field is disabled */\n  disabled?: boolean\n  /** Show principal context info */\n  showPrincipalContext?: boolean\n  /** Show detailed product information */\n  showProductInfo?: boolean\n  /** Show product details in options */\n  showProductDetails?: boolean\n  /** Show product count summary */\n  showProductCount?: boolean\n  /** Custom CSS classes for the select */\n  selectClass?: string\n  /** Custom CSS classes for the label */\n  labelClass?: string\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  placeholder: 'Select a product...',\n  showPrincipalContext: true,\n  showProductInfo: true,\n  showProductDetails: false,\n  showProductCount: true\n})\n\n/**\n * Event emissions\n */\ninterface Emits {\n  'update:modelValue': [value: string]\n  'blur': [event: FocusEvent]\n  'focus': [event: FocusEvent]\n  'change': [event: Event]\n  'product-selected': [productId: string, product: ProductOption | undefined]\n  'products-filtered': [availableProducts: ProductOption[]]\n}\n\nconst emit = defineEmits<Emits>()\n\n// Store\nconst productStore = useProductStore()\n\n// Reactive state\nconst isFocused = ref(false)\nconst isFiltering = ref(false)\n\n/**\n * Computed properties for accessibility and styling\n */\nconst fieldId = computed(() => `product-select-${props.name}`)\nconst errorId = computed(() => `error-${props.name}`)\nconst descriptionId = computed(() => `desc-${props.name}`)\nconst helpTextId = computed(() => `help-${props.name}`)\n\nconst hasError = computed(() => !!props.error)\n\nconst ariaDescribedBy = computed(() => {\n  const ids: string[] = []\n  if (props.description) ids.push(descriptionId.value)\n  if (props.error) ids.push(errorId.value)\n  if (props.helpText && !props.error) ids.push(helpTextId.value)\n  return ids.length > 0 ? ids.join(' ') : undefined\n})\n\n/**\n * Styling with state-aware classes\n */\nconst labelClasses = computed(() => {\n  const base = 'block text-sm font-medium transition-colors duration-200'\n  const stateClasses = hasError.value \n    ? 'text-red-700' \n    : isFocused.value \n      ? 'text-primary' \n      : 'text-gray-700'\n  const disabledClasses = props.disabled ? 'opacity-60' : ''\n  const customClasses = props.labelClass || ''\n  \n  return `${base} ${stateClasses} ${disabledClasses} ${customClasses}`.trim()\n})\n\nconst selectClasses = computed(() => {\n  const base = 'w-full px-3 py-2 pr-10 border rounded-md transition-all duration-200 focus:outline-none focus:ring-2 focus:border-transparent'\n  \n  let stateClasses = ''\n  if (hasError.value) {\n    stateClasses = 'border-red-500 bg-red-50 focus:ring-red-500 focus:bg-white'\n  } else if (props.modelValue && props.modelValue !== '') {\n    stateClasses = 'border-green-400 bg-green-50 focus:ring-primary-500 focus:bg-white'\n  } else {\n    stateClasses = isFocused.value\n      ? 'border-primary-500 bg-white focus:ring-primary-500'\n      : 'border-gray-300 bg-white hover:border-gray-400 focus:ring-primary-500'\n  }\n  \n  const disabledClasses = props.disabled || isFiltering.value\n    ? 'bg-gray-100 text-gray-500 cursor-not-allowed border-gray-200' \n    : 'cursor-pointer'\n  \n  const customClasses = props.selectClass || ''\n  \n  return `${base} ${stateClasses} ${disabledClasses} ${customClasses}`.trim()\n})\n\n/**\n * Product filtering logic\n */\nconst availableProducts = computed(() => {\n  if (props.selectedPrincipals.length === 0) {\n    return []\n  }\n  \n  return productStore.getProductsForPrincipals(props.selectedPrincipals)\n})\n\nconst selectedProduct = computed(() => {\n  if (!props.modelValue) return null\n  return availableProducts.value.find(p => p.id === props.modelValue) || null\n})\n\n/**\n * Product categorization for optgroups\n */\nconst productCategories = computed(() => {\n  const categories = new Map<string, ProductOption[]>()\n  \n  availableProducts.value.forEach(product => {\n    const category = product.category || 'Other'\n    if (!categories.has(category)) {\n      categories.set(category, [])\n    }\n    categories.get(category)!.push(product)\n  })\n  \n  // Convert to array and sort\n  return Array.from(categories.entries())\n    .map(([name, products]) => ({\n      name,\n      label: name,\n      products: products.sort((a, b) => a.name.localeCompare(b.name))\n    }))\n    .sort((a, b) => {\n      // 'Other' category goes last\n      if (a.name === 'Other' && b.name !== 'Other') return 1\n      if (b.name === 'Other' && a.name !== 'Other') return -1\n      return a.name.localeCompare(b.name)\n    })\n})\n\n/**\n * Filter products when principals change\n */\nconst filterProducts = async (): Promise<void> => {\n  if (props.selectedPrincipals.length === 0) {\n    return\n  }\n  \n  isFiltering.value = true\n  \n  try {\n    await productStore.fetchProductsForPrincipals(props.selectedPrincipals)\n    emit('products-filtered', availableProducts.value)\n    \n    // Clear selection if current product is not available for selected principals\n    if (props.modelValue && !availableProducts.value.find(p => p.id === props.modelValue)) {\n      emit('update:modelValue', '')\n      emit('product-selected', '', undefined)\n    }\n  } catch (error) {\n    console.error('Failed to filter products:', error)\n  } finally {\n    isFiltering.value = false\n  }\n}\n\n/**\n * Event handlers\n */\nconst handleChange = (event: Event) => {\n  const target = event.target as HTMLSelectElement\n  const value = target.value\n  \n  emit('update:modelValue', value)\n  emit('change', event)\n  \n  // Emit product-specific event\n  const product = availableProducts.value.find(p => p.id === value)\n  emit('product-selected', value, product)\n}\n\nconst handleBlur = (event: FocusEvent) => {\n  isFocused.value = false\n  emit('blur', event)\n}\n\nconst handleFocus = (event: FocusEvent) => {\n  isFocused.value = true\n  emit('focus', event)\n}\n\n/**\n * Watch for principal changes to filter products\n */\nwatch(\n  () => props.selectedPrincipals,\n  async (newPrincipals, oldPrincipals) => {\n    // Only filter if principals actually changed\n    if (JSON.stringify(newPrincipals) !== JSON.stringify(oldPrincipals)) {\n      await filterProducts()\n    }\n  },\n  { immediate: true, deep: true }\n)\n\n/**\n * Lifecycle hooks\n */\nonMounted(async () => {\n  // Initial product filtering if principals are already selected\n  if (props.selectedPrincipals.length > 0) {\n    await filterProducts()\n  }\n})\n\n/**\n * Public methods for parent component interaction\n */\ndefineExpose({\n  focus: () => {\n    const select = document.getElementById(fieldId.value) as HTMLSelectElement\n    select?.focus()\n  },\n  blur: () => {\n    const select = document.getElementById(fieldId.value) as HTMLSelectElement\n    select?.blur()\n  },\n  refresh: filterProducts,\n  getSelectedProduct: () => selectedProduct.value,\n  getAvailableProducts: () => availableProducts.value,\n  isFiltering: () => isFiltering.value\n})\n</script>","<template>\n  <div class=\"space-y-1\">\n    <!-- Label -->\n    <label\n      :for=\"fieldId\"\n      :class=\"labelClasses\"\n    >\n      {{ label }}\n      <span v-if=\"required\" class=\"text-danger ml-1\" aria-label=\"required\">*</span>\n    </label>\n\n    <!-- Description -->\n    <p\n      v-if=\"description\"\n      :id=\"descriptionId\"\n      class=\"text-sm text-gray-600\"\n    >\n      {{ description }}\n    </p>\n\n    <!-- Stage Select Field -->\n    <div class=\"relative\">\n      <select\n        :id=\"fieldId\"\n        :name=\"name\"\n        :disabled=\"disabled\"\n        :required=\"required\"\n        :value=\"modelValue\"\n        :aria-describedby=\"ariaDescribedBy\"\n        :aria-invalid=\"hasError\"\n        :aria-required=\"required\"\n        :class=\"selectClasses\"\n        @change=\"handleChange\"\n        @blur=\"handleBlur\"\n        @focus=\"handleFocus\"\n      >\n        <!-- Placeholder option -->\n        <option\n          v-if=\"placeholder\"\n          value=\"\"\n          :disabled=\"required\"\n        >\n          {{ placeholder }}\n        </option>\n\n        <!-- Stage options with progress indicators -->\n        <option\n          v-for=\"stage in stageOptions\"\n          :key=\"stage.value\"\n          :value=\"stage.value\"\n        >\n          {{ stage.label }} {{ stage.progressIcon }}\n        </option>\n      </select>\n\n      <!-- Custom dropdown arrow -->\n      <div\n        class=\"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none\"\n        aria-hidden=\"true\"\n      >\n        <svg\n          class=\"h-4 w-4 text-gray-400\"\n          :class=\"{ 'text-red-500': hasError }\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path\n            stroke-linecap=\"round\"\n            stroke-linejoin=\"round\"\n            stroke-width=\"2\"\n            d=\"M19 9l-7 7-7-7\"\n          />\n        </svg>\n      </div>\n    </div>\n\n    <!-- Stage Visual Indicator -->\n    <div\n      v-if=\"modelValue && showStageIndicator\"\n      class=\"flex items-center space-x-2 mt-2\"\n    >\n      <div\n        :class=\"[\n          'w-3 h-3 rounded-full',\n          getStageColorClasses(modelValue).bg\n        ]\"\n      />\n      <span :class=\"['text-sm font-medium', getStageColorClasses(modelValue).text]\">\n        {{ getStageLabel(modelValue) }}\n      </span>\n      <span class=\"text-xs text-gray-500\">\n        ({{ getDefaultProbability(modelValue) }}% typical probability)\n      </span>\n    </div>\n\n    <!-- Stage Progress Bar -->\n    <div\n      v-if=\"modelValue && showProgressBar\"\n      class=\"mt-2\"\n    >\n      <div class=\"flex justify-between text-xs text-gray-600 mb-1\">\n        <span>Pipeline Progress</span>\n        <span>{{ getStageProgress(modelValue) }}%</span>\n      </div>\n      <div class=\"w-full bg-gray-200 rounded-full h-2\">\n        <div\n          :class=\"[\n            'h-2 rounded-full transition-all duration-300',\n            getStageColorClasses(modelValue).bg\n          ]\"\n          :style=\"{ width: `${getStageProgress(modelValue)}%` }\"\n        />\n      </div>\n    </div>\n\n    <!-- Error Message -->\n    <p\n      v-if=\"error\"\n      :id=\"errorId\"\n      role=\"alert\"\n      class=\"text-sm text-danger flex items-center space-x-1\"\n    >\n      <svg\n        class=\"h-4 w-4 flex-shrink-0\"\n        fill=\"none\"\n        stroke=\"currentColor\"\n        viewBox=\"0 0 24 24\"\n        aria-hidden=\"true\"\n      >\n        <path\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n          stroke-width=\"2\"\n          d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n        />\n      </svg>\n      <span>{{ error }}</span>\n    </p>\n\n    <!-- Help Text -->\n    <p\n      v-if=\"helpText && !error\"\n      :id=\"helpTextId\"\n      class=\"text-sm text-gray-500\"\n    >\n      {{ helpText }}\n    </p>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref } from 'vue'\nimport { \n  OpportunityStage,\n  STAGE_DEFAULT_PROBABILITY \n} from '@/types/opportunities'\n\n/**\n * Props interface for StageSelect component\n */\ninterface Props {\n  /** Field name for form identification */\n  name: string\n  /** Visual label for the field */\n  label: string\n  /** Current selected stage */\n  modelValue: OpportunityStage | ''\n  /** Validation error message */\n  error?: string\n  /** Placeholder text */\n  placeholder?: string\n  /** Field description for additional context */\n  description?: string\n  /** Help text shown when no error is present */\n  helpText?: string\n  /** Whether field is required */\n  required?: boolean\n  /** Whether field is disabled */\n  disabled?: boolean\n  /** Show visual stage indicator */\n  showStageIndicator?: boolean\n  /** Show progress bar */\n  showProgressBar?: boolean\n  /** Custom CSS classes for the select */\n  selectClass?: string\n  /** Custom CSS classes for the label */\n  labelClass?: string\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  placeholder: 'Select opportunity stage...',\n  showStageIndicator: true,\n  showProgressBar: true\n})\n\n/**\n * Event emissions\n */\ninterface Emits {\n  'update:modelValue': [value: OpportunityStage | '']\n  'blur': [event: FocusEvent]\n  'focus': [event: FocusEvent] \n  'change': [event: Event]\n  'stage-changed': [stage: OpportunityStage, probability: number]\n}\n\nconst emit = defineEmits<Emits>()\n\n// Reactive state\nconst isFocused = ref(false)\n\n/**\n * Stage options with progress indicators\n */\nconst stageOptions = computed(() => [\n  { \n    value: OpportunityStage.NEW_LEAD, \n    label: 'New Lead', \n    progressIcon: '🔍' \n  },\n  { \n    value: OpportunityStage.INITIAL_OUTREACH, \n    label: 'Initial Outreach', \n    progressIcon: '📞' \n  },\n  { \n    value: OpportunityStage.SAMPLE_VISIT_OFFERED, \n    label: 'Sample/Visit Offered', \n    progressIcon: '📦' \n  },\n  { \n    value: OpportunityStage.AWAITING_RESPONSE, \n    label: 'Awaiting Response', \n    progressIcon: '⏳' \n  },\n  { \n    value: OpportunityStage.FEEDBACK_LOGGED, \n    label: 'Feedback Logged', \n    progressIcon: '📝' \n  },\n  { \n    value: OpportunityStage.DEMO_SCHEDULED, \n    label: 'Demo Scheduled', \n    progressIcon: '🗓️' \n  },\n  { \n    value: OpportunityStage.CLOSED_WON, \n    label: 'Closed - Won', \n    progressIcon: '✅' \n  }\n])\n\n/**\n * Computed properties for accessibility and styling\n */\nconst fieldId = computed(() => `stage-select-${props.name}`)\nconst errorId = computed(() => `error-${props.name}`)\nconst descriptionId = computed(() => `desc-${props.name}`)\nconst helpTextId = computed(() => `help-${props.name}`)\n\nconst hasError = computed(() => !!props.error)\n\nconst ariaDescribedBy = computed(() => {\n  const ids: string[] = []\n  if (props.description) ids.push(descriptionId.value)\n  if (props.error) ids.push(errorId.value)\n  if (props.helpText && !props.error) ids.push(helpTextId.value)\n  return ids.length > 0 ? ids.join(' ') : undefined\n})\n\n/**\n * Styling with state-aware classes\n */\nconst labelClasses = computed(() => {\n  const base = 'block text-sm font-medium transition-colors duration-200'\n  const stateClasses = hasError.value \n    ? 'text-red-700' \n    : isFocused.value \n      ? 'text-primary' \n      : 'text-gray-700'\n  const disabledClasses = props.disabled ? 'opacity-60' : ''\n  const customClasses = props.labelClass || ''\n  \n  return `${base} ${stateClasses} ${disabledClasses} ${customClasses}`.trim()\n})\n\nconst selectClasses = computed(() => {\n  const base = 'w-full px-3 py-2 pr-10 border rounded-md transition-all duration-200 focus:outline-none focus:ring-2 focus:border-transparent'\n  \n  // State-specific styling with stage color integration\n  let stateClasses = ''\n  if (hasError.value) {\n    stateClasses = 'border-red-500 bg-red-50 focus:ring-red-500 focus:bg-white'\n  } else if (props.modelValue && props.modelValue !== '' as OpportunityStage) {\n    const stageColors = getStageColorClasses(props.modelValue as OpportunityStage)\n    stateClasses = `border-${stageColors.border} bg-${stageColors.bgLight} focus:ring-${stageColors.ring} focus:bg-white`\n  } else {\n    stateClasses = isFocused.value\n      ? 'border-primary-500 bg-white focus:ring-primary-500'\n      : 'border-gray-300 bg-white hover:border-gray-400 focus:ring-primary-500'\n  }\n  \n  const disabledClasses = props.disabled \n    ? 'bg-gray-100 text-gray-500 cursor-not-allowed border-gray-200' \n    : 'cursor-pointer'\n  \n  const customClasses = props.selectClass || ''\n  \n  return `${base} ${stateClasses} ${disabledClasses} ${customClasses}`.trim()\n})\n\n/**\n * Stage utility functions\n */\nconst getStageLabel = (stage: OpportunityStage): string => {\n  const option = stageOptions.value.find(opt => opt.value === stage)\n  return option ? option.label : stage\n}\n\nconst getStageColorClasses = (stage: OpportunityStage) => {\n  const colorMap = {\n    [OpportunityStage.NEW_LEAD]: {\n      bg: 'bg-gray-500',\n      bgLight: 'gray-50',\n      text: 'text-gray-700',\n      border: 'gray-400',\n      ring: 'gray-500'\n    },\n    [OpportunityStage.INITIAL_OUTREACH]: {\n      bg: 'bg-blue-500',\n      bgLight: 'blue-50',\n      text: 'text-blue-700',\n      border: 'blue-400',\n      ring: 'blue-500'\n    },\n    [OpportunityStage.SAMPLE_VISIT_OFFERED]: {\n      bg: 'bg-yellow-500',\n      bgLight: 'yellow-50',\n      text: 'text-yellow-700',\n      border: 'yellow-400',\n      ring: 'yellow-500'\n    },\n    [OpportunityStage.AWAITING_RESPONSE]: {\n      bg: 'bg-orange-500',\n      bgLight: 'orange-50',\n      text: 'text-orange-700',\n      border: 'orange-400',\n      ring: 'orange-500'\n    },\n    [OpportunityStage.FEEDBACK_LOGGED]: {\n      bg: 'bg-purple-500',\n      bgLight: 'purple-50',\n      text: 'text-purple-700',\n      border: 'purple-400',\n      ring: 'purple-500'\n    },\n    [OpportunityStage.DEMO_SCHEDULED]: {\n      bg: 'bg-green-500',\n      bgLight: 'green-50',\n      text: 'text-green-700',\n      border: 'green-400',\n      ring: 'green-500'\n    },\n    [OpportunityStage.CLOSED_WON]: {\n      bg: 'bg-emerald-500',\n      bgLight: 'emerald-50',\n      text: 'text-emerald-700',\n      border: 'emerald-400',\n      ring: 'emerald-500'\n    }\n  }\n  \n  return colorMap[stage] || colorMap[OpportunityStage.NEW_LEAD]\n}\n\nconst getDefaultProbability = (stage: OpportunityStage): number => {\n  return STAGE_DEFAULT_PROBABILITY[stage] || 0\n}\n\nconst getStageProgress = (stage: OpportunityStage): number => {\n  const stageOrder = [\n    OpportunityStage.NEW_LEAD,\n    OpportunityStage.INITIAL_OUTREACH,\n    OpportunityStage.SAMPLE_VISIT_OFFERED,\n    OpportunityStage.AWAITING_RESPONSE,\n    OpportunityStage.FEEDBACK_LOGGED,\n    OpportunityStage.DEMO_SCHEDULED,\n    OpportunityStage.CLOSED_WON\n  ]\n  \n  const currentIndex = stageOrder.indexOf(stage)\n  if (currentIndex === -1) return 0\n  \n  return Math.round(((currentIndex + 1) / stageOrder.length) * 100)\n}\n\n/**\n * Event handlers\n */\nconst handleChange = (event: Event) => {\n  const target = event.target as HTMLSelectElement\n  const value = target.value as OpportunityStage | ''\n  \n  emit('update:modelValue', value)\n  emit('change', event)\n  \n  // Emit stage-specific event with probability\n  if (value && value !== '' as OpportunityStage) {\n    const probability = getDefaultProbability(value as OpportunityStage)\n    emit('stage-changed', value as OpportunityStage, probability)\n  }\n}\n\nconst handleBlur = (event: FocusEvent) => {\n  isFocused.value = false\n  emit('blur', event)\n}\n\nconst handleFocus = (event: FocusEvent) => {\n  isFocused.value = true\n  emit('focus', event)\n}\n\n/**\n * Public methods for parent component interaction\n */\ndefineExpose({\n  focus: () => {\n    const select = document.getElementById(fieldId.value) as HTMLSelectElement\n    select?.focus()\n  },\n  blur: () => {\n    const select = document.getElementById(fieldId.value) as HTMLSelectElement\n    select?.blur()\n  },\n  getStageInfo: (stage: OpportunityStage) => ({\n    label: getStageLabel(stage),\n    colors: getStageColorClasses(stage),\n    probability: getDefaultProbability(stage),\n    progress: getStageProgress(stage)\n  })\n})\n</script>","<template>\n  <div class=\"opportunity-form-wrapper\">\n    <!-- Form Progress Indicator -->\n    <div class=\"mb-8\">\n      <div class=\"flex items-center justify-between\">\n        <div class=\"flex items-center space-x-4\">\n          <h2 class=\"text-xl font-semibold text-gray-900\">\n            {{ isEditing ? 'Edit Opportunity' : 'Create New Opportunity' }}\n          </h2>\n          <div v-if=\"!isEditing\" class=\"text-sm text-gray-500\">\n            Step {{ currentStep }} of {{ totalSteps }}\n          </div>\n        </div>\n        \n        <!-- Batch Indicator -->\n        <div v-if=\"formData.selectedPrincipals.length > 1\" class=\"flex items-center space-x-2 bg-blue-50 px-3 py-1 rounded-full\">\n          <svg class=\"h-4 w-4 text-blue-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n          </svg>\n          <span class=\"text-sm font-medium text-blue-700\">\n            Batch Creation ({{ formData.selectedPrincipals.length }} opportunities)\n          </span>\n        </div>\n      </div>\n      \n      <!-- Progress Bar (only for creation) -->\n      <div v-if=\"!isEditing\" class=\"mt-4\">\n        <div class=\"flex items-center\">\n          <div\n            v-for=\"step in totalSteps\"\n            :key=\"step\"\n            class=\"flex items-center\"\n          >\n            <!-- Step Circle -->\n            <div\n              :class=\"[\n                'flex items-center justify-center w-8 h-8 rounded-full border-2 text-sm font-medium',\n                step < currentStep \n                  ? 'bg-primary-600 border-primary-600 text-white' \n                  : step === currentStep\n                    ? 'bg-white border-primary-600 text-primary-600'\n                    : 'bg-white border-gray-300 text-gray-400'\n              ]\"\n            >\n              <svg v-if=\"step < currentStep\" class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" />\n              </svg>\n              <span v-else>{{ step }}</span>\n            </div>\n            \n            <!-- Step Connector -->\n            <div\n              v-if=\"step < totalSteps\"\n              :class=\"[\n                'w-16 h-0.5 mx-2',\n                step < currentStep ? 'bg-primary-600' : 'bg-gray-300'\n              ]\"\n            />\n          </div>\n        </div>\n        \n        <!-- Step Labels -->\n        <div class=\"flex mt-2\">\n          <div\n            v-for=\"(stepInfo, index) in stepLabels\"\n            :key=\"index\"\n            class=\"flex-1 text-center\"\n          >\n            <div\n              :class=\"[\n                'text-xs font-medium',\n                (index + 1) <= currentStep ? 'text-primary-600' : 'text-gray-400'\n              ]\"\n            >\n              {{ stepInfo.label }}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Form Content -->\n    <form @submit.prevent=\"handleSubmit\" class=\"space-y-8\">\n      <!-- Step 1: Basic Information -->\n      <div v-if=\"currentStep === 1 || isEditing\" class=\"step-section\">\n        <div class=\"bg-white rounded-lg border border-gray-200 shadow-sm p-6\">\n          <h3 class=\"text-lg font-medium text-gray-900 mb-6\">\n            <span class=\"flex items-center space-x-2\">\n              <span class=\"w-2 h-2 bg-primary-500 rounded-full\"></span>\n              <span>Basic Information</span>\n            </span>\n          </h3>\n          \n          <div class=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n            <!-- Organization Name -->\n            <div class=\"lg:col-span-2\">\n              <label for=\"organization-name\" class=\"block text-sm font-medium text-gray-700 mb-1\">\n                Organization Name\n                <span class=\"text-red-500 ml-1\">*</span>\n              </label>\n              <input\n                id=\"organization-name\"\n                v-model=\"formData.organizationName\"\n                type=\"text\"\n                required\n                placeholder=\"Enter organization name...\"\n                :class=\"inputClasses\"\n                :aria-invalid=\"!!validationErrors.organizationName\"\n                :aria-describedby=\"validationErrors.organizationName ? 'org-name-error' : undefined\"\n              />\n              <p\n                v-if=\"validationErrors.organizationName\"\n                id=\"org-name-error\"\n                class=\"mt-1 text-sm text-red-600\"\n              >\n                {{ validationErrors.organizationName }}\n              </p>\n            </div>\n\n            <!-- Context Selection -->\n            <div>\n              <label for=\"context\" class=\"block text-sm font-medium text-gray-700 mb-1\">\n                Opportunity Context\n              </label>\n              <select\n                id=\"context\"\n                v-model=\"formData.context\"\n                :class=\"selectClasses\"\n              >\n                <option value=\"\">Select context...</option>\n                <option value=\"EVENT\">Event/Trade Show</option>\n                <option value=\"REFERRAL\">Referral</option>\n                <option value=\"WEBSITE\">Website Inquiry</option>\n                <option value=\"COLD_OUTREACH\">Cold Outreach</option>\n                <option value=\"FOLLOW_UP\">Follow-up</option>\n                <option value=\"CUSTOM\">Custom</option>\n              </select>\n            </div>\n\n            <!-- Custom Context -->\n            <div v-if=\"formData.context === OpportunityContextRef.CUSTOM\">\n              <label for=\"custom-context\" class=\"block text-sm font-medium text-gray-700 mb-1\">\n                Custom Context\n              </label>\n              <input\n                id=\"custom-context\"\n                v-model=\"formData.customContext\"\n                type=\"text\"\n                placeholder=\"Describe the context...\"\n                :class=\"inputClasses\"\n              />\n            </div>\n\n            <!-- Opportunity Name Field -->\n            <div class=\"lg:col-span-2\">\n              <OpportunityNameField\n                name=\"opportunity-name\"\n                label=\"Opportunity Name\"\n                v-model=\"formData.opportunityName\"\n                v-model:auto-generate=\"formData.autoGenerateName\"\n                :organization-name=\"formData.organizationName\"\n                :principal-name=\"getSinglePrincipalName()\"\n                :principal-data=\"getBatchPrincipalData()\"\n                :context=\"formData.context\"\n                :custom-context=\"formData.customContext\"\n                :error=\"validationErrors.opportunityName\"\n                :required=\"true\"\n                @name-generated=\"handleNameGenerated\"\n                @batch-names-generated=\"handleBatchNamesGenerated\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Step 2: Principal Selection -->\n      <div v-if=\"currentStep === 2 || isEditing\" class=\"step-section\">\n        <div class=\"bg-white rounded-lg border border-gray-200 shadow-sm p-6\">\n          <h3 class=\"text-lg font-medium text-gray-900 mb-6\">\n            <span class=\"flex items-center space-x-2\">\n              <span class=\"w-2 h-2 bg-primary-500 rounded-full\"></span>\n              <span>Principal Selection</span>\n            </span>\n          </h3>\n          \n          <div class=\"space-y-6\">\n            <!-- Principal Multi-Select -->\n            <PrincipalMultiSelect\n              name=\"principals\"\n              label=\"Select Principals\"\n              v-model=\"formData.selectedPrincipals\"\n              :error=\"validationErrors.selectedPrincipals\"\n              :required=\"true\"\n              :show-batch-preview=\"true\"\n              :base-opportunity-name=\"formData.opportunityName\"\n              description=\"Choose one or more principals for this opportunity. Multiple selections will create separate opportunities for each principal.\"\n              @selection-changed=\"handlePrincipalSelectionChanged\"\n            />\n          </div>\n        </div>\n      </div>\n\n      <!-- Step 3: Product & Details -->\n      <div v-if=\"currentStep === 3 || isEditing\" class=\"step-section\">\n        <div class=\"bg-white rounded-lg border border-gray-200 shadow-sm p-6\">\n          <h3 class=\"text-lg font-medium text-gray-900 mb-6\">\n            <span class=\"flex items-center space-x-2\">\n              <span class=\"w-2 h-2 bg-primary-500 rounded-full\"></span>\n              <span>Product & Details</span>\n            </span>\n          </h3>\n          \n          <div class=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n            <!-- Product Selection -->\n            <div class=\"lg:col-span-2\">\n              <ProductSelect\n                name=\"product\"\n                label=\"Product\"\n                v-model=\"formData.selectedProduct\"\n                :selected-principals=\"formData.selectedPrincipals\"\n                :error=\"validationErrors.selectedProduct\"\n                :required=\"true\"\n                @product-selected=\"handleProductSelected\"\n              />\n            </div>\n\n            <!-- Stage Selection -->\n            <div>\n              <StageSelect\n                name=\"stage\"\n                label=\"Opportunity Stage\"\n                v-model=\"formData.stage\"\n                :error=\"validationErrors.stage\"\n                :required=\"true\"\n                @stage-changed=\"handleStageChanged\"\n              />\n            </div>\n\n            <!-- Probability -->\n            <div>\n              <label for=\"probability\" class=\"block text-sm font-medium text-gray-700 mb-1\">\n                Success Probability (%)\n              </label>\n              <div class=\"relative\">\n                <input\n                  id=\"probability\"\n                  v-model.number=\"formData.probabilityPercent\"\n                  type=\"number\"\n                  min=\"0\"\n                  max=\"100\"\n                  step=\"5\"\n                  placeholder=\"0\"\n                  :class=\"inputClasses\"\n                />\n                <div class=\"absolute inset-y-0 right-0 flex items-center pr-3\">\n                  <span class=\"text-gray-500 text-sm\">%</span>\n                </div>\n              </div>\n              <p class=\"mt-1 text-xs text-gray-500\">\n                Auto-populated based on stage, but can be customized\n              </p>\n            </div>\n\n            <!-- Expected Close Date -->\n            <div>\n              <label for=\"close-date\" class=\"block text-sm font-medium text-gray-700 mb-1\">\n                Expected Close Date\n              </label>\n              <input\n                id=\"close-date\"\n                v-model=\"formData.expectedCloseDate\"\n                type=\"date\"\n                :min=\"minCloseDate\"\n                :class=\"inputClasses\"\n              />\n            </div>\n\n            <!-- Deal Owner -->\n            <div>\n              <label for=\"deal-owner\" class=\"block text-sm font-medium text-gray-700 mb-1\">\n                Deal Owner\n              </label>\n              <input\n                id=\"deal-owner\"\n                v-model=\"formData.dealOwner\"\n                type=\"text\"\n                placeholder=\"Enter deal owner name...\"\n                :class=\"inputClasses\"\n              />\n            </div>\n\n            <!-- Notes -->\n            <div class=\"lg:col-span-2\">\n              <label for=\"notes\" class=\"block text-sm font-medium text-gray-700 mb-1\">\n                Notes\n              </label>\n              <textarea\n                id=\"notes\"\n                v-model=\"formData.notes\"\n                rows=\"4\"\n                placeholder=\"Add any additional notes about this opportunity...\"\n                :class=\"textareaClasses\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Error Summary -->\n      <div v-if=\"submitError\" class=\"bg-red-50 border border-red-200 rounded-md p-4\">\n        <div class=\"flex\">\n          <svg class=\"h-5 w-5 text-red-400 mr-3 mt-0.5 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n          </svg>\n          <div>\n            <h3 class=\"text-sm font-medium text-red-800\">Error submitting form</h3>\n            <p class=\"mt-1 text-sm text-red-700\">{{ submitError }}</p>\n          </div>\n        </div>\n      </div>\n\n      <!-- Form Actions -->\n      <div class=\"bg-gray-50 rounded-lg p-6\">\n        <div class=\"flex items-center justify-between\">\n          <!-- Left Side Actions -->\n          <div class=\"flex items-center space-x-3\">\n            <button\n              v-if=\"!isEditing && currentStep > 1\"\n              type=\"button\"\n              @click=\"previousStep\"\n              class=\"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n            >\n              <svg class=\"-ml-1 mr-2 h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 19l-7-7 7-7\" />\n              </svg>\n              Previous\n            </button>\n            \n            <button\n              type=\"button\"\n              @click=\"handleCancel\"\n              class=\"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n            >\n              Cancel\n            </button>\n          </div>\n\n          <!-- Right Side Actions -->\n          <div class=\"flex items-center space-x-3\">\n            <!-- Save Draft (creation only) -->\n            <button\n              v-if=\"!isEditing\"\n              type=\"button\"\n              @click=\"saveDraft\"\n              :disabled=\"isSaving\"\n              class=\"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50\"\n            >\n              <svg class=\"-ml-1 mr-2 h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12\" />\n              </svg>\n              {{ isSaving ? 'Saving...' : 'Save Draft' }}\n            </button>\n\n            <!-- Next/Submit Button -->\n            <button\n              v-if=\"!isEditing && currentStep < totalSteps\"\n              type=\"button\"\n              @click=\"nextStep\"\n              :disabled=\"!canProceedToNext\"\n              class=\"inline-flex items-center px-6 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              Next\n              <svg class=\"ml-2 -mr-1 h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 5l7 7-7 7\" />\n              </svg>\n            </button>\n\n            <button\n              v-else\n              type=\"submit\"\n              :disabled=\"isSubmitting || !isFormValid\"\n              class=\"inline-flex items-center px-6 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              <svg v-if=\"isSubmitting\" class=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\" fill=\"none\" viewBox=\"0 0 24 24\">\n                <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\n                <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n              </svg>\n              {{ isSubmitting ? 'Creating...' : isEditing ? 'Update Opportunity' : getSubmitButtonText() }}\n            </button>\n          </div>\n        </div>\n      </div>\n    </form>\n  </div>\n</template>\n\n<!--\n  OpportunityFormWrapper - Comprehensive opportunity creation and editing form\n  \n  Features:\n  - Multi-step wizard for new opportunity creation (3 steps)\n  - Single-page editing mode for existing opportunities\n  - Auto-naming with manual override capability\n  - Batch creation for multiple principals\n  - Real-time validation with accessible error handling\n  - Auto-save functionality with draft recovery\n  - Contextual creation from contacts/organizations\n  - Responsive design optimized for iPad\n  - WCAG 2.1 AA accessibility compliance\n  \n  Form Steps:\n  1. Organization & Context - Select organization and opportunity context\n  2. Principals & Naming - Choose principals and configure naming\n  3. Product & Details - Select product, stage, probability, and notes\n  \n  Batch Creation:\n  - Supports creating multiple opportunities for different principals\n  - Shows name previews for each principal\n  - Handles batch submission with progress feedback\n-->\n\n<script setup lang=\"ts\">\nimport { ref, reactive, computed, watch, onMounted } from 'vue'\nimport { useOpportunityStore } from '@/stores/opportunityStore'\nimport OpportunityNameField from './OpportunityNameField.vue'\nimport PrincipalMultiSelect from './PrincipalMultiSelect.vue'\nimport ProductSelect from './ProductSelect.vue'\nimport StageSelect from './StageSelect.vue'\nimport type { \n  OpportunityStage,\n  OpportunityNamePreview \n} from '@/types/opportunities'\nimport { OpportunityContext } from '@/types/opportunities'\nimport type { \n  OpportunityFormWrapperData\n} from '@/types/opportunityForm'\nimport type { PrincipalOption } from '@/stores/principalStore'\n\n/**\n * Props interface for OpportunityFormWrapper\n */\ninterface Props {\n  /** Whether this is an edit form */\n  isEditing?: boolean\n  /** Initial data for editing or context from other pages */\n  initialData?: Partial<OpportunityFormWrapperData>\n  /** Auto-save interval in milliseconds */\n  autoSaveInterval?: number\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  isEditing: false,\n  autoSaveInterval: 30000 // 30 seconds\n})\n\n/**\n * Component emits\n */\ninterface Emits {\n  /** Emitted when form is successfully submitted */\n  success: [data: { opportunityId?: string; opportunityIds?: string[]; count?: number }]\n  /** Emitted when form is cancelled */\n  cancel: []\n  /** Emitted when form submission error occurs */\n  error: [error: string | Error]\n  /** Emitted when draft is saved */\n  draftSaved: [formData: OpportunityFormWrapperData]\n  /** Emitted when form data changes */\n  dataChanged: [formData: OpportunityFormWrapperData]\n}\n\nconst emit = defineEmits<Emits>()\n\n// Dependencies\nconst opportunityStore = useOpportunityStore()\n\n// Expose enums to template\nconst OpportunityContextRef = OpportunityContext\n\n// ===============================\n// FORM STATE MANAGEMENT\n// ===============================\n\nconst currentStep = ref(1)\nconst totalSteps = 3\nconst isSubmitting = ref(false)\nconst isSaving = ref(false)\nconst submitError = ref<string | null>(null)\nconst batchNamePreviews = ref<OpportunityNamePreview[]>([])\n\nconst stepLabels = [\n  { label: 'Basic Info', key: 'basic' },\n  { label: 'Principals', key: 'principals' },\n  { label: 'Details', key: 'details' }\n]\n\n// Form data reactive object\nconst formData = reactive<OpportunityFormWrapperData>({\n  // Basic Info\n  organizationName: '',\n  opportunityName: '',\n  autoGenerateName: true,\n  context: null,\n  customContext: '',\n  \n  // Principal Selection\n  selectedPrincipals: [],\n  \n  // Product & Details\n  selectedProduct: '',\n  stage: '' as OpportunityStage,\n  probabilityPercent: null,\n  expectedCloseDate: null,\n  dealOwner: '',\n  notes: ''\n})\n\n// Validation errors\nconst validationErrors = ref<Record<string, string>>({})\n\n// ===============================\n// COMPUTED PROPERTIES\n// ===============================\n\nconst inputClasses = computed(() => \n  'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-colors duration-200'\n)\n\nconst selectClasses = computed(() => \n  'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-colors duration-200'\n)\n\nconst textareaClasses = computed(() => \n  'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-colors duration-200 resize-vertical'\n)\n\nconst minCloseDate = computed(() => {\n  const today = new Date()\n  return today.toISOString().split('T')[0]\n})\n\nconst canProceedToNext = computed(() => {\n  switch (currentStep.value) {\n    case 1:\n      return !!(formData.organizationName && formData.opportunityName)\n    case 2:\n      return formData.selectedPrincipals.length > 0\n    case 3:\n      return !!(formData.selectedProduct && formData.stage)\n    default:\n      return false\n  }\n})\n\nconst isFormValid = computed(() => {\n  return !!(\n    formData.organizationName &&\n    formData.opportunityName &&\n    formData.selectedPrincipals.length > 0 &&\n    formData.selectedProduct &&\n    formData.stage\n  )\n})\n\nconst getSubmitButtonText = () => {\n  if (formData.selectedPrincipals.length > 1) {\n    return `Create ${formData.selectedPrincipals.length} Opportunities`\n  }\n  return 'Create Opportunity'\n}\n\n// ===============================\n// UTILITY FUNCTIONS\n// ===============================\n\n/**\n * Transform wrapper form data to API form data format\n */\nconst transformToApiFormat = (): any => {\n  return {\n    name: formData.opportunityName,\n    organization_id: 'temp-id', // This would need to be resolved from organizationName\n    stage: formData.stage,\n    principal_ids: formData.selectedPrincipals,\n    product_id: formData.selectedProduct,\n    context: formData.context,\n    probability_percent: formData.probabilityPercent,\n    expected_close_date: formData.expectedCloseDate,\n    deal_owner: formData.dealOwner,\n    notes: formData.notes,\n    auto_generate_name: formData.autoGenerateName,\n    name_template: null // This could be set based on auto-generation\n  }\n}\n\nconst getSinglePrincipalName = (): string | undefined => {\n  if (formData.selectedPrincipals.length === 1) {\n    // Get principal name from store - this would need to be implemented\n    return formData.selectedPrincipals[0] // Placeholder\n  }\n  return undefined\n}\n\nconst getBatchPrincipalData = () => {\n  if (formData.selectedPrincipals.length > 1) {\n    // Convert principal IDs to principal data - this would need store integration\n    return formData.selectedPrincipals.map(id => ({ id, name: id })) // Placeholder\n  }\n  return undefined\n}\n\n// ===============================\n// FORM VALIDATION\n// ===============================\n\nconst validateCurrentStep = (): boolean => {\n  const errors: Record<string, string> = {}\n  \n  // Step 1 validation\n  if (currentStep.value >= 1) {\n    if (!formData.organizationName.trim()) {\n      errors.organizationName = 'Organization name is required'\n    }\n    \n    if (!formData.opportunityName.trim()) {\n      errors.opportunityName = 'Opportunity name is required'\n    }\n  }\n  \n  // Step 2 validation\n  if (currentStep.value >= 2) {\n    if (formData.selectedPrincipals.length === 0) {\n      errors.selectedPrincipals = 'At least one principal must be selected'\n    }\n  }\n  \n  // Step 3 validation\n  if (currentStep.value >= 3) {\n    if (!formData.selectedProduct) {\n      errors.selectedProduct = 'Product selection is required'\n    }\n    \n    if (!formData.stage) {\n      errors.stage = 'Stage selection is required'\n    }\n  }\n  \n  validationErrors.value = errors\n  return Object.keys(errors).length === 0\n}\n\nconst validateForm = (): boolean => {\n  const tempStep = currentStep.value\n  currentStep.value = totalSteps // Validate all steps\n  const isValid = validateCurrentStep()\n  currentStep.value = tempStep\n  return isValid\n}\n\n// ===============================\n// STEP NAVIGATION\n// ===============================\n\nconst nextStep = () => {\n  if (validateCurrentStep() && currentStep.value < totalSteps) {\n    currentStep.value++\n  }\n}\n\nconst previousStep = () => {\n  if (currentStep.value > 1) {\n    currentStep.value--\n  }\n}\n\n// ===============================\n// EVENT HANDLERS\n// ===============================\n\nconst handleNameGenerated = (name: string, template: string) => {\n  console.log('Name generated:', name, template)\n}\n\nconst handleBatchNamesGenerated = (previews: OpportunityNamePreview[]) => {\n  batchNamePreviews.value = previews\n}\n\nconst handlePrincipalSelectionChanged = (selectedIds: string[], selectedPrincipals: PrincipalOption[]) => {\n  console.log('Principal selection changed:', selectedIds, selectedPrincipals)\n}\n\nconst handleProductSelected = (productId: string, product: any) => {\n  console.log('Product selected:', productId, product)\n}\n\nconst handleStageChanged = (_stage: OpportunityStage, probability: number) => {\n  formData.probabilityPercent = probability\n}\n\nconst handleSubmit = async () => {\n  if (!validateForm()) {\n    return\n  }\n  \n  isSubmitting.value = true\n  submitError.value = null\n  \n  try {\n    if (props.isEditing) {\n      // Handle update logic\n      const apiData = transformToApiFormat()\n      const success = await opportunityStore.updateOpportunity('', apiData)\n      if (success) {\n        emit('success', { opportunityId: 'updated' })\n      } else {\n        const error = opportunityStore.error || 'Failed to update opportunity'\n        submitError.value = error\n        emit('error', error)\n      }\n    } else {\n      // Handle batch creation\n      if (formData.selectedPrincipals.length > 1) {\n        const apiData = transformToApiFormat()\n        const success = await opportunityStore.createBatchOpportunities(apiData)\n        if (success && opportunityStore.batchCreationResult) {\n          emit('success', {\n            opportunityIds: opportunityStore.batchCreationResult.created_opportunities.map(o => o.id),\n            count: opportunityStore.batchCreationResult.total_created\n          })\n        } else {\n          const error = opportunityStore.error || 'Failed to create opportunities'\n          submitError.value = error\n          emit('error', error)\n        }\n      } else {\n        // Single opportunity creation\n        const apiData = transformToApiFormat()\n        const success = await opportunityStore.createOpportunity(apiData)\n        if (success) {\n          // Assuming the store sets a currentOpportunity or returns an ID\n          emit('success', { opportunityId: 'created' }) // This would need to be the actual ID\n        } else {\n          const error = opportunityStore.error || 'Failed to create opportunity'\n          submitError.value = error\n          emit('error', error)\n        }\n      }\n    }\n  } catch (error) {\n    console.error('Form submission error:', error)\n    const errorMessage = error instanceof Error ? error.message : 'An unexpected error occurred'\n    submitError.value = errorMessage\n    emit('error', errorMessage)\n  } finally {\n    isSubmitting.value = false\n  }\n}\n\nconst handleCancel = () => {\n  emit('cancel')\n}\n\nconst saveDraft = async () => {\n  isSaving.value = true\n  \n  try {\n    // Here you would implement draft saving logic\n    // For now, just emit the event\n    emit('draftSaved', { ...formData })\n    \n    // Show success feedback\n    setTimeout(() => {\n      isSaving.value = false\n    }, 500)\n  } catch (error) {\n    console.error('Draft save error:', error)\n    isSaving.value = false\n  }\n}\n\n// ===============================\n// LIFECYCLE & INITIALIZATION\n// ===============================\n\nconst initializeForm = () => {\n  if (props.initialData) {\n    // Merge initial data with form data, preserving existing values\n    Object.assign(formData, props.initialData)\n    \n    // If organizationName is provided but opportunityName is not set and auto-generate is enabled,\n    // the OpportunityNameField component will handle auto-generation\n    if (props.initialData.organizationName && formData.autoGenerateName) {\n      // The name field component will auto-generate based on organization name\n      console.log('Form initialized with organization:', props.initialData.organizationName)\n    }\n  }\n  \n  if (props.isEditing) {\n    // For editing, show all steps at once\n    currentStep.value = totalSteps\n  }\n}\n\n// Watch for form data changes\nwatch(\n  () => ({ ...formData }),\n  (newData) => {\n    emit('dataChanged', newData)\n  },\n  { deep: true }\n)\n\n// Auto-save functionality (for creation only)\nlet autoSaveTimer: ReturnType<typeof setInterval>\n\nconst startAutoSave = () => {\n  if (!props.isEditing && props.autoSaveInterval > 0) {\n    autoSaveTimer = setInterval(() => {\n      if (isFormValid.value) {\n        saveDraft()\n      }\n    }, props.autoSaveInterval)\n  }\n}\n\nconst stopAutoSave = () => {\n  if (autoSaveTimer) {\n    clearInterval(autoSaveTimer)\n  }\n}\n\nonMounted(() => {\n  initializeForm()\n  startAutoSave()\n})\n\n// Cleanup on unmount\nimport { onUnmounted } from 'vue'\nonUnmounted(() => {\n  stopAutoSave()\n})\n\n/**\n * Public methods for parent components\n */\ndefineExpose({\n  validateForm,\n  resetForm: () => {\n    Object.assign(formData, {\n      organizationName: '',\n      opportunityName: '',\n      autoGenerateName: true,\n      context: null,\n      customContext: '',\n      selectedPrincipals: [],\n      selectedProduct: '',\n      stage: '' as OpportunityStage,\n      probabilityPercent: null,\n      expectedCloseDate: null,\n      dealOwner: '',\n      notes: ''\n    })\n    currentStep.value = 1\n    validationErrors.value = {}\n    submitError.value = null\n  },\n  goToStep: (step: number) => {\n    if (step >= 1 && step <= totalSteps) {\n      currentStep.value = step\n    }\n  },\n  getFormData: (): OpportunityFormWrapperData => ({ ...formData })\n})\n</script>\n\n<style scoped>\n.opportunity-form-wrapper {\n  @apply max-w-4xl mx-auto;\n}\n\n.step-section {\n  @apply transition-all duration-300;\n}\n\n/* Step transition animations */\n.step-section:not(.active) {\n  @apply opacity-60;\n}\n\n/* Form focus styles */\n.form-input:focus,\n.form-select:focus,\n.form-textarea:focus {\n  @apply ring-2 ring-primary-500 border-primary-500;\n}\n\n/* Progress indicator styles */\n.progress-step {\n  @apply transition-all duration-200;\n}\n\n/* Responsive adjustments */\n@media (max-width: 768px) {\n  .opportunity-form-wrapper {\n    @apply max-w-full mx-4;\n  }\n  \n  .step-section .grid {\n    @apply grid-cols-1;\n  }\n}\n\n/* Print styles */\n@media print {\n  .opportunity-form-wrapper {\n    @apply shadow-none;\n  }\n  \n  .form-actions {\n    @apply hidden;\n  }\n}\n</style>"],"names":["props","__props","emit","__emit","isFocused","ref","showManualOverride","manualOverride","previewName","nameTemplate","previewNames","fieldId","computed","errorId","descriptionId","helpTextId","hasError","ariaDescribedBy","ids","labelClasses","base","stateClasses","disabledClasses","customClasses","inputClasses","paddingClasses","overrideInputClasses","generatePreviewName","generated","opportunityNaming","template","previews","handleAutoGenerateToggle","event","enabled","handleManualInput","target","handleOverrideInput","handleBlur","handleFocus","handleOverrideBlur","_event","enableManualOverride","nextTick","overrideInput","disableManualOverride","watch","__expose","input","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","label","required","_hoisted_3","description","_hoisted_4","_hoisted_5","_hoisted_6","autoGenerate","_cache","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_toDisplayString","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_Fragment","maxPreviewDisplay","preview","_hoisted_19","_hoisted_20","name","placeholder","disabled","maxlength","modelValue","showCharacterCount","_hoisted_22","_hoisted_23","_hoisted_24","error","helpText","_hoisted_27","principalStore","usePrincipalStore","isOpen","searchTerm","searchInput","containerClasses","dropdownClasses","optionClasses","principalId","isSelected","filteredPrincipals","search","principal","getPrincipalName","p","generateOpportunityName","toggleSelection","newSelection","index","emitSelectionChanged","removePrincipal","id","clearSelection","selectAll","allIds","selectedIds","selectedPrincipals","toggleDropdown","_a","closeDropdown","handleClickOutside","container","onMounted","onUnmounted","newValue","_renderList","_hoisted_7","_withModifiers","$event","_normalizeClass","_hoisted_21","showBatchPreview","_hoisted_25","_hoisted_26","_hoisted_28","_hoisted_29","_hoisted_31","productStore","useProductStore","isFiltering","selectClasses","availableProducts","selectedProduct","productCategories","categories","product","category","products","a","b","filterProducts","handleChange","value","newPrincipals","oldPrincipals","select","showPrincipalContext","showProductDetails","_createTextVNode","showProductInfo","showProductCount","stageOptions","OpportunityStage","stageColors","getStageColorClasses","getStageLabel","stage","option","opt","colorMap","getDefaultProbability","STAGE_DEFAULT_PROBABILITY","getStageProgress","stageOrder","currentIndex","probability","showStageIndicator","showProgressBar","_normalizeStyle","totalSteps","opportunityStore","useOpportunityStore","OpportunityContextRef","OpportunityContext","currentStep","isSubmitting","isSaving","submitError","batchNamePreviews","stepLabels","formData","reactive","validationErrors","textareaClasses","minCloseDate","canProceedToNext","isFormValid","getSubmitButtonText","transformToApiFormat","getSinglePrincipalName","getBatchPrincipalData","validateCurrentStep","errors","validateForm","tempStep","isValid","nextStep","previousStep","handleNameGenerated","handleBatchNamesGenerated","handlePrincipalSelectionChanged","handleProductSelected","productId","handleStageChanged","_stage","handleSubmit","apiData","o","errorMessage","handleCancel","saveDraft","initializeForm","newData","autoSaveTimer","startAutoSave","stopAutoSave","step","_hoisted_2","isEditing","stepInfo","_vModelText","_vModelSelect","_unref","_createVNode","OpportunityNameField","PrincipalMultiSelect","ProductSelect","StageSelect","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_42"],"mappings":"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"}