import{d as $,z as D,r as y,y as S,o as E,c as _,b as r,e as V,t as z,f as d,w as l,g as O,u as R,i as x,k,p as m,v as p,n as f,x as H}from"./index-D8k4VyC4.js";import{c as j}from"./contactsApi-ChBBbGm0.js";import{C as U}from"./contacts-DKKVhn3H.js";import{a as q,_ as b}from"./FormGroup.vue_vue_type_script_setup_true_lang-DnvfU1PI.js";import"./supabaseClient-BMAhow10.js";const I={class:"min-h-screen bg-gray-50 py-8"},J={class:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8"},L={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},P={key:1,class:"bg-white rounded-lg shadow-sm border border-danger p-6"},G={class:"flex items-center mb-4"},K={class:"text-red-700"},Q={class:"flex space-x-3"},W={key:2},X={class:"mb-8"},Y={class:"flex items-center space-x-3 mb-4"},Z={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},ee={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},re=["id","aria-describedby","aria-invalid"],te=["id","aria-describedby","aria-invalid"],ae=["id","aria-describedby","aria-invalid"],oe=["id","aria-describedby","aria-invalid"],ne={class:"md:col-span-2"},ie=["id","aria-describedby","aria-invalid"],se={class:"md:col-span-2"},de=["id","aria-describedby","aria-invalid"],le={class:"md:col-span-2"},ue=["id","aria-describedby","aria-invalid"],ce={key:0,class:"mt-6 p-4 border border-danger rounded-md bg-red-50"},me={class:"flex"},pe={class:"mt-1 text-sm text-red-700"},fe={class:"mt-8 flex justify-end space-x-3"},be={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},he=$({__name:"ContactEditView",setup(ge){const B=D(),N=H(),A=B.params.id,g=y(null),C=y(!0),w=y(null),a=S({first_name:"",last_name:"",email:"",phone:"",organization:"",title:"",notes:""}),c=y({}),v=y(null),h=y(!1),M=async()=>{try{C.value=!0,w.value=null;const o=await j.getContact(A);if(o.success&&o.data){g.value=o.data;const e=U.contactToForm(o.data);Object.assign(a,e)}else w.value=o.error||"Contact not found"}catch(o){w.value="An unexpected error occurred",console.error("Error loading contact:",o)}finally{C.value=!1}},F=async()=>{try{const o=await U.validateCreate(a);if(o.isValid)return c.value={},!0;{const e={};return o.errors.forEach(u=>{e[u.field]=u.message}),c.value=e,!1}}catch(o){return console.error("Form validation error:",o),v.value="Form validation failed",!1}},T=async()=>{if(g.value)try{if(h.value=!0,v.value=null,!await F())return;const e=U.formToUpdate(a),u=await j.updateContact(g.value.id,e);u.success&&u.data?N.push(`/contacts/${u.data.id}`):v.value=u.error||"Failed to update contact"}catch(o){console.error("Error updating contact:",o),v.value="An unexpected error occurred"}finally{h.value=!1}};return E(()=>{M()}),(o,e)=>{const u=O("router-link");return x(),_("div",I,[r("div",J,[C.value?(x(),_("div",L,e[7]||(e[7]=[r("div",{class:"flex justify-center"},[r("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})],-1)]))):w.value?(x(),_("div",P,[r("div",G,[e[8]||(e[8]=r("svg",{class:"h-5 w-5 text-danger mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),r("span",K,z(w.value),1)]),r("div",Q,[d(u,{to:"/",class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"},{default:l(()=>e[9]||(e[9]=[k(" Back to Contacts ",-1)])),_:1,__:[9]}),d(q,{onClick:M,variant:"primary"},{default:l(()=>e[10]||(e[10]=[k(" Try Again ",-1)])),_:1,__:[10]})])])):g.value?(x(),_("div",W,[r("div",X,[r("div",Y,[d(u,{to:`/contacts/${g.value.id}`,class:"text-gray-500 hover:text-gray-700"},{default:l(()=>e[11]||(e[11]=[r("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),_:1,__:[11]},8,["to"]),e[12]||(e[12]=r("h1",{class:"text-3xl font-bold text-gray-900"},"Edit Contact",-1))]),e[13]||(e[13]=r("p",{class:"text-gray-600"},"Update contact information",-1))]),r("div",Z,[r("form",{onSubmit:R(T,["prevent"])},[r("div",ee,[d(b,{name:"first_name",label:"First Name",error:c.value.first_name,required:""},{default:l(({fieldId:n,hasError:t,errorId:i})=>[m(r("input",{id:n,"onUpdate:modelValue":e[0]||(e[0]=s=>a.first_name=s),type:"text",required:"",placeholder:"Enter first name","aria-describedby":t?i:void 0,"aria-invalid":t?"true":"false",class:f(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent transition duration-200 border-gray-300 focus:ring-primary",{"border-danger focus:ring-danger":t}])},null,10,re),[[p,a.first_name]])]),_:1},8,["error"]),d(b,{name:"last_name",label:"Last Name",error:c.value.last_name,required:""},{default:l(({fieldId:n,hasError:t,errorId:i})=>[m(r("input",{id:n,"onUpdate:modelValue":e[1]||(e[1]=s=>a.last_name=s),type:"text",required:"",placeholder:"Enter last name","aria-describedby":t?i:void 0,"aria-invalid":t?"true":"false",class:f(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent transition duration-200 border-gray-300 focus:ring-primary",{"border-danger focus:ring-danger":t}])},null,10,te),[[p,a.last_name]])]),_:1},8,["error"]),d(b,{name:"email",label:"Email Address",error:c.value.email,required:""},{default:l(({fieldId:n,hasError:t,errorId:i})=>[m(r("input",{id:n,"onUpdate:modelValue":e[2]||(e[2]=s=>a.email=s),type:"email",required:"",placeholder:"Enter email address","aria-describedby":t?i:void 0,"aria-invalid":t?"true":"false",class:f(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent transition duration-200 border-gray-300 focus:ring-primary",{"border-danger focus:ring-danger":t}])},null,10,ae),[[p,a.email]])]),_:1},8,["error"]),d(b,{name:"phone",label:"Phone Number",error:c.value.phone},{default:l(({fieldId:n,hasError:t,errorId:i})=>[m(r("input",{id:n,"onUpdate:modelValue":e[3]||(e[3]=s=>a.phone=s),type:"tel",placeholder:"Enter phone number","aria-describedby":t?i:void 0,"aria-invalid":t?"true":"false",class:f(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent transition duration-200 border-gray-300 focus:ring-primary",{"border-danger focus:ring-danger":t}])},null,10,oe),[[p,a.phone]])]),_:1},8,["error"]),r("div",ne,[d(b,{name:"organization",label:"Organization",error:c.value.organization,required:""},{default:l(({fieldId:n,hasError:t,errorId:i})=>[m(r("input",{id:n,"onUpdate:modelValue":e[4]||(e[4]=s=>a.organization=s),type:"text",required:"",placeholder:"Enter organization or company name","aria-describedby":t?i:void 0,"aria-invalid":t?"true":"false",class:f(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent transition duration-200 border-gray-300 focus:ring-primary",{"border-danger focus:ring-danger":t}])},null,10,ie),[[p,a.organization]])]),_:1},8,["error"])]),r("div",se,[d(b,{name:"title",label:"Job Title",error:c.value.title},{default:l(({fieldId:n,hasError:t,errorId:i})=>[m(r("input",{id:n,"onUpdate:modelValue":e[5]||(e[5]=s=>a.title=s),type:"text",placeholder:"Enter job title","aria-describedby":t?i:void 0,"aria-invalid":t?"true":"false",class:f(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent transition duration-200 border-gray-300 focus:ring-primary",{"border-danger focus:ring-danger":t}])},null,10,de),[[p,a.title]])]),_:1},8,["error"])]),r("div",le,[d(b,{name:"notes",label:"Notes",error:c.value.notes},{default:l(({fieldId:n,hasError:t,errorId:i})=>[m(r("textarea",{id:n,"onUpdate:modelValue":e[6]||(e[6]=s=>a.notes=s),rows:"4",placeholder:"Add any additional notes about this contact...","aria-describedby":t?i:void 0,"aria-invalid":t?"true":"false",class:f(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent transition duration-200 border-gray-300 focus:ring-primary",{"border-danger focus:ring-danger":t}])},null,10,ue),[[p,a.notes]])]),_:1},8,["error"])])]),v.value?(x(),_("div",ce,[r("div",me,[e[15]||(e[15]=r("svg",{class:"h-5 w-5 text-danger mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),r("div",null,[e[14]||(e[14]=r("h3",{class:"text-sm font-medium text-red-800"},"Error updating contact",-1)),r("p",pe,z(v.value),1)])])])):V("",!0),r("div",fe,[d(u,{to:`/contacts/${g.value.id}`,class:"inline-flex items-center justify-center px-4 py-2 border text-sm font-semibold rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-primary"},{default:l(()=>e[16]||(e[16]=[k(" Cancel ",-1)])),_:1,__:[16]},8,["to"]),d(q,{type:"submit",variant:"primary",disabled:h.value},{default:l(()=>[h.value?(x(),_("svg",be,e[17]||(e[17]=[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):V("",!0),k(" "+z(h.value?"Updating...":"Update Contact"),1)]),_:1},8,["disabled"])])],32)])])):V("",!0)])])}}});export{he as default};
//# sourceMappingURL=ContactEditView-2_IlK8tE.js.map
