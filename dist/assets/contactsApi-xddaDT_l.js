import{s as c}from"./supabaseClient-CpZNRF9L.js";class u{async getContacts(e={}){try{let r=c.from("contact_list_view").select("*");e.search&&(r=r.or(`first_name.ilike.%${e.search}%,last_name.ilike.%${e.search}%,organization_name.ilike.%${e.search}%,email.ilike.%${e.search}%,position.ilike.%${e.search}%`));const t=e.sortBy==="organization"?"organization_name":e.sortBy||"last_name",a=e.sortOrder||"asc";r=r.order(t,{ascending:a==="asc"}),e.limit&&(r=r.limit(e.limit)),e.offset&&(r=r.range(e.offset,e.offset+(e.limit||50)-1));const{data:n,error:o}=await r;return o?(console.error("Error fetching contacts:",o),{data:null,error:`Failed to fetch contacts: ${o.message}`,success:!1}):{data:n||[],error:null,success:!0}}catch(r){return console.error("Unexpected error fetching contacts:",r),{data:null,error:"An unexpected error occurred while fetching contacts",success:!1}}}async getContact(e){try{const{data:r,error:t}=await c.from("contact_detail_view").select("*").eq("id",e).single();return t?(console.error("Error fetching contact:",t),{data:null,error:`Failed to fetch contact: ${t.message}`,success:!1}):{data:r,error:null,success:!0}}catch(r){return console.error("Unexpected error fetching contact:",r),{data:null,error:"An unexpected error occurred while fetching the contact",success:!1}}}async createContact(e){try{const{data:r,error:t}=await c.from("contacts").insert(e).select().single();return t?(console.error("Error creating contact:",t),{data:null,error:`Failed to create contact: ${t.message}`,success:!1}):{data:r,error:null,success:!0}}catch(r){return console.error("Unexpected error creating contact:",r),{data:null,error:"An unexpected error occurred while creating the contact",success:!1}}}async updateContact(e,r){try{const{data:t,error:a}=await c.from("contacts").update(r).eq("id",e).select().single();return a?(console.error("Error updating contact:",a),{data:null,error:`Failed to update contact: ${a.message}`,success:!1}):{data:t,error:null,success:!0}}catch(t){return console.error("Unexpected error updating contact:",t),{data:null,error:"An unexpected error occurred while updating the contact",success:!1}}}async deleteContact(e){try{const{error:r}=await c.from("contacts").delete().eq("id",e);return r?(console.error("Error deleting contact:",r),{data:null,error:`Failed to delete contact: ${r.message}`,success:!1}):{data:!0,error:null,success:!0}}catch(r){return console.error("Unexpected error deleting contact:",r),{data:null,error:"An unexpected error occurred while deleting the contact",success:!1}}}async getContactStats(){try{const{count:e,error:r}=await c.from("contacts").select("*",{count:"exact",head:!0});if(r)throw r;const t=new Date;t.setDate(t.getDate()-30);const{count:a,error:n}=await c.from("contacts").select("*",{count:"exact",head:!0}).gte("created_at",t.toISOString());if(n)throw n;const{data:o,error:s}=await c.from("contacts").select("organization_id").not("organization_id","is",null);if(s)throw s;const l=new Set(o==null?void 0:o.map(i=>i.organization_id)).size;return{data:{total:e||0,recentlyAdded:a||0,organizations:l},error:null,success:!0}}catch(e){return console.error("Error fetching contact stats:",e),{data:null,error:"Failed to fetch contact statistics",success:!1}}}}const h=new u;export{h as c};
//# sourceMappingURL=contactsApi-xddaDT_l.js.map
