import{b as A,A as B,r as g,h as N,p as F,c as a,a as t,f as i,t as u,i as h,l as w,m as T,w as q,q as c,v as m,n as b,j as k,o as n,z as D}from"./index-UnAe-Txj.js";import{c as V,C as _}from"./contacts-B0X_eGT6.js";import"./supabaseClient-CwP9wSpS.js";const S={class:"min-h-screen bg-gray-50 py-8"},$={class:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8"},O={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},R={key:1,class:"bg-white rounded-lg shadow-sm border border-red-200 p-6"},H={class:"flex items-center mb-4"},I={class:"text-red-700"},J={class:"flex space-x-3"},L={key:2},P={class:"mb-8"},G={class:"flex items-center space-x-3 mb-4"},K={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Q={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},W={key:0,class:"mt-1 text-sm text-red-600"},X={key:0,class:"mt-1 text-sm text-red-600"},Y={key:0,class:"mt-1 text-sm text-red-600"},Z={key:0,class:"mt-1 text-sm text-red-600"},ee={class:"md:col-span-2"},te={key:0,class:"mt-1 text-sm text-red-600"},oe={class:"md:col-span-2"},re={key:0,class:"mt-1 text-sm text-red-600"},se={class:"md:col-span-2"},le={key:0,class:"mt-1 text-sm text-red-600"},ae={key:0,class:"mt-6 p-4 border border-red-200 rounded-md bg-red-50"},ne={class:"flex"},de={class:"mt-1 text-sm text-red-700"},ie={class:"mt-8 flex justify-end space-x-3"},ue=["disabled"],ce={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},ge=A({__name:"ContactEditView",setup(me){const z=B(),E=D(),U=z.params.id,p=g(null),y=g(!0),v=g(null),r=N({first_name:"",last_name:"",email:"",phone:"",organization:"",title:"",notes:""}),o=g({}),f=g(null),x=g(!1),C=async()=>{try{y.value=!0,v.value=null;const s=await V.getContact(U);if(s.success&&s.data){p.value=s.data;const e=_.contactToForm(s.data);Object.assign(r,e)}else v.value=s.error||"Contact not found"}catch(s){v.value="An unexpected error occurred",console.error("Error loading contact:",s)}finally{y.value=!1}},M=async()=>{try{const s=await _.validateCreate(r);if(s.isValid)return o.value={},!0;{const e={};return s.errors.forEach(d=>{e[d.field]=d.message}),o.value=e,!1}}catch(s){return console.error("Form validation error:",s),f.value="Form validation failed",!1}},j=async()=>{if(p.value)try{if(x.value=!0,f.value=null,!await M())return;const e=_.formToUpdate(r),d=await V.updateContact(p.value.id,e);d.success&&d.data?E.push(`/contacts/${d.data.id}`):f.value=d.error||"Failed to update contact"}catch(s){console.error("Error updating contact:",s),f.value="An unexpected error occurred"}finally{x.value=!1}};return F(()=>{C()}),(s,e)=>{const d=T("router-link");return n(),a("div",S,[t("div",$,[y.value?(n(),a("div",O,e[7]||(e[7]=[t("div",{class:"flex justify-center"},[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})],-1)]))):v.value?(n(),a("div",R,[t("div",H,[e[8]||(e[8]=t("svg",{class:"h-5 w-5 text-red-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",I,u(v.value),1)]),t("div",J,[h(d,{to:"/contacts",class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"},{default:w(()=>e[9]||(e[9]=[k(" Back to Contacts ",-1)])),_:1,__:[9]}),t("button",{onClick:C,class:"px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700"}," Try Again ")])])):p.value?(n(),a("div",L,[t("div",P,[t("div",G,[h(d,{to:`/contacts/${p.value.id}`,class:"text-gray-500 hover:text-gray-700"},{default:w(()=>e[10]||(e[10]=[t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),_:1,__:[10]},8,["to"]),e[11]||(e[11]=t("h1",{class:"text-3xl font-bold text-gray-900"},"Edit Contact",-1))]),e[12]||(e[12]=t("p",{class:"text-gray-600"},"Update contact information",-1))]),t("div",K,[t("form",{onSubmit:q(j,["prevent"])},[t("div",Q,[t("div",null,[e[13]||(e[13]=t("label",{for:"first_name",class:"block text-sm font-medium text-gray-700 mb-2"}," First Name * ",-1)),c(t("input",{id:"first_name","onUpdate:modelValue":e[0]||(e[0]=l=>r.first_name=l),type:"text",required:"",class:b(["block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",{"border-red-300 focus:border-red-500 focus:ring-red-500":o.value.first_name}]),placeholder:"Enter first name"},null,2),[[m,r.first_name]]),o.value.first_name?(n(),a("p",W,u(o.value.first_name),1)):i("",!0)]),t("div",null,[e[14]||(e[14]=t("label",{for:"last_name",class:"block text-sm font-medium text-gray-700 mb-2"}," Last Name * ",-1)),c(t("input",{id:"last_name","onUpdate:modelValue":e[1]||(e[1]=l=>r.last_name=l),type:"text",required:"",class:b(["block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",{"border-red-300 focus:border-red-500 focus:ring-red-500":o.value.last_name}]),placeholder:"Enter last name"},null,2),[[m,r.last_name]]),o.value.last_name?(n(),a("p",X,u(o.value.last_name),1)):i("",!0)]),t("div",null,[e[15]||(e[15]=t("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-2"}," Email Address * ",-1)),c(t("input",{id:"email","onUpdate:modelValue":e[2]||(e[2]=l=>r.email=l),type:"email",required:"",class:b(["block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",{"border-red-300 focus:border-red-500 focus:ring-red-500":o.value.email}]),placeholder:"Enter email address"},null,2),[[m,r.email]]),o.value.email?(n(),a("p",Y,u(o.value.email),1)):i("",!0)]),t("div",null,[e[16]||(e[16]=t("label",{for:"phone",class:"block text-sm font-medium text-gray-700 mb-2"}," Phone Number ",-1)),c(t("input",{id:"phone","onUpdate:modelValue":e[3]||(e[3]=l=>r.phone=l),type:"tel",class:b(["block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",{"border-red-300 focus:border-red-500 focus:ring-red-500":o.value.phone}]),placeholder:"Enter phone number"},null,2),[[m,r.phone]]),o.value.phone?(n(),a("p",Z,u(o.value.phone),1)):i("",!0)]),t("div",ee,[e[17]||(e[17]=t("label",{for:"organization",class:"block text-sm font-medium text-gray-700 mb-2"}," Organization * ",-1)),c(t("input",{id:"organization","onUpdate:modelValue":e[4]||(e[4]=l=>r.organization=l),type:"text",required:"",class:b(["block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",{"border-red-300 focus:border-red-500 focus:ring-red-500":o.value.organization}]),placeholder:"Enter organization or company name"},null,2),[[m,r.organization]]),o.value.organization?(n(),a("p",te,u(o.value.organization),1)):i("",!0)]),t("div",oe,[e[18]||(e[18]=t("label",{for:"title",class:"block text-sm font-medium text-gray-700 mb-2"}," Job Title ",-1)),c(t("input",{id:"title","onUpdate:modelValue":e[5]||(e[5]=l=>r.title=l),type:"text",class:b(["block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",{"border-red-300 focus:border-red-500 focus:ring-red-500":o.value.title}]),placeholder:"Enter job title"},null,2),[[m,r.title]]),o.value.title?(n(),a("p",re,u(o.value.title),1)):i("",!0)]),t("div",se,[e[19]||(e[19]=t("label",{for:"notes",class:"block text-sm font-medium text-gray-700 mb-2"}," Notes ",-1)),c(t("textarea",{id:"notes","onUpdate:modelValue":e[6]||(e[6]=l=>r.notes=l),rows:"4",class:b(["block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",{"border-red-300 focus:border-red-500 focus:ring-red-500":o.value.notes}]),placeholder:"Add any additional notes about this contact..."},null,2),[[m,r.notes]]),o.value.notes?(n(),a("p",le,u(o.value.notes),1)):i("",!0)])]),f.value?(n(),a("div",ae,[t("div",ne,[e[21]||(e[21]=t("svg",{class:"h-5 w-5 text-red-400 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("div",null,[e[20]||(e[20]=t("h3",{class:"text-sm font-medium text-red-800"},"Error updating contact",-1)),t("p",de,u(f.value),1)])])])):i("",!0),t("div",ie,[h(d,{to:`/contacts/${p.value.id}`,class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:w(()=>e[22]||(e[22]=[k(" Cancel ",-1)])),_:1,__:[22]},8,["to"]),t("button",{type:"submit",disabled:x.value,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[x.value?(n(),a("svg",ce,e[23]||(e[23]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):i("",!0),k(" "+u(x.value?"Updating...":"Update Contact"),1)],8,ue)])],32)])])):i("",!0)])])}}});export{ge as default};
//# sourceMappingURL=ContactEditView-Bsqi_pgn.js.map
