import{d as Q,a as c,j as d,A as w,s as _,b as e,h as T,f as A,t as a,e as L,r as y,n as B,F as N,i as F,c as I,o as fe,y as ie,l as O,v as xe,m as D,p as re,w as ye,g as he,q as be,k as we}from"./index-Br7bM97V.js";import{u as _e}from"./principalStore-JxlbTJes.js";import{A as W,E as Y,p as R}from"./EngagementScoreRing-DT1wV0O8.js";import{P as ke}from"./PrincipalSelector-BnLK-7If.js";import{P as $e}from"./PrincipalKPICards-VC-jnROq.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./organizationsApi-ByKMXw3t.js";import"./supabaseClient-CwaY5m9F.js";import"./MagnifyingGlassIcon-BepCswCi.js";import"./XMarkIcon-Bq58FYA6.js";import"./ExclamationTriangleIcon-3AUMR-W2.js";import"./UserGroupIcon-Bll1C4SH.js";import"./CalendarIcon-CBoVSP04.js";import"./BuildingOfficeIcon-CE9ZCi7A.js";import"./CheckIcon-0UoNe-IG.js";import"./TrendIndicator-BEIfMvpj.js";/* empty css                                                                       */import"./StarIcon-BOg-5s6P.js";import"./ClockIcon-_yqAmiAM.js";import"./TrophyIcon-CXbi3cSE.js";/* empty css                                                                          */const Ce=["onKeydown","aria-label"],Me={class:"flex items-start justify-between mb-3"},Se={class:"flex-1 min-w-0"},Le={class:"text-lg font-semibold text-gray-900 truncate"},Te={class:"text-sm text-gray-600 truncate"},Ae={key:0,class:"text-xs text-gray-500 uppercase tracking-wide"},je={class:"flex items-center justify-center mb-4"},ze={class:"grid grid-cols-2 gap-3 mb-4"},Pe={class:"text-center"},Ie={class:"text-lg font-semibold text-gray-900"},Be={class:"text-center"},Ve={class:"text-lg font-semibold text-gray-900"},Ee={class:"text-center"},Oe={class:"text-lg font-semibold text-gray-900"},Ue={class:"text-center"},De={class:"text-lg font-semibold text-gray-900"},Re={key:0,class:"mb-4"},Ne={class:"flex items-center space-x-2 p-2 bg-amber-50 rounded-md border border-amber-200"},Fe={class:"flex-1 min-w-0"},Ke={class:"text-sm font-medium text-amber-800"},He={key:0,class:"text-xs text-amber-700"},qe={class:"grid grid-cols-2 gap-2"},We=["aria-label"],Ye=["aria-label"],Qe=Q({__name:"PrincipalCard",props:{principal:{}},emits:["click","create-opportunity","log-interaction"],setup(K,{emit:j}){const S=K,g=j,v=l=>{if(!l)return"Never";const p=new Date(l),k=Math.abs(new Date().getTime()-p.getTime()),r=Math.floor(k/(1e3*60*60*24));return r===0?"Today":r===1?"1 day ago":r<7?`${r} days ago`:r<30?`${Math.floor(r/7)} weeks ago`:r<365?`${Math.floor(r/30)} months ago`:`${Math.floor(r/365)} years ago`},$=l=>new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),f=l=>{switch(l){case"NO_ACTIVITY":return"NO_ACTIVITY";case"STALE":return"LOW";case"MODERATE":return"MODERATE";case"ACTIVE":return"ACTIVE";default:return"LOW"}},C=()=>{g("click",S.principal)},m=()=>{g("create-opportunity",S.principal)},M=()=>{g("log-interaction",S.principal)};return(l,p)=>(d(),c("div",{class:"principal-card bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-shadow duration-200 cursor-pointer focus-within:ring-2 focus-within:ring-blue-500 focus-within:ring-offset-2",onClick:C,onKeydown:[w(C,["enter"]),w(_(C,["prevent"]),["space"])],role:"button",tabindex:"0","aria-label":`View details for ${l.principal.principal_name}`},[e("div",Me,[e("div",Se,[e("h3",Le,a(l.principal.principal_name),1),e("p",Te,a(l.principal.principal_name),1),l.principal.organization_type?(d(),c("p",Ae,a(l.principal.organization_type),1)):T("",!0)]),A(W,{status:f(l.principal.activity_status),size:"sm",class:"flex-shrink-0"},null,8,["status"])]),e("div",je,[A(Y,{score:l.principal.engagement_score||0,size:"lg"},null,8,["score"])]),e("div",ze,[e("div",Pe,[e("div",Ie,a(l.principal.total_interactions||0),1),p[0]||(p[0]=e("div",{class:"text-xs text-gray-500"},"Interactions",-1))]),e("div",Be,[e("div",Ve,a(l.principal.active_opportunities||0),1),p[1]||(p[1]=e("div",{class:"text-xs text-gray-500"},"Opportunities",-1))]),e("div",Ee,[e("div",Oe,a(l.principal.product_count||0),1),p[2]||(p[2]=e("div",{class:"text-xs text-gray-500"},"Products",-1))]),e("div",Ue,[e("div",De,a(v(l.principal.last_activity_date)),1),p[3]||(p[3]=e("div",{class:"text-xs text-gray-500"},"Last Activity",-1))])]),l.principal.follow_ups_required&&l.principal.follow_ups_required>0?(d(),c("div",Re,[e("div",Ne,[p[4]||(p[4]=e("svg",{class:"h-4 w-4 text-amber-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("div",Fe,[e("p",Ke,a(l.principal.follow_ups_required)+" Follow-up"+a(l.principal.follow_ups_required>1?"s":"")+" Required ",1),l.principal.next_follow_up_date?(d(),c("p",He," Next: "+a($(l.principal.next_follow_up_date)),1)):T("",!0)])])])):T("",!0),e("div",qe,[e("button",{onClick:_(m,["stop"]),class:"inline-flex items-center justify-center px-3 py-2 border border-transparent text-xs font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200 min-h-[36px]","aria-label":`Create opportunity for ${l.principal.principal_name}`},p[5]||(p[5]=[e("svg",{class:"h-3 w-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),L(" Opportunity ",-1)]),8,We),e("button",{onClick:_(M,["stop"]),class:"inline-flex items-center justify-center px-3 py-2 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200 min-h-[36px]","aria-label":`Log interaction for ${l.principal.principal_name}`},p[6]||(p[6]=[e("svg",{class:"h-3 w-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1),L(" Interaction ",-1)]),8,Ye)]),p[7]||(p[7]=e("div",{class:"absolute inset-0 rounded-lg bg-blue-50 opacity-0 hover:opacity-10 focus:opacity-10 transition-opacity duration-200 pointer-events-none"},null,-1))],40,Ce))}}),Ge=G(Qe,[["__scopeId","data-v-9a22e276"]]),Je={class:"principal-table-container"},Xe={class:"hidden sm:block overflow-x-auto"},Ze={class:"min-w-full divide-y divide-gray-200"},et={class:"bg-gray-50"},tt=["aria-sort"],st={class:"flex items-center space-x-1"},ot=["d"],nt=["aria-sort"],it={class:"flex items-center space-x-1"},rt=["d"],at=["aria-sort"],lt={class:"flex items-center space-x-1"},dt=["d"],ut=["aria-sort"],ct={class:"flex items-center space-x-1"},pt=["d"],mt={class:"bg-white divide-y divide-gray-200"},gt=["onClick","onKeydown","aria-label"],vt={class:"px-4 py-4 whitespace-nowrap"},ft={class:"flex items-center"},xt={class:"flex-shrink-0 h-10 w-10"},yt={class:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center"},ht={class:"text-sm font-medium text-blue-600"},bt={class:"ml-4"},wt={class:"text-sm font-medium text-gray-900 truncate max-w-[200px]"},_t={class:"text-sm text-gray-500 truncate max-w-[200px]"},kt={key:0,class:"text-xs text-gray-400 uppercase"},$t={class:"px-4 py-4 whitespace-nowrap"},Ct={class:"flex items-center"},Mt={class:"flex flex-col"},St={class:"text-sm font-medium text-gray-900"},Lt={class:"px-4 py-4 whitespace-nowrap text-sm text-gray-900"},Tt={class:"flex flex-col"},At={class:"text-xs text-gray-500"},jt={class:"px-4 py-4 whitespace-nowrap"},zt={class:"flex items-center space-x-4 text-sm text-gray-900"},Pt={class:"flex flex-col items-center"},It={class:"font-medium"},Bt={class:"flex flex-col items-center"},Vt={class:"font-medium"},Et={class:"flex flex-col items-center"},Ot={class:"font-medium"},Ut={class:"px-4 py-4 whitespace-nowrap text-right text-sm font-medium"},Dt={class:"flex items-center justify-end space-x-2"},Rt=["onClick","aria-label"],Nt=["onClick","aria-label"],Ft=["onClick","aria-label"],Kt={class:"sm:hidden space-y-3"},Ht=["onClick","onKeydown","aria-label"],qt={class:"flex items-start justify-between mb-3"},Wt={class:"flex items-center space-x-3"},Yt={class:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0"},Qt={class:"text-sm font-medium text-blue-600"},Gt={class:"min-w-0 flex-1"},Jt={class:"text-sm font-medium text-gray-900 truncate"},Xt={class:"text-xs text-gray-500 truncate"},Zt={key:0,class:"text-xs text-gray-400 uppercase"},es={class:"grid grid-cols-2 gap-4 mb-3"},ts={class:"text-center"},ss={class:"text-center"},os={class:"text-sm font-medium text-gray-900"},ns={class:"grid grid-cols-3 gap-2 mb-3 text-center"},is={class:"text-sm font-medium text-gray-900"},rs={class:"text-sm font-medium text-gray-900"},as={class:"text-sm font-medium text-gray-900"},ls={class:"grid grid-cols-2 gap-2"},ds=["onClick"],us=["onClick"],cs={key:0,class:"flex items-center justify-center py-8"},ps=Q({__name:"PrincipalTable",props:{principals:{},loading:{type:Boolean,default:!1}},emits:["principal-click","create-opportunity","log-interaction","sort-change"],setup(K,{emit:j}){const S=j,g=y({column:null,direction:"asc"}),v=r=>g.value.column!==r?"none":g.value.direction==="asc"?"ascending":"descending",$=r=>{if(!r)return"?";const s=r.split(" ");return s.length===1?s[0].charAt(0).toUpperCase():(s[0].charAt(0)+s[s.length-1].charAt(0)).toUpperCase()},f=r=>r?new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Never",C=r=>{if(!r)return"Never";const s=new Date(r),i=Math.abs(new Date().getTime()-s.getTime()),h=Math.floor(i/(1e3*60*60*24));return h===0?"Today":h===1?"1 day ago":h<7?`${h} days ago`:h<30?`${Math.floor(h/7)} weeks ago`:h<365?`${Math.floor(h/30)} months ago`:`${Math.floor(h/365)} years ago`},m=r=>{let s="asc";g.value.column===r&&(s=g.value.direction==="asc"?"desc":"asc"),g.value={column:r,direction:s},S("sort-change",r,s)},M=r=>{S("principal-click",r)},l=r=>{S("create-opportunity",r)},p=r=>{S("log-interaction",r)},P=r=>g.value.column!==r?"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4":g.value.direction==="asc"?"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12":"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4",k=r=>g.value.column===r?"h-3 w-3 text-blue-600":"h-3 w-3 text-gray-400";return(r,s)=>(d(),c("div",Je,[e("div",Xe,[e("table",Ze,[e("thead",et,[e("tr",null,[e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 focus:bg-gray-100 transition-colors duration-200",onClick:s[0]||(s[0]=o=>m("name")),onKeydown:[s[1]||(s[1]=w(o=>m("name"),["enter"])),s[2]||(s[2]=w(_(o=>m("name"),["prevent"]),["space"]))],tabindex:"0","aria-sort":v("name")},[e("div",st,[s[12]||(s[12]=e("span",null,"Principal",-1)),(d(),c("svg",{class:B(k("name")),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:P("name")},null,8,ot)],2))])],40,tt),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 focus:bg-gray-100 transition-colors duration-200",onClick:s[3]||(s[3]=o=>m("engagement")),onKeydown:[s[4]||(s[4]=w(o=>m("engagement"),["enter"])),s[5]||(s[5]=w(_(o=>m("engagement"),["prevent"]),["space"]))],tabindex:"0","aria-sort":v("engagement")},[e("div",it,[s[13]||(s[13]=e("span",null,"Engagement",-1)),(d(),c("svg",{class:B(k("engagement")),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:P("engagement")},null,8,rt)],2))])],40,nt),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 focus:bg-gray-100 transition-colors duration-200",onClick:s[6]||(s[6]=o=>m("activity")),onKeydown:[s[7]||(s[7]=w(o=>m("activity"),["enter"])),s[8]||(s[8]=w(_(o=>m("activity"),["prevent"]),["space"]))],tabindex:"0","aria-sort":v("activity")},[e("div",lt,[s[14]||(s[14]=e("span",null,"Last Activity",-1)),(d(),c("svg",{class:B(k("activity")),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:P("activity")},null,8,dt)],2))])],40,at),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 focus:bg-gray-100 transition-colors duration-200",onClick:s[9]||(s[9]=o=>m("opportunities")),onKeydown:[s[10]||(s[10]=w(o=>m("opportunities"),["enter"])),s[11]||(s[11]=w(_(o=>m("opportunities"),["prevent"]),["space"]))],tabindex:"0","aria-sort":v("opportunities")},[e("div",ct,[s[15]||(s[15]=e("span",null,"Opportunities",-1)),(d(),c("svg",{class:B(k("opportunities")),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:P("opportunities")},null,8,pt)],2))])],40,ut),s[16]||(s[16]=e("th",{scope:"col",class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ",-1))])]),e("tbody",mt,[(d(!0),c(N,null,F(r.principals,o=>(d(),c("tr",{key:o.principal_id,class:"hover:bg-gray-50 cursor-pointer transition-colors duration-200",onClick:i=>M(o),onKeydown:[w(i=>M(o),["enter"]),w(_(i=>M(o),["prevent"]),["space"])],tabindex:"0","aria-label":`View details for ${o.principal_name}`},[e("td",vt,[e("div",ft,[e("div",xt,[e("div",yt,[e("span",ht,a($(o.principal_name)),1)])]),e("div",bt,[e("div",wt,a(o.principal_name),1),e("div",_t,a(o.organization_type),1),o.organization_type?(d(),c("div",kt,a(o.organization_type),1)):T("",!0)])])]),e("td",$t,[e("div",Ct,[A(Y,{score:o.engagement_score||0,size:"sm",class:"mr-3"},null,8,["score"]),e("div",Mt,[e("span",St,a(o.engagement_score||0)+"% ",1),A(W,{status:o.activity_status==="STALE"?"LOW":o.activity_status,size:"xs"},null,8,["status"])])])]),e("td",Lt,[e("div",Tt,[e("span",null,a(f(o.last_activity_date)),1),e("span",At,a(C(o.last_activity_date)),1)])]),e("td",jt,[e("div",zt,[e("div",Pt,[e("span",It,a(o.active_opportunities||0),1),s[17]||(s[17]=e("span",{class:"text-xs text-gray-500"},"Active",-1))]),e("div",Bt,[e("span",Vt,a(o.total_interactions||0),1),s[18]||(s[18]=e("span",{class:"text-xs text-gray-500"},"Interactions",-1))]),e("div",Et,[e("span",Ot,a(o.total_opportunities||0),1),s[19]||(s[19]=e("span",{class:"text-xs text-gray-500"},"Total",-1))])])]),e("td",Ut,[e("div",Dt,[e("button",{onClick:_(i=>l(o),["stop"]),class:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-blue-600 hover:text-blue-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 min-h-[32px] min-w-[32px]","aria-label":`Create opportunity for ${o.principal_name}`},s[20]||(s[20]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)]),8,Rt),e("button",{onClick:_(i=>p(o),["stop"]),class:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-gray-600 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 min-h-[32px] min-w-[32px]","aria-label":`Log interaction for ${o.principal_name}`},s[21]||(s[21]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1)]),8,Nt),e("button",{onClick:_(i=>M(o),["stop"]),class:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-gray-600 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 min-h-[32px] min-w-[32px]","aria-label":`View details for ${o.principal_name}`},s[22]||(s[22]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,Ft)])])],40,gt))),128))])])]),e("div",Kt,[(d(!0),c(N,null,F(r.principals,o=>(d(),c("div",{key:o.principal_id,class:"bg-white border border-gray-200 rounded-lg p-4 cursor-pointer hover:shadow-md transition-shadow duration-200",onClick:i=>M(o),onKeydown:[w(i=>M(o),["enter"]),w(_(i=>M(o),["prevent"]),["space"])],tabindex:"0","aria-label":`View details for ${o.principal_name}`},[e("div",qt,[e("div",Wt,[e("div",Yt,[e("span",Qt,a($(o.principal_name)),1)]),e("div",Gt,[e("h3",Jt,a(o.principal_name),1),e("p",Xt,a(o.organization_type),1),o.organization_type?(d(),c("p",Zt,a(o.organization_type),1)):T("",!0)])]),A(W,{status:o.activity_status==="STALE"?"LOW":o.activity_status,size:"sm"},null,8,["status"])]),e("div",es,[e("div",ts,[A(Y,{score:o.engagement_score||0,size:"sm",class:"mx-auto mb-1"},null,8,["score"]),s[23]||(s[23]=e("div",{class:"text-xs text-gray-500"},"Engagement",-1))]),e("div",ss,[e("div",os,a(C(o.last_activity_date)),1),s[24]||(s[24]=e("div",{class:"text-xs text-gray-500"},"Last Activity",-1))])]),e("div",ns,[e("div",null,[e("div",is,a(o.active_opportunities||0),1),s[25]||(s[25]=e("div",{class:"text-xs text-gray-500"},"Opportunities",-1))]),e("div",null,[e("div",rs,a(o.total_interactions||0),1),s[26]||(s[26]=e("div",{class:"text-xs text-gray-500"},"Interactions",-1))]),e("div",null,[e("div",as,a(o.total_opportunities||0),1),s[27]||(s[27]=e("div",{class:"text-xs text-gray-500"},"Products",-1))])]),e("div",ls,[e("button",{onClick:_(i=>l(o),["stop"]),class:"inline-flex items-center justify-center px-3 py-2 border border-transparent text-xs font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 min-h-[44px]"},s[28]||(s[28]=[e("svg",{class:"h-3 w-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),L(" Opportunity ",-1)]),8,ds),e("button",{onClick:_(i=>p(o),["stop"]),class:"inline-flex items-center justify-center px-3 py-2 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 min-h-[44px]"},s[29]||(s[29]=[e("svg",{class:"h-3 w-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1),L(" Interaction ",-1)]),8,us)])],40,Ht))),128))]),r.loading?(d(),c("div",cs,s[30]||(s[30]=[e("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"},null,-1),e("span",{class:"ml-2 text-gray-600"},"Loading...",-1)]))):T("",!0)]))}}),ms=G(ps,[["__scopeId","data-v-57b9e3e9"]]),gs={class:"principals-list-view max-w-full","data-testid":"principals-list-view"},vs={class:"flex flex-col space-y-4 mb-6","data-testid":"principals-header"},fs={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},xs={class:"flex flex-col sm:flex-row items-stretch sm:items-center space-y-2 sm:space-y-0 sm:space-x-3"},ys=["disabled","aria-label"],hs={class:"w-full"},bs={class:"mb-8","data-testid":"kpi-dashboard-section"},ws={class:"mb-6"},_s={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4"},ks={class:"space-y-4"},$s={class:"w-full"},Cs={class:"relative"},Ms={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3"},Ss={key:0,class:"flex flex-wrap items-center gap-2"},Ls=["onClick"],Ts={class:"space-y-6"},As={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8","data-testid":"loading-spinner"},js={key:1,class:"bg-white rounded-lg shadow-sm border border-red-200 p-6","data-testid":"error-message"},zs={class:"flex items-start space-x-3"},Ps={class:"flex-1"},Is={class:"mt-1 text-sm text-red-700"},Bs={key:2,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center"},Vs={class:"text-lg font-medium text-gray-900 mb-2"},Es={class:"text-gray-500 mb-6"},Os={class:"flex flex-col sm:flex-row justify-center gap-3"},Us={key:3,"data-testid":"principals-grid-section"},Ds={class:"flex items-center justify-between mb-4"},Rs={class:"flex items-center space-x-2"},Ns={class:"text-sm text-gray-700"},Fs={key:0,class:"text-sm text-gray-500"},Ks={class:"flex items-center space-x-2"},Hs=["aria-pressed"],qs=["aria-pressed"],Ws={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Ys={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},Qs={key:2,class:"mt-6 flex flex-col sm:flex-row items-center justify-between space-y-3 sm:space-y-0"},Gs={class:"text-sm text-gray-700"},Js={class:"flex items-center space-x-2"},Xs=["disabled"],Zs={class:"text-sm text-gray-700"},eo=["disabled"],to=Q({__name:"PrincipalsListView",setup(K){const j=we(),S=_e(),g=y("all"),v=y(""),$=y("grid"),f=y(1),C=y(12),m=y(!1),M=y(!1),l=y(!1),p=y(null),P=y(null),k=y([]),r=y([]),s=y(null),o=y(null),i=y({activityStatus:"",engagementLevel:"",organizationType:"",followUpStatus:""}),h=I(()=>!!(v.value||i.value.activityStatus||i.value.engagementLevel||i.value.organizationType||i.value.followUpStatus)),ae=I(()=>{const n=[];return v.value&&n.push({key:"search",label:`Search: "${v.value}"`}),i.value.activityStatus&&n.push({key:"activityStatus",label:`Activity: ${i.value.activityStatus}`}),i.value.engagementLevel&&n.push({key:"engagementLevel",label:`Engagement: ${i.value.engagementLevel}`}),i.value.organizationType&&n.push({key:"organizationType",label:`Type: ${i.value.organizationType}`}),i.value.followUpStatus&&n.push({key:"followUpStatus",label:`Follow-up: ${i.value.followUpStatus}`}),n}),J=I(()=>{let n=[...k.value];if(v.value){const t=v.value.toLowerCase();n=n.filter(x=>{var u,b;return((u=x.principal_name)==null?void 0:u.toLowerCase().includes(t))||((b=x.principal_name)==null?void 0:b.toLowerCase().includes(t))})}return i.value.activityStatus&&(n=n.filter(t=>t.activity_status===i.value.activityStatus)),i.value.engagementLevel&&(n=n.filter(t=>{const x=t.engagement_score||0;switch(i.value.engagementLevel){case"high":return x>=80;case"medium":return x>=40&&x<80;case"low":return x<40;default:return!0}})),i.value.organizationType&&(n=n.filter(t=>t.organization_type===i.value.organizationType)),i.value.followUpStatus&&(n=n.filter(t=>{switch(i.value.followUpStatus){case"required":return(t.follow_ups_required||0)>0;case"scheduled":return t.next_follow_up_date!=null;case"overdue":return t.next_follow_up_date!=null&&new Date(t.next_follow_up_date)<new Date;default:return!0}})),n}),E=I(()=>J.value.length),le=I(()=>k.value.length),U=I(()=>Math.ceil(E.value/C.value)),X=I(()=>{const n=(f.value-1)*C.value,t=n+C.value;return J.value.slice(n,t)});let Z;const de=()=>{clearTimeout(Z),Z=setTimeout(()=>{f.value=1},300)},ue=n=>{g.value=(n==null?void 0:n.principal_id)||"all"},H=async()=>{await Promise.all([oe(),ne()])},ce=()=>{console.log("Export principals data")},V=()=>{f.value=1},pe=n=>{switch(n){case"search":v.value="";break;case"activityStatus":i.value.activityStatus="";break;case"engagementLevel":i.value.engagementLevel="";break;case"organizationType":i.value.organizationType="";break;case"followUpStatus":i.value.followUpStatus="";break}V()},q=()=>{v.value="",i.value={activityStatus:"",engagementLevel:"",organizationType:"",followUpStatus:""},g.value="all",V()},ee=n=>{j.push(`/principals/${n.principal_id}`)},te=n=>{j.push(`/opportunities/new?principal=${n.principal_id}`)},se=n=>{j.push(`/interactions/new?principal=${n.principal_id}`)},me=(n,t)=>{k.value.sort((x,u)=>{let b,z;switch(n){case"name":b=x.principal_name||"",z=u.principal_name||"";break;case"engagement":b=x.engagement_score||0,z=u.engagement_score||0;break;case"activity":b=x.last_activity_date||"",z=u.last_activity_date||"";break;case"opportunities":b=x.active_opportunities||0,z=u.active_opportunities||0;break;default:return 0}return t==="asc"?b<z?-1:b>z?1:0:b>z?-1:b<z?1:0})},ge=()=>{f.value>1&&f.value--},ve=()=>{f.value<U.value&&f.value++},oe=async()=>{m.value=!0,p.value=null;try{const n=await R.getPrincipalActivitySummary();n.success?k.value=n.data||[]:p.value=n.error||"Failed to load principals data"}catch(n){p.value=n instanceof Error?n.message:"Unexpected error occurred"}finally{m.value=!1}},ne=async()=>{l.value=!0;try{const n=await R.getEngagementScoreBreakdown();n.success&&(s.value=n.data);const t=await R.getPrincipalStats();t.success&&(o.value=t.data);const x=await R.getPrincipalActivitySummary();x.success&&(r.value=x.data||[])}catch(n){console.error("Failed to load KPI data:",n)}finally{l.value=!1}};return fe(async()=>{await Promise.all([oe(),ne(),S.fetchPrincipalOptions()])}),ie(()=>j.currentRoute.value.fullPath,n=>{n==="/principals"&&H()}),ie([v,i],()=>{f.value=1},{deep:!0}),(n,t)=>{const x=he("router-link");return d(),c("div",gs,[e("div",vs,[e("div",fs,[t[11]||(t[11]=e("div",{class:"mb-4 sm:mb-0"},[e("h1",{class:"text-2xl sm:text-3xl font-bold text-gray-900","data-testid":"page-title"}," Principal Activity Management "),e("p",{class:"mt-1 text-sm text-gray-600"}," Comprehensive relationship insights and performance analytics ")],-1)),e("div",xs,[e("button",{onClick:H,disabled:m.value,class:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 min-h-[44px]","aria-label":m.value?"Refreshing...":"Refresh data"},[(d(),c("svg",{class:B(["h-4 w-4 mr-2",{"animate-spin":m.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[8]||(t[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]),2)),t[9]||(t[9]=L(" Refresh ",-1))],8,ys),e("button",{onClick:ce,class:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 min-h-[44px]"},t[10]||(t[10]=[e("svg",{class:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),L(" Export ",-1)]))])]),e("div",hs,[A(ke,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=u=>g.value=u),loading:M.value,error:P.value,"allow-all-principals":"",onChange:ue,class:"w-full"},null,8,["modelValue","loading","error"])])]),e("section",bs,[t[12]||(t[12]=e("div",{class:"mb-4"},[e("h2",{class:"text-lg font-semibold text-gray-900"},"Performance Overview"),e("p",{class:"text-sm text-gray-600"},"Key metrics and engagement insights")],-1)),A($e,{"activity-summary":r.value,"engagement-breakdown":s.value,stats:o.value,loading:l.value,"selected-principal-id":g.value,"data-testid":"kpi-cards"},null,8,["activity-summary","engagement-breakdown","stats","loading","selected-principal-id"])]),e("section",ws,[e("div",_s,[e("div",ks,[e("div",$s,[t[14]||(t[14]=e("label",{for:"search",class:"sr-only"},"Search principals",-1)),e("div",Cs,[t[13]||(t[13]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),O(e("input",{id:"search","onUpdate:modelValue":t[1]||(t[1]=u=>v.value=u),type:"text",placeholder:"Search principals by name or organization...",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[44px]",onInput:de},null,544),[[xe,v.value]])])]),e("div",Ms,[O(e("select",{"onUpdate:modelValue":t[2]||(t[2]=u=>i.value.activityStatus=u),class:"block w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[44px]",onChange:V},t[15]||(t[15]=[re('<option value="" data-v-9d810779>All Activity Levels</option><option value="ACTIVE" data-v-9d810779>Active</option><option value="MODERATE" data-v-9d810779>Moderate</option><option value="LOW" data-v-9d810779>Low Activity</option><option value="NO_ACTIVITY" data-v-9d810779>No Activity</option>',5)]),544),[[D,i.value.activityStatus]]),O(e("select",{"onUpdate:modelValue":t[3]||(t[3]=u=>i.value.engagementLevel=u),class:"block w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[44px]",onChange:V},t[16]||(t[16]=[e("option",{value:""},"All Engagement Levels",-1),e("option",{value:"high"},"High (80-100)",-1),e("option",{value:"medium"},"Medium (40-79)",-1),e("option",{value:"low"},"Low (0-39)",-1)]),544),[[D,i.value.engagementLevel]]),O(e("select",{"onUpdate:modelValue":t[4]||(t[4]=u=>i.value.organizationType=u),class:"block w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[44px]",onChange:V},t[17]||(t[17]=[re('<option value="" data-v-9d810779>All Organization Types</option><option value="DISTRIBUTOR" data-v-9d810779>Distributor</option><option value="RETAILER" data-v-9d810779>Retailer</option><option value="MANUFACTURER" data-v-9d810779>Manufacturer</option><option value="CONSULTANT" data-v-9d810779>Consultant</option>',5)]),544),[[D,i.value.organizationType]]),O(e("select",{"onUpdate:modelValue":t[5]||(t[5]=u=>i.value.followUpStatus=u),class:"block w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[44px]",onChange:V},t[18]||(t[18]=[e("option",{value:""},"All Follow-up Status",-1),e("option",{value:"required"},"Requires Follow-up",-1),e("option",{value:"scheduled"},"Scheduled",-1),e("option",{value:"overdue"},"Overdue",-1)]),544),[[D,i.value.followUpStatus]])]),h.value?(d(),c("div",Ss,[t[20]||(t[20]=e("span",{class:"text-sm text-gray-600"},"Active filters:",-1)),(d(!0),c(N,null,F(ae.value,u=>(d(),c("button",{key:u.key,onClick:b=>pe(u.key),class:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-500"},[L(a(u.label)+" ",1),t[19]||(t[19]=e("svg",{class:"ml-1 h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1))],8,Ls))),128)),e("button",{onClick:q,class:"text-sm text-gray-600 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 py-1"}," Clear all ")])):T("",!0)])])]),e("section",Ts,[m.value&&k.value.length===0?(d(),c("div",As,t[21]||(t[21]=[e("div",{class:"flex flex-col items-center justify-center space-y-4"},[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e("p",{class:"text-center text-gray-500"},"Loading principal data...")],-1)]))):p.value?(d(),c("div",js,[e("div",zs,[t[23]||(t[23]=e("svg",{class:"h-5 w-5 text-red-400 mt-1 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("div",Ps,[t[22]||(t[22]=e("h3",{class:"text-sm font-medium text-red-800"},"Error loading principal data",-1)),e("p",Is,a(p.value),1),e("div",{class:"mt-4 flex flex-col sm:flex-row gap-3"},[e("button",{onClick:H,class:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 min-h-[44px]","data-testid":"retry-button"}," Try Again "),e("button",{onClick:q,class:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 min-h-[44px]"}," Clear Filters ")])])])])):k.value.length===0&&!m.value?(d(),c("div",Bs,[t[25]||(t[25]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),e("h3",Vs,a(h.value?"No principals match your search":"No principals found"),1),e("p",Es,a(h.value?"Try adjusting your search terms or filters to find the principals you're looking for.":"Principals will appear here once they are created in the system."),1),e("div",Os,[h.value?(d(),c("button",{key:0,onClick:q,class:"inline-flex items-center justify-center px-6 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 min-h-[44px]"}," Clear All Filters ")):T("",!0),A(x,{to:"/organizations/new",class:"inline-flex items-center justify-center px-6 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 min-h-[44px]"},{default:ye(()=>t[24]||(t[24]=[e("svg",{class:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),L(" Add New Organization ",-1)])),_:1,__:[24]})])])):(d(),c("div",Us,[e("div",Ds,[e("div",Rs,[e("span",Ns,a(E.value)+" principal"+a(E.value===1?"":"s"),1),h.value?(d(),c("span",Fs," (filtered from "+a(le.value)+") ",1)):T("",!0)]),e("div",Ks,[t[28]||(t[28]=e("label",{for:"view-toggle",class:"sr-only"},"Toggle view",-1)),e("button",{onClick:t[6]||(t[6]=u=>$.value="grid"),class:B(["p-2 rounded-md transition-colors",$.value==="grid"?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600"]),"aria-pressed":$.value==="grid"},t[26]||(t[26]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)]),10,Hs),e("button",{onClick:t[7]||(t[7]=u=>$.value="list"),class:B(["p-2 rounded-md transition-colors",$.value==="list"?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600"]),"aria-pressed":$.value==="list"},t[27]||(t[27]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})],-1)]),10,qs)])]),$.value==="grid"?(d(),c("div",Ws,[(d(!0),c(N,null,F(X.value,u=>(d(),be(Ge,{key:u.principal_id,principal:u,onClick:b=>ee(u),onCreateOpportunity:b=>te(u),onLogInteraction:b=>se(u),class:"cursor-pointer hover:shadow-md transition-shadow duration-200"},null,8,["principal","onClick","onCreateOpportunity","onLogInteraction"]))),128))])):(d(),c("div",Ys,[A(ms,{principals:X.value,loading:m.value,onPrincipalClick:ee,onCreateOpportunity:te,onLogInteraction:se,onSortChange:me},null,8,["principals","loading"])])),U.value>1?(d(),c("div",Qs,[e("div",Gs," Showing "+a((f.value-1)*C.value+1)+" to "+a(Math.min(f.value*C.value,E.value))+" of "+a(E.value)+" principals ",1),e("div",Js,[e("button",{onClick:ge,disabled:f.value===1,class:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed min-h-[44px]"},t[29]||(t[29]=[e("svg",{class:"h-4 w-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),L(" Previous ",-1)]),8,Xs),e("span",Zs," Page "+a(f.value)+" of "+a(U.value),1),e("button",{onClick:ve,disabled:f.value===U.value,class:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed min-h-[44px]"},t[30]||(t[30]=[L(" Next ",-1),e("svg",{class:"h-4 w-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,eo)])])):T("",!0)]))])])}}}),$o=G(to,[["__scopeId","data-v-9d810779"]]);export{$o as default};
//# sourceMappingURL=PrincipalsListView-DJb83APy.js.map
