const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/OpportunityKPICards-BfdiF2IH.js","js/opportunityStore-CXzxniyP.js","js/pinia-CUC4VGP7.js","js/vue-runtime-Ds28nt_E.js","js/supabaseClient-5bv4QPtU.js","js/supabase-BzUtZ1M4.js","js/yup-D02u5inE.js","js/_plugin-vue_export-helper-DYAABpgn.js","css/OpportunityKPICards-B1Alijf1.css"])))=>i.map(i=>d[i]);
import{u as e}from"./vue-router-BP51f1Hv.js";import{u as t}from"./dashboardStore-dJMOurWT.js";import{u as r}from"./opportunityStore-CXzxniyP.js";import{u as s}from"./interactionStore-D-S0JqDn.js";import{_ as o}from"./supabase-BzUtZ1M4.js";import{d as a,r as i,y as l,z as n,C as d,J as c,K as u,D as p,F as m,L as g,M as b,G as v,N as x,S as h,E as f,O as y,u as w,P as k,Q as _,R as j,c as C,U as M,B as I,V as B,W as R,H as z}from"./vue-runtime-Ds28nt_E.js";import{_ as O}from"./_plugin-vue_export-helper-DYAABpgn.js";import"./pinia-CUC4VGP7.js";import"./productStore-CX98uskH.js";import"./supabaseClient-5bv4QPtU.js";import"./organizationStore-B4O_H-mo.js";import"./yup-D02u5inE.js";import"./principalStore-B-JbVMeA.js";import"./organizationsApi-B46nS86y.js";const S={class:"opportunity-kpi-lazy-wrapper"},A={key:0,class:"kpi-skeleton"},P={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},D={class:"kpi-skeleton"},q={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},H=O(a({inheritAttrs:!0,t:"OpportunityKPICardsLazy",setup(e){const t=k({loader:()=>o(()=>import("./OpportunityKPICards-BfdiF2IH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])),delay:100,timeout:5e3,suspensible:!0}),r=i(),s=i(!1),a=i(!1);let C=null;const M=()=>{r.value&&(C=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(s.value=!0,setTimeout(()=>{a.value=!0},200),null==C||C.disconnect())})},{root:null,rootMargin:"50px",threshold:.1}),C.observe(r.value))};return l(()=>{"requestIdleCallback"in window?requestIdleCallback(()=>{M()}):setTimeout(()=>{M()},100)}),n(()=>{null==C||C.disconnect()}),(e,o)=>(f(),d("div",S,[a.value?c("",!0):(f(),d("div",A,[p("div",P,[(f(),d(m,null,g(4,e=>p("div",{key:e,class:"bg-white p-6 rounded-lg shadow-sm border animate-pulse"},o[0]||(o[0]=[y('<div class="flex items-center justify-between mb-2" data-v-9d33b8aa><div class="h-4 bg-gray-300 rounded w-24" data-v-9d33b8aa></div><div class="w-6 h-6 bg-gray-300 rounded" data-v-9d33b8aa></div></div><div class="h-8 bg-gray-300 rounded w-16 mb-1" data-v-9d33b8aa></div><div class="h-3 bg-gray-300 rounded w-20" data-v-9d33b8aa></div>',3)]))),64))])])),u(p("div",{ref_key:"kpiContainer",ref:r,class:"kpi-container"},[(f(),v(h,null,{default:x(()=>[s.value?(f(),v(w(t),_(j({key:0},e.$attrs)),null,16)):c("",!0)]),fallback:x(()=>[p("div",D,[p("div",q,[(f(),d(m,null,g(4,e=>p("div",{key:e,class:"bg-white p-6 rounded-lg shadow-sm border animate-pulse"},o[1]||(o[1]=[p("div",{class:"flex items-center justify-between mb-2"},[p("div",{class:"h-4 bg-gray-300 rounded w-24"}),p("div",{class:"w-6 h-6 bg-gray-300 rounded"})],-1),p("div",{class:"h-8 bg-gray-300 rounded w-16 mb-1"},null,-1),p("div",{class:"h-3 bg-gray-300 rounded w-20"},null,-1)]))),64))])])]),o:1}))],512),[[b,a.value]])]))}}),[["__scopeId","data-v-9d33b8aa"]]),E={class:"dashboard-view"},L={class:"mb-6"},N={class:"flex items-center justify-between"},T={class:"flex items-center space-x-3"},$=["disabled"],F={class:"mb-8"},K={class:"mb-6"},V={class:"mb-8"},G={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},J={class:"mt-8"},Q={class:"bg-white rounded-lg shadow-sm border border-gray-200"},U={class:"border-b border-gray-200"},W={class:"-mb-px flex space-x-8 px-6","aria-label":"Recent activity tabs"},Y={class:"p-6"},X={key:0,class:"recent-opportunities"},Z={key:0,class:"text-center py-8"},ee={class:"mt-6"},te={key:1,class:"space-y-3"},re=["onClick"],se={class:"ml-4 flex-1"},oe={class:"text-sm font-medium text-gray-900"},ae={class:"text-sm text-gray-500"},ie={class:"text-xs text-gray-400 mt-1"},le={class:"text-right"},ne={class:"text-sm font-medium text-gray-900"},de={key:1},ce=O(a({t:"DashboardView",setup(o){const a=e(),n=t(),u=r(),b=s(),v=i("opportunities"),h=C(()=>n.loading||n.refreshing||u.isLoading||b.isLoading),y=C(()=>u.opportunities.slice(0,5)),k=async()=>{try{await Promise.all([n.refreshDashboard(),u.fetchKPIs(),u.fetchOpportunities({search:"",stage:[],probability_min:0,probability_max:100,created_after:"",created_before:"",context:[],principal_id:""},{page:1,limit:5,sort_by:"created_at",sort_order:"desc"}),b.fetchKPIs()])}catch(e){}},_=e=>{const t=new Date(e),r=new Date,s=r.getTime()-t.getTime(),o=Math.floor(s/864e5);if(0===o)return"Today";if(1===o)return"Yesterday";if(o<7)return`${o} days ago`;if(o<30){const e=Math.floor(o/7);return`${e} week${e>1?"s":""} ago`}return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==r.getFullYear()?"numeric":void 0})};return l(async()=>{n.initializeDashboard();try{await u.fetchKPIs()}catch(e){}setTimeout(async()=>{try{await Promise.allSettled([b.fetchKPIs(),n.refreshDashboard()])}catch(e){}},100)}),(e,t)=>{const r=z("router-link");return f(),d("div",E,[p("div",L,[p("div",N,[t[3]||(t[3]=p("div",null,[p("h1",{class:"text-3xl font-bold text-gray-900"},"Dashboard"),p("p",{class:"text-gray-600 mt-1"},"Welcome to your CRM dashboard")],-1)),p("div",T,[p("button",{onClick:k,disabled:h.value,class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[(f(),d("svg",{class:I(["w-4 h-4 mr-2",{"animate-spin":h.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[2]||(t[2]=[p("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]),2)),M(" "+B(h.value?"Refreshing...":"Refresh"),1)],8,$)])])]),p("div",F,[t[5]||(t[5]=p("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Performance Overview",-1)),p("div",K,[t[4]||(t[4]=p("h3",{class:"text-lg font-medium text-gray-800 mb-3"},"Sales Pipeline",-1)),R(H,{loading:w(u).isLoading},null,8,["loading"])]),t[6]||(t[6]=p("div",null,[p("h3",{class:"text-lg font-medium text-gray-800 mb-3"},"Customer Engagement")],-1))]),p("div",V,[t[11]||(t[11]=p("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Quick Actions",-1)),p("div",G,[R(r,{to:"/opportunities/new",class:"quick-action-card group bg-gradient-to-br from-blue-50 to-blue-100 hover:from-blue-100 hover:to-blue-200 border-blue-200"},{default:x(()=>t[7]||(t[7]=[p("div",{class:"flex items-center"},[p("div",{class:"flex-shrink-0"},[p("div",{class:"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center group-hover:bg-blue-600 transition-colors shadow-lg"},[p("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[p("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})])])]),p("div",{class:"ml-4"},[p("p",{class:"text-sm font-semibold text-gray-900 group-hover:text-blue-700"},"New Opportunity"),p("p",{class:"text-xs text-gray-600"},"Create sales opportunity")])],-1)])),o:1,i:[7]}),R(r,{to:"/interactions/new",class:"quick-action-card group bg-gradient-to-br from-green-50 to-green-100 hover:from-green-100 hover:to-green-200 border-green-200"},{default:x(()=>t[8]||(t[8]=[p("div",{class:"flex items-center"},[p("div",{class:"flex-shrink-0"},[p("div",{class:"w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center group-hover:bg-green-600 transition-colors shadow-lg"},[p("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[p("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})])])]),p("div",{class:"ml-4"},[p("p",{class:"text-sm font-semibold text-gray-900 group-hover:text-green-700"},"New Interaction"),p("p",{class:"text-xs text-gray-600"},"Log customer interaction")])],-1)])),o:1,i:[8]}),R(r,{to:"/contacts/new",class:"quick-action-card group bg-gradient-to-br from-purple-50 to-purple-100 hover:from-purple-100 hover:to-purple-200 border-purple-200"},{default:x(()=>t[9]||(t[9]=[p("div",{class:"flex items-center"},[p("div",{class:"flex-shrink-0"},[p("div",{class:"w-12 h-12 bg-purple-500 rounded-xl flex items-center justify-center group-hover:bg-purple-600 transition-colors shadow-lg"},[p("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[p("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})])])]),p("div",{class:"ml-4"},[p("p",{class:"text-sm font-semibold text-gray-900 group-hover:text-purple-700"},"Add Contact"),p("p",{class:"text-xs text-gray-600"},"Create new contact")])],-1)])),o:1,i:[9]}),R(r,{to:"/interactions?filter=follow_up_overdue",class:"quick-action-card group bg-gradient-to-br from-amber-50 to-amber-100 hover:from-amber-100 hover:to-amber-200 border-amber-200"},{default:x(()=>t[10]||(t[10]=[p("div",{class:"flex items-center"},[p("div",{class:"flex-shrink-0"},[p("div",{class:"w-12 h-12 bg-amber-500 rounded-xl flex items-center justify-center group-hover:bg-amber-600 transition-colors shadow-lg"},[p("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[p("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])])]),p("div",{class:"ml-4"},[p("p",{class:"text-sm font-semibold text-gray-900 group-hover:text-amber-700"},"Follow-ups"),p("p",{class:"text-xs text-gray-600"},"Review overdue items")])],-1)])),o:1,i:[10]})])]),p("div",J,[t[18]||(t[18]=p("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Recent Activity",-1)),p("div",Q,[p("div",U,[p("nav",W,[p("button",{onClick:t[0]||(t[0]=e=>v.value="opportunities"),class:I(["opportunities"===v.value?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200"])}," Recent Opportunities ",2),p("button",{onClick:t[1]||(t[1]=e=>v.value="interactions"),class:I(["interactions"===v.value?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200"])}," Recent Interactions ",2)])]),p("div",Y,["opportunities"===v.value?(f(),d("div",X,[0===y.value.length?(f(),d("div",Z,[t[13]||(t[13]=p("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[p("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})],-1)),t[14]||(t[14]=p("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No recent opportunities",-1)),t[15]||(t[15]=p("p",{class:"mt-1 text-sm text-gray-500"},"Create your first sales opportunity to get started.",-1)),p("div",ee,[R(r,{to:"/opportunities/new",class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:x(()=>t[12]||(t[12]=[p("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[p("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),M(" New Opportunity ",-1)])),o:1,i:[12]})])])):(f(),d("div",te,[(f(!0),d(m,null,g(y.value,e=>{return f(),d("div",{key:e.id,class:"flex items-center p-4 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors duration-200",onClick:t=>{return r=e.id,void a.push(`/opportunities/${r}`);var r}},[t[17]||(t[17]=p("div",{class:"flex-shrink-0"},[p("div",{class:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center"},[p("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[p("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})])])],-1)),p("div",se,[p("p",oe,B(e.name),1),p("p",ae,B(e.organization_name)+" â€¢ "+B((r=e.stage,r.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "))),1),p("p",ie,B(_(e.created_at)),1)]),p("div",le,[p("p",ne,B(e.probability_percent)+"%",1),t[16]||(t[16]=p("p",{class:"text-xs text-gray-500"},"probability",-1))])],8,re);var r}),128))]))])):c("",!0),"interactions"===v.value?(f(),d("div",de)):c("",!0)])])])])}}}),[["__scopeId","data-v-4294b048"]]);export{ce as default};
