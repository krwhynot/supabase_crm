import{d as e,r as t,c as a,w as s,y as r,G as o,N as l,E as i,D as n,C as c,J as d,W as u,U as p,u as m,B as g,V as x,K as f,X as b,Y as h,F as y,L as _}from"./vue-runtime-Ds28nt_E.js";import{b as v,u as w}from"./vue-router-BP51f1Hv.js";import{_ as M}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-BhtIB2qb.js";import{P}from"./PrincipalSelector-PYcqOzWK.js";import{a as j,P as k}from"./ManagePrincipalProductsButton.vue_vue_type_style_index_0_scoped_f75a9cbf_lang-CSAufz2N.js";import{P as S}from"./PrincipalProductTable-gjltz5Cg.js";import{u as D}from"./principalStore-Bil7HxyJ.js";import"./PrincipalDashboard.vue_vue_type_style_index_0_scoped_daf2c332_lang-CaWpxoCZ.js";import"./supabaseClient-Bh63a8tq.js";/* empty css                                                                       *//* empty css                                                                          */import"./EngagementScoreRing-BHsysYHG.js";/* empty css                                                                                     */import"./opportunityStore-Cei765hD.js";/* empty css                                                                       */import{a6 as C,a7 as V,a8 as T,Z as $,$ as E,_ as A,E as I,d as N,a9 as z,a as L,b as B}from"./heroicons-QXV26b6T.js";import{_ as O}from"./_plugin-vue_export-helper-DYAABpgn.js";import"./dashboardStore-CKr5DBFN.js";import"./pinia-CUC4VGP7.js";import"./productStore-C7_R-7jb.js";import"./organizationStore-Cdi8siI6.js";import"./yup-D1qa_jJc.js";import"./TrendIndicator-CbCc-Yc8.js";import"./organizationsApi-CU0xJvEA.js";import"./supabase-BNBjhZ5t.js";import"./index-CocGRfLV.js";const U={class:"principal-products-view"},R={class:"mb-6"},W={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},G={class:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3"},K=["disabled"],X={class:"flex rounded-md shadow-sm"},F={class:"mb-6"},H={key:0,class:"flex items-center justify-center py-12"},q={key:1,class:"text-center py-12"},Z={key:2,class:"space-y-6"},J={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},Y={class:"bg-white rounded-lg border border-gray-200 p-4"},Q={class:"flex items-center"},ee={class:"flex-shrink-0"},te={class:"ml-3"},ae={class:"text-2xl font-bold text-gray-900"},se={class:"bg-white rounded-lg border border-gray-200 p-4"},re={class:"flex items-center"},oe={class:"flex-shrink-0"},le={class:"ml-3"},ie={class:"text-2xl font-bold text-gray-900"},ne={class:"bg-white rounded-lg border border-gray-200 p-4"},ce={class:"flex items-center"},de={class:"flex-shrink-0"},ue={class:"ml-3"},pe={class:"text-2xl font-bold text-gray-900"},me={class:"bg-white rounded-lg border border-gray-200 p-4"},ge={class:"flex items-center"},xe={class:"flex-shrink-0"},fe={class:"ml-3"},be={class:"text-2xl font-bold text-gray-900"},he={class:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4"},ye={class:"flex-1"},_e={class:"relative"},ve={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},we={class:"p-6 pb-4"},Me={class:"flex items-start justify-between"},Pe={class:"flex-1 min-w-0"},je={class:"text-lg font-medium text-gray-900 truncate"},ke={class:"text-sm text-gray-500 mt-1"},Se={class:"px-6 pb-4"},De={class:"grid grid-cols-2 gap-4"},Ce={class:"text-lg font-semibold text-gray-900 mt-1"},Ve={class:"text-lg font-semibold text-gray-900 mt-1"},Te={class:"px-6 py-4 bg-gray-50 rounded-b-lg"},$e={class:"flex space-x-3"},Ee=["onClick"],Ae=["onClick"],Ie={key:0,class:"col-span-full text-center py-12"},Ne={key:1,class:"bg-white rounded-lg border border-gray-200 overflow-hidden"},ze={class:"bg-white rounded-lg border border-gray-200 p-6"},Le={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Be={class:"h-64"},Oe={class:"space-y-6"},Ue={class:"space-y-2"},Re={class:"flex-1 min-w-0"},We={class:"text-sm font-medium text-gray-900 truncate"},Ge={class:"text-xs text-gray-500"},Ke={class:"space-y-2"},Xe={class:"flex-1 min-w-0"},Fe={class:"text-sm font-medium text-gray-900 truncate"},He={class:"text-xs text-gray-500"},qe={key:3,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Ze={class:"flex"},Je={class:"text-sm text-red-700 mt-1"},Ye=O(e({t:"PrincipalProductsView",setup(e){const O=w(),Ye=v(),Qe=D(),et=t(null),tt=t("grid"),at=t(""),st=t(""),rt=t("performance"),ot=t(!1),lt=t(null),it=t([]),nt=a(()=>Qe.loading),ct=a(()=>Qe.error),dt=a(()=>it.value.length?it.value.reduce((e,t)=>e+(t.product_performance_score||0),0)/it.value.length:0),ut=a(()=>it.value.reduce((e,t)=>e+(t.total_opportunities||0),0)),pt=a(()=>it.value.reduce((e,t)=>e+(t.total_value||0),0)),mt=a(()=>{let e=[...it.value];if(at.value){const t=at.value.toLowerCase();e=e.filter(e=>e.product_name.toLowerCase().includes(t))}return st.value&&(e=e.filter(e=>{const t=e.product_performance_score||0;switch(st.value){case"high":return t>=70;case"medium":return t>=40&&t<70;case"low":return t<40;default:return!0}})),e.sort((e,t)=>{switch(rt.value){case"name":return e.product_name.localeCompare(t.product_name);case"opportunities":return(t.total_opportunities||0)-(e.total_opportunities||0);case"value":return(t.total_value||0)-(e.total_value||0);default:return(t.product_performance_score||0)-(e.product_performance_score||0)}}),e}),gt=a(()=>[...it.value].sort((e,t)=>(t.product_performance_score||0)-(e.product_performance_score||0)).slice(0,3)),xt=a(()=>[...it.value].sort((e,t)=>(e.product_performance_score||0)-(t.product_performance_score||0)).slice(0,3)),ft=async()=>{if(et.value){ot.value=!0,lt.value=null;try{await new Promise(e=>setTimeout(e,1e3));const e=["Premium Widget Pro","Standard Package Plus","Enterprise Solution Max","Basic Service Lite","Advanced Analytics Suite","Custom Integration Tool","Mobile App Platform","Cloud Platform Enterprise","Security Suite Premium","Data Visualization Tool","Workflow Automation","Communication Hub"];it.value=e.map((e,t)=>({principal_id:et.value?.id||`principal_${t+1}`,principal_name:et.value?.name||`Principal ${t+1}`,product_id:`prod_${t+1}`,product_name:e,product_category:["Protein","Sauce","Seasoning","Beverage","Snack"][Math.floor(5*Math.random())],product_sku:`SKU-${String(t+1).padStart(4,"0")}`,is_primary_principal:Math.random()>.5,exclusive_rights:Math.random()>.7,wholesale_price:Math.floor(1e3*Math.random())+100,minimum_order_quantity:Math.floor(500*Math.random())+50,lead_time_days:Math.floor(30*Math.random())+7,contract_start_date:new Date(Date.now()-365*Math.random()*24*60*60*1e3).toISOString(),contract_end_date:new Date(Date.now()+730*Math.random()*24*60*60*1e3).toISOString(),territory_restrictions:null,opportunities_for_product:Math.floor(25*Math.random())+5,won_opportunities_for_product:Math.floor(10*Math.random())+1,active_opportunities_for_product:Math.floor(15*Math.random())+3,latest_opportunity_date:new Date(Date.now()-90*Math.random()*24*60*60*1e3).toISOString(),avg_opportunity_probability:Math.floor(60*Math.random())+20,total_opportunities:Math.floor(25*Math.random())+5,win_rate:Math.floor(50*Math.random())+25,total_value:Math.floor(2e5*Math.random())+5e4,interactions_for_product:Math.floor(20*Math.random())+5,recent_interactions_for_product:Math.floor(5*Math.random())+1,last_interaction_date:new Date(Date.now()-60*Math.random()*24*60*60*1e3).toISOString(),product_is_active:Math.random()>.1,launch_date:new Date(Date.now()-1095*Math.random()*24*60*60*1e3).toISOString(),discontinue_date:null,unit_cost:Math.floor(500*Math.random())+50,suggested_retail_price:Math.floor(1500*Math.random())+200,contract_status:["ACTIVE","PENDING","EXPIRED","EXPIRING_SOON"][Math.floor(4*Math.random())],product_performance_score:Math.floor(60*Math.random())+30,relationship_created_at:new Date(Date.now()-730*Math.random()*24*60*60*1e3).toISOString(),relationship_updated_at:new Date(Date.now()-30*Math.random()*24*60*60*1e3).toISOString()}))}catch(e){lt.value=e instanceof Error?e.message:"Failed to load product data"}finally{ot.value=!1}}},bt=e=>e>=1e6?`$${(e/1e6).toFixed(1)}M`:e>=1e3?`$${(e/1e3).toFixed(0)}K`:`$${e.toFixed(0)}`,ht=e=>{let t;t="string"==typeof e?it.value?.find(t=>t.product_id===e):e},yt=e=>{let t;t="string"==typeof e?it.value?.find(t=>t.product_id===e):e,t&&O.push({path:"/opportunities/new",query:{principalId:et.value?.id,productId:t.product_id}})},_t=()=>{};return s(et,()=>{et.value?ft():it.value=[]},{immediate:!1}),r(async()=>{0===Qe.principals.length&&await Qe.fetchPrincipals();const e=Ye.params.principalId;if(e){const t=Qe.principals.find(t=>t.id===e);t&&(et.value=t)}}),(e,t)=>(i(),o(M,null,{default:l(()=>[n("div",U,[n("div",R,[n("div",W,[t[8]||(t[8]=n("div",{class:"mb-4 sm:mb-0"},[n("h1",{class:"text-2xl font-bold text-gray-900"},"Product Portfolio"),n("p",{class:"mt-1 text-sm text-gray-500"}," Manage products and analyze performance metrics ")],-1)),n("div",G,[n("button",{onClick:_t,disabled:!et.value,class:"inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed min-h-[44px]"},[u(m(C),{class:"h-4 w-4 mr-2"}),t[7]||(t[7]=p(" Manage Products ",-1))],8,K),n("div",X,[n("button",{onClick:t[0]||(t[0]=e=>tt.value="grid"),class:g(["px-4 py-2 text-sm font-medium rounded-l-md border min-h-[44px]","grid"===tt.value?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])},[u(m(V),{class:"h-4 w-4"})],2),n("button",{onClick:t[1]||(t[1]=e=>tt.value="table"),class:g(["px-4 py-2 text-sm font-medium rounded-r-md border-t border-r border-b min-h-[44px]","table"===tt.value?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])},[u(m(T),{class:"h-4 w-4"})],2)])])])]),n("div",F,[u(P,{modelValue:et.value,"onUpdate:modelValue":t[2]||(t[2]=e=>et.value=e),loading:nt.value,error:ct.value,placeholder:"Select a principal to view their product portfolio...",class:"w-full"},null,8,["modelValue","loading","error"])]),ot.value&&et.value?(i(),c("div",H,t[9]||(t[9]=[n("div",{class:"text-center"},[n("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),n("p",{class:"mt-4 text-sm text-gray-500"},"Loading product portfolio...")],-1)]))):et.value?et.value?(i(),c("div",Z,[n("div",J,[n("div",Y,[n("div",Q,[n("div",ee,[u(m($),{class:"h-6 w-6 text-blue-500"})]),n("div",te,[t[12]||(t[12]=n("p",{class:"text-sm font-medium text-gray-500"},"Active Products",-1)),n("p",ae,x(it.value?.length||0),1)])])]),n("div",se,[n("div",re,[n("div",oe,[u(m(E),{class:"h-6 w-6 text-green-500"})]),n("div",le,[t[13]||(t[13]=n("p",{class:"text-sm font-medium text-gray-500"},"Avg Performance",-1)),n("p",ie,x(Math.round(dt.value)),1)])])]),n("div",ne,[n("div",ce,[n("div",de,[u(m(A),{class:"h-6 w-6 text-purple-500"})]),n("div",ue,[t[14]||(t[14]=n("p",{class:"text-sm font-medium text-gray-500"},"Total Opportunities",-1)),n("p",pe,x(ut.value),1)])])]),n("div",me,[n("div",ge,[n("div",xe,[u(m(I),{class:"h-6 w-6 text-yellow-500"})]),n("div",fe,[t[15]||(t[15]=n("p",{class:"text-sm font-medium text-gray-500"},"Total Value",-1)),n("p",be,x(bt(pt.value)),1)])])])]),n("div",he,[n("div",ye,[n("div",_e,[u(m(N),{class:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),f(n("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>at.value=e),type:"text",placeholder:"Search products...",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 min-h-[44px]"},null,512),[[b,at.value]])])]),f(n("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>st.value=e),class:"block w-full sm:w-48 px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[44px]"},t[16]||(t[16]=[n("option",{value:""},"All Performance Levels",-1),n("option",{value:"high"},"High (70-100)",-1),n("option",{value:"medium"},"Medium (40-69)",-1),n("option",{value:"low"},"Low (0-39)",-1)]),512),[[h,st.value]]),f(n("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>rt.value=e),class:"block w-full sm:w-48 px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[44px]"},t[17]||(t[17]=[n("option",{value:"performance"},"Sort by Performance",-1),n("option",{value:"name"},"Sort by Name",-1),n("option",{value:"opportunities"},"Sort by Opportunities",-1),n("option",{value:"value"},"Sort by Value",-1)]),512),[[h,rt.value]])]),"grid"===tt.value?(i(),c("div",ve,[(i(!0),c(y,null,_(mt.value,e=>(i(),c("div",{key:e.product_id,class:"bg-white rounded-lg border border-gray-200 hover:border-gray-300 transition-colors duration-200"},[n("div",we,[n("div",Me,[n("div",Pe,[n("h3",je,x(e.product_name),1),n("p",ke,x(e.total_opportunities)+" opportunities ",1)]),u(j,{score:e.product_performance_score||0,size:"md","show-label":!0},null,8,["score"])])]),n("div",Se,[n("div",De,[n("div",null,[t[18]||(t[18]=n("p",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide"},"Win Rate",-1)),n("p",Ce,x(Math.round(e.win_rate||0))+"% ",1)]),n("div",null,[t[19]||(t[19]=n("p",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide"},"Total Value",-1)),n("p",Ve,x(bt(e.total_value||0)),1)])])]),n("div",Te,[n("div",$e,[n("button",{onClick:t=>ht(e),class:"flex-1 text-center px-3 py-2 text-sm font-medium text-blue-600 bg-blue-100 rounded-md hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-[44px] flex items-center justify-center"},[u(m(z),{class:"h-4 w-4 mr-1"}),t[20]||(t[20]=p(" View Details ",-1))],8,Ee),n("button",{onClick:t=>yt(e),class:"flex-1 text-center px-3 py-2 text-sm font-medium text-green-600 bg-green-100 rounded-md hover:bg-green-200 focus:outline-none focus:ring-2 focus:ring-green-500 min-h-[44px] flex items-center justify-center"},[u(m(L),{class:"h-4 w-4 mr-1"}),t[21]||(t[21]=p(" New Opp ",-1))],8,Ae)])])]))),128)),0===mt.value.length?(i(),c("div",Ie,[u(m(N),{class:"mx-auto h-12 w-12 text-gray-400"}),t[22]||(t[22]=n("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"No products found",-1)),t[23]||(t[23]=n("p",{class:"mt-2 text-sm text-gray-500"}," Try adjusting your search or filter criteria. ",-1))])):d("",!0)])):(i(),c("div",Ne,[u(S,{products:mt.value,loading:ot.value,"view-mode":"table","show-actions":!0,onViewDetails:ht,onCreateOpportunity:t[6]||(t[6]=e=>yt(e))},null,8,["products","loading"])])),n("div",ze,[t[26]||(t[26]=n("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Performance Analysis",-1)),n("div",Le,[n("div",Be,[u(m(k),{data:it.value||[],"principal-name":et.value?.name},null,8,["data","principal-name"])]),n("div",Oe,[n("div",null,[t[24]||(t[24]=n("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"Top Performers",-1)),n("div",Ue,[(i(!0),c(y,null,_(gt.value,e=>(i(),c("div",{key:`top-${e.product_id}`,class:"flex items-center justify-between p-3 bg-green-50 rounded-lg"},[n("div",Re,[n("p",We,x(e.product_name),1),n("p",Ge,x(e.total_opportunities)+" opps • "+x(Math.round(e.win_rate||0))+"% win rate ",1)]),u(j,{score:e.product_performance_score||0,size:"sm","show-label":!1},null,8,["score"])]))),128))])]),n("div",null,[t[25]||(t[25]=n("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"Needs Attention",-1)),n("div",Ke,[(i(!0),c(y,null,_(xt.value,e=>(i(),c("div",{key:`bottom-${e.product_id}`,class:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg"},[n("div",Xe,[n("p",Fe,x(e.product_name),1),n("p",He,x(e.total_opportunities)+" opps • "+x(Math.round(e.win_rate||0))+"% win rate ",1)]),u(j,{score:e.product_performance_score||0,size:"sm","show-label":!1},null,8,["score"])]))),128))])])])])])])):d("",!0):(i(),c("div",q,[u(m($),{class:"mx-auto h-16 w-16 text-gray-400"}),t[10]||(t[10]=n("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"Product Portfolio",-1)),t[11]||(t[11]=n("p",{class:"mt-2 text-sm text-gray-500"}," Select a principal above to view and manage their product portfolio and performance metrics. ",-1))])),lt.value?(i(),c("div",qe,[n("div",Ze,[u(m(B),{class:"h-5 w-5 text-red-400 mr-3 flex-shrink-0"}),n("div",null,[t[27]||(t[27]=n("h3",{class:"text-sm font-medium text-red-800"},"Error Loading Products",-1)),n("p",Je,x(lt.value),1),n("button",{onClick:ft,class:"mt-2 text-sm font-medium text-red-800 hover:text-red-900"}," Try again ")])])])):d("",!0)])]),o:1}))}}),[["__scopeId","data-v-9e6a9af6"]]);export{Ye as default};
