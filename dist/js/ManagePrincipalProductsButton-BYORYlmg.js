import{A as e,E as t}from"./EngagementScoreRing-BHsysYHG.js";import{N as a,x as s,S as l,Z as o,Y as r,K as n,k as i,j as c,V as d,$ as u,a0 as m,a1 as p,_ as f,e as g,b,a as y,a2 as x,y as v,a3 as h,r as w,d as _,a4 as k}from"./heroicons-QXV26b6T.js";import{d as C,r as E,c as M,w as A,C as P,J as O,F as D,L as I,W as S,D as T,u as R,U as L,V as N,E as U,O as j,B as V,G as $,_ as F,y as H,K as z,Y as B,a1 as W,z as q,a3 as Y,N as G,M as X,b as J,Z as K,X as Q,a2 as Z}from"./vue-runtime-Ds28nt_E.js";import{P as ee,a as te}from"./ManagePrincipalProductsButton.vue_vue_type_style_index_0_scoped_f75a9cbf_lang-CSAufz2N.js";import{_ as ae}from"./_plugin-vue_export-helper-DYAABpgn.js";import{E as se,A as le,O as oe}from"./OpportunityPipelineChart-laHugPq7.js";import{u as re}from"./productStore-C7_R-7jb.js";import{u as ne}from"./opportunityStore-Cei765hD.js";import{S as ie,Y as ce,h as de,G as ue,V as me}from"./headlessui-C8T9vwtP.js";import{u as pe}from"./principalStore-Bil7HxyJ.js";const fe={class:"principal-activity-timeline"},ge={key:0,class:"space-y-4"},be={key:1,class:"text-center py-8"},ye={key:2,class:"flow-root"},xe={class:"-mb-8"},ve={key:0,class:"absolute top-5 left-4 -ml-px h-full w-0.5 bg-gray-200"},he={class:"relative flex items-start space-x-3"},we={class:"relative"},_e={key:0,class:"absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-blue-600 text-xs font-bold text-white"},ke={class:"min-w-0 flex-1"},Ce={class:"flex items-center justify-between"},Ee={class:"flex items-center space-x-2"},Me={class:"text-sm font-medium text-gray-900"},Ae=["datetime"],Pe={class:"mt-1"},Oe={class:"text-sm text-gray-600"},De={key:0,class:"mt-2"},Ie={class:"flex items-center space-x-2"},Se={class:"flex items-center"},Te={key:0},Re={class:"mt-3 p-3 bg-gray-50 rounded-lg text-sm text-gray-600"},Le={class:"mt-3 flex items-center space-x-3"},Ne=["onClick"],Ue=["onClick"],je=["onClick"],Ve={key:3,class:"mt-6 text-center"},$e=["disabled"],Fe={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 border-2 border-blue-600 rounded-full border-t-transparent"},He=ae(C({t:"PrincipalActivityTimeline",props:{principalId:{},timelineData:{default:()=>[]},loading:{type:Boolean,default:!1},limit:{default:20}},emits:["create-follow-up","view-related","load-more"],setup(t,{emit:f}){const g=t,b=f,y=E([]),x=E(!1),v=E(!0),h=M(()=>{if(!g.timelineData)return[];const e=new Map;return g.timelineData.forEach(t=>{const a=`${t.activity_date}-${t.activity_type}`,s=e.get(a);s?s.activity_count=(s.activity_count||1)+1:e.set(a,{...t,activity_count:1})}),Array.from(e.values()).sort((e,t)=>new Date(t.activity_date).getTime()-new Date(e.activity_date).getTime())}),w=e=>{const t={interaction:d,phone_call:c,email:i,meeting:n,opportunity:r,product_association:o,follow_up:l,document:s,default:a};return t[e]||t.default},_=e=>{const t={interaction:"bg-blue-100",phone_call:"bg-green-100",email:"bg-purple-100",meeting:"bg-orange-100",opportunity:"bg-yellow-100",product_association:"bg-indigo-100",follow_up:"bg-red-100",document:"bg-gray-100",default:"bg-gray-100"};return t[e]||t.default},k=e=>{const t={interaction:"text-blue-600",phone_call:"text-green-600",email:"text-purple-600",meeting:"text-orange-600",opportunity:"text-yellow-600",product_association:"text-indigo-600",follow_up:"text-red-600",document:"text-gray-600",default:"text-gray-600"};return t[e]||t.default},C=e=>{const t={interaction:"Interaction Logged",phone_call:"Phone Call",email:"Email Exchange",meeting:"Meeting Scheduled",opportunity:"Opportunity Created",product_association:"Product Associated",follow_up:"Follow-up Scheduled",document:"Document Shared"}[e.activity_type]||"Activity";return e.activity_count&&e.activity_count>1?`${t} (${e.activity_count})`:t},H=e=>({interaction:`Interaction recorded with ${e.principal_name}`,phone_call:`Phone call with ${e.principal_name}`,email:`Email correspondence with ${e.principal_name}`,meeting:`Meeting scheduled with ${e.principal_name}`,opportunity:`New opportunity created for ${e.principal_name}`,product_association:`Product associated with ${e.principal_name}`,follow_up:`Follow-up scheduled with ${e.principal_name}`,document:`Document shared with ${e.principal_name}`}[e.activity_type]||`Activity with ${e.principal_name}`),z=e=>{const t="string"==typeof e?parseFloat(e):e;return t>=75?"ACTIVE":t>=50?"MODERATE":t>=25?"LOW":"NO_ACTIVITY"},B=e=>{const t="string"==typeof e?parseFloat(e):e;return t>0?u:t<0?m:p},W=e=>{const t="string"==typeof e?parseFloat(e):e;return t>0?"text-green-500":t<0?"text-red-500":"text-gray-400"},q=e=>{const t="string"==typeof e?parseFloat(e):e;return t>0?"text-green-600":t<0?"text-red-600":"text-gray-500"},Y=e=>{const t="string"==typeof e?parseFloat(e):e;return t>0?`+${t.toFixed(1)} points`:t<0?`${t.toFixed(1)} points`:"No impact"},G=e=>["interaction","phone_call","meeting"].includes(e.activity_type),X=e=>["OPPORTUNITY_CREATED","PRODUCT_ASSOCIATION"].includes(e.activity_type),J=e=>"OPPORTUNITY_CREATED"===e.activity_type?"Opportunity":"PRODUCT_ASSOCIATION"===e.activity_type?"Product":"Related Item",K=e=>{const t=new Date(e),a=new Date,s=(a.getTime()-t.getTime())/36e5;return s<1?"Just now":s<24?`${Math.floor(s)}h ago`:s<168?`${Math.floor(s/24)}d ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==a.getFullYear()?"numeric":void 0})},Q=async()=>{x.value=!0,b("load-more"),setTimeout(()=>{x.value=!1},1e3)};return A(()=>g.timelineData,e=>{v.value=e&&e.length>=g.limit}),(t,s)=>(U(),P("div",fe,[t.loading?(U(),P("div",ge,[(U(),P(D,null,I(5,e=>T("div",{key:e,class:"animate-pulse"},s[0]||(s[0]=[j('<div class="flex space-x-3" data-v-751f85f1><div class="w-8 h-8 bg-gray-200 rounded-full" data-v-751f85f1></div><div class="flex-1 space-y-2" data-v-751f85f1><div class="h-4 bg-gray-200 rounded w-3/4" data-v-751f85f1></div><div class="h-3 bg-gray-200 rounded w-1/2" data-v-751f85f1></div></div></div>',1)]))),64))])):t.timelineData&&0!==t.timelineData.length?(U(),P("div",ye,[T("ul",xe,[(U(!0),P(D,null,I(h.value,(t,a)=>(U(),P("li",{key:`${t.activity_date}-${a}`,class:"relative"},[a<h.value.length-1?(U(),P("div",ve)):O("",!0),T("div",he,[T("div",we,[T("div",{class:V(["flex h-8 w-8 items-center justify-center rounded-full ring-8 ring-white",_(t.activity_type)])},[(U(),$(F(w(t.activity_type)),{class:V(["h-4 w-4",k(t.activity_type)])},null,8,["class"]))],2),t.activity_count&&t.activity_count>1?(U(),P("div",_e,N(t.activity_count),1)):O("",!0)]),T("div",ke,[T("div",Ce,[T("div",Ee,[T("h4",Me,N(C(t)),1),t.timeline_rank?(U(),$(e,{key:0,status:z(t.timeline_rank),size:"xs"},null,8,["status"])):O("",!0)]),T("time",{class:"text-sm text-gray-500",datetime:t.activity_date},N(K(t.activity_date)),9,Ae)]),T("div",Pe,[T("p",Oe,N(H(t)),1),t.timeline_rank?(U(),P("div",De,[T("div",Ie,[s[3]||(s[3]=T("span",{class:"text-xs font-medium text-gray-700"},"Timeline Rank:",-1)),T("div",Se,[(U(),$(F(B(t.timeline_rank)),{class:V(["h-3 w-3 mr-1",W(t.timeline_rank)])},null,8,["class"])),T("span",{class:V(["text-xs font-medium",q(t.timeline_rank)])},N(Y(t.timeline_rank)),3)])])])):O("",!0)]),t.activity_details&&y.value.includes(t.activity_date)?(U(),P("div",Te,[T("div",Re,N(t.activity_details),1)])):O("",!0),T("div",Le,[t.activity_details?(U(),P("button",{key:0,onClick:e=>(e=>{const t=y.value.indexOf(e);t>=0?y.value.splice(t,1):y.value.push(e)})(t.activity_date),class:"text-xs text-blue-600 hover:text-blue-800 font-medium"},N(y.value.includes(t.activity_date)?"Show Less":"Show Details"),9,Ne)):O("",!0),G(t)?(U(),P("button",{key:1,onClick:e=>(e=>{b("create-follow-up",e)})(t),class:"text-xs text-green-600 hover:text-green-800 font-medium"}," Create Follow-up ",8,Ue)):O("",!0),X(t)?(U(),P("button",{key:2,onClick:e=>(e=>{const t=J(e);b("view-related",e,t)})(t),class:"text-xs text-purple-600 hover:text-purple-800 font-medium"}," View "+N(J(t)),9,je)):O("",!0)])])])]))),128))])])):(U(),P("div",be,[S(R(a),{class:"mx-auto h-12 w-12 text-gray-400"}),s[1]||(s[1]=T("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"No Activity Found",-1)),s[2]||(s[2]=T("p",{class:"mt-2 text-gray-600"}," No recent activities have been recorded for this principal. ",-1))])),v.value?(U(),P("div",Ve,[T("button",{onClick:Q,disabled:x.value,class:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[x.value?(U(),P("div",Fe)):O("",!0),L(" "+N(x.value?"Loading...":"Load More Activities"),1)],8,$e)])):O("",!0)]))}}),[["__scopeId","data-v-751f85f1"]]),ze={class:"principal-analytics-chart"},Be={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6"},We={class:"flex items-center space-x-4 mb-4 sm:mb-0"},qe={class:"flex items-center space-x-2"},Ye=["onClick"],Ge={class:"flex items-center space-x-4"},Xe=["disabled"],Je={key:0,class:"flex items-center justify-center h-64 bg-gray-50 rounded-lg"},Ke={key:1,class:"flex items-center justify-center h-64 bg-red-50 rounded-lg border border-red-200"},Qe={class:"text-center"},Ze={class:"mt-2 text-sm text-red-600"},et={key:2,class:"bg-white"},tt={key:0,class:"h-64"},at={key:1,class:"h-64"},st={key:2,class:"h-64"},lt={key:3,class:"h-64"},ot={class:"mt-4 flex flex-wrap items-center justify-center space-x-6 text-sm"},rt={class:"text-gray-600"},nt={class:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4"},it={class:"flex items-center"},ct={class:"text-sm font-medium text-gray-700"},dt={class:"mt-1 text-2xl font-semibold text-gray-900"},ut={class:"text-sm text-gray-600"},mt=ae(C({t:"PrincipalAnalyticsChart",props:{principalId:{},activityData:{default:()=>[]},productPerformanceData:{default:()=>[]},loading:{type:Boolean,default:!1},principalName:{default:"Principal"}},emits:["refresh","time-range-change","chart-type-change"],setup(e,{emit:t}){const a=e,s=t,o=E("engagement"),r=E("30d"),n=E(null),i=[{value:"engagement",label:"Engagement"},{value:"activity",label:"Activity"},{value:"products",label:"Products"},{value:"opportunities",label:"Opportunities"}],c=M(()=>a.activityData&&0!==a.activityData.length?a.activityData.map(e=>({date:e.activity_date,engagement_score:e.timeline_rank||100*Math.random(),activity_type:e.activity_type,principal_name:e.principal_name})):[]),d=M(()=>{if(!a.activityData||0===a.activityData.length)return[];const e=new Map;return a.activityData.forEach(t=>{const a=t.activity_date.split("T")[0],s=e.get(a);s?(s.count++,s.types.includes(t.activity_type)||s.types.push(t.activity_type)):e.set(a,{date:a,count:1,types:[t.activity_type]})}),Array.from(e.values()).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime())}),m=M(()=>[{stage:"NEW_LEAD",count:2,value:5e4},{stage:"INITIAL_OUTREACH",count:1,value:25e3},{stage:"SAMPLE_VISIT_OFFERED",count:3,value:75e3},{stage:"AWAITING_RESPONSE",count:1,value:3e4},{stage:"DEMO_SCHEDULED",count:1,value:4e4}]),p=M(()=>{const e=[],t=c.value.reduce((e,t)=>e+t.engagement_score,0)/(c.value.length||1);e.push({label:"Avg Engagement",value:t.toFixed(1),description:"Average engagement score",icon:u,iconColor:t>=70?"text-green-500":t>=40?"text-yellow-500":"text-red-500"});const s=d.value.reduce((e,t)=>e+t.count,0)/(d.value.length||1);e.push({label:"Daily Activity",value:s.toFixed(1),description:"Average activities per day",icon:l,iconColor:"text-blue-500"});const o=a.productPerformanceData?.length||0;return e.push({label:"Products",value:o.toString(),description:"Associated products",icon:f,iconColor:"text-purple-500"}),e}),y=()=>{n.value=null,s("refresh")};return A(r,e=>{s("time-range-change",e)}),A(o,e=>{s("chart-type-change",e)}),H(()=>{y()}),(e,t)=>(U(),P("div",ze,[T("div",Be,[T("div",We,[t[1]||(t[1]=T("h3",{class:"text-lg font-medium text-gray-900"},"Performance Analytics",-1)),T("div",qe,[(U(),P(D,null,I(i,e=>T("button",{key:e.value,onClick:t=>o.value=e.value,class:V(["px-3 py-1.5 text-sm font-medium rounded-md transition-colors",[o.value===e.value?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"]])},N(e.label),11,Ye)),64))])]),T("div",Ge,[z(T("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),class:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"},t[2]||(t[2]=[T("option",{value:"7d"},"Last 7 days",-1),T("option",{value:"30d"},"Last 30 days",-1),T("option",{value:"90d"},"Last 90 days",-1),T("option",{value:"1y"},"Last year",-1)]),512),[[B,r.value]]),T("button",{onClick:y,disabled:e.loading,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[S(R(g),{class:V(["h-4 w-4",{"animate-spin":e.loading}])},null,8,["class"])],8,Xe)])]),e.loading?(U(),P("div",Je,t[3]||(t[3]=[T("div",{class:"text-center"},[T("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),T("p",{class:"mt-2 text-sm text-gray-600"},"Loading analytics...")],-1)]))):n.value?(U(),P("div",Ke,[T("div",Qe,[S(R(b),{class:"h-8 w-8 text-red-400 mx-auto"}),T("p",Ze,N(n.value),1),T("button",{onClick:y,class:"mt-2 text-sm text-red-600 hover:text-red-800 underline"}," Try again ")])])):(U(),P("div",et,["engagement"===o.value?(U(),P("div",tt,[S(se,{data:c.value,"time-range":r.value,"principal-name":e.principalName},null,8,["data","time-range","principal-name"])])):"activity"===o.value?(U(),P("div",at,[S(le,{data:d.value,"time-range":r.value,"principal-name":e.principalName},null,8,["data","time-range","principal-name"])])):"products"===o.value?(U(),P("div",st,[S(ee,{data:e.productPerformanceData,"principal-name":e.principalName},null,8,["data","principal-name"])])):"opportunities"===o.value?(U(),P("div",lt,[S(oe,{data:m.value,"principal-name":e.principalName},null,8,["data","principal-name"])])):O("",!0)])),T("div",ot,[(U(!0),P(D,null,I({engagement:[{label:"Engagement Score",color:"#3b82f6"},{label:"Trend Line",color:"#10b981"}],activity:[{label:"Interactions",color:"#3b82f6"},{label:"Meetings",color:"#f59e0b"},{label:"Opportunities",color:"#ef4444"}],products:[{label:"High Performance",color:"#10b981"},{label:"Medium Performance",color:"#f59e0b"},{label:"Low Performance",color:"#ef4444"}],opportunities:[{label:"Pipeline Value",color:"#3b82f6"},{label:"Count",color:"#8b5cf6"}]}[o.value]||[],e=>(U(),P("div",{key:e.label,class:"flex items-center space-x-2"},[T("div",{class:"w-3 h-3 rounded-full",style:W({backgroundColor:e.color})},null,4),T("span",rt,N(e.label),1)]))),128))]),T("div",nt,[(U(!0),P(D,null,I(p.value,e=>(U(),P("div",{key:e.label,class:"bg-gray-50 rounded-lg p-4"},[T("div",it,[(U(),$(F(e.icon),{class:V(["h-5 w-5 mr-2",e.iconColor])},null,8,["class"])),T("span",ct,N(e.label),1)]),T("p",dt,N(e.value),1),T("p",ut,N(e.description),1)]))),128))])]))}}),[["__scopeId","data-v-f1916a3a"]]),pt={class:"principal-action-bar flex items-center space-x-3"},ft={class:"flex items-center space-x-2"},gt=["disabled"],bt=["disabled"],yt=["disabled"],xt={class:"absolute right-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},vt={class:"py-1"},ht=["disabled"],wt={key:0,class:"flex items-center space-x-2 text-sm text-gray-600"},_t={class:"flex items-center"},kt=ae(C({t:"PrincipalActionBar",props:{selectedPrincipal:{default:null},permissions:{default:()=>({canCreateOpportunity:!0,canLogInteraction:!0,canManageProducts:!0,canScheduleFollowUp:!0,canExportData:!0,canManageSettings:!1})},loading:{type:Boolean,default:!1}},emits:["create-opportunity","log-interaction","manage-products","schedule-follow-up","view-analytics","export-data","refresh","principal-settings"],setup(e,{emit:t}){const a=e,s=t,r=E(!1),n=E(),i=E(!1),c=M(()=>!1!==a.permissions?.canCreateOpportunity),u=M(()=>!1!==a.permissions?.canLogInteraction),m=M(()=>!1!==a.permissions?.canManageProducts),p=M(()=>!1!==a.permissions?.canScheduleFollowUp),b=M(()=>!1!==a.permissions?.canExportData),w=M(()=>!0===a.permissions?.canManageSettings),_=()=>{a.selectedPrincipal&&(s("create-opportunity"),r.value=!1)},k=()=>{a.selectedPrincipal&&(s("log-interaction"),r.value=!1)},C=()=>{a.selectedPrincipal&&(s("manage-products"),r.value=!1)},A=()=>{a.selectedPrincipal&&(s("schedule-follow-up"),r.value=!1)},D=()=>{a.selectedPrincipal&&(s("view-analytics"),r.value=!1)},I=()=>{a.selectedPrincipal&&(s("export-data"),r.value=!1)},j=async()=>{i.value=!0,s("refresh"),setTimeout(()=>{i.value=!1,r.value=!1},1e3)},$=()=>{a.selectedPrincipal&&(s("principal-settings"),r.value=!1)},F=e=>{if(a.selectedPrincipal&&!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLSelectElement)){if(e.ctrlKey||e.metaKey)switch(e.key){case"o":e.preventDefault(),c.value&&_();break;case"i":e.preventDefault(),u.value&&k();break;case"r":e.preventDefault(),j();break;case"p":e.preventDefault(),m.value&&C()}"Escape"===e.key&&(r.value=!1)}},B=e=>{const t=e.target;n.value&&!n.value.contains(t)&&(r.value=!1)};return H(()=>{document.addEventListener("keydown",F),document.addEventListener("click",B)}),q(()=>{document.removeEventListener("keydown",F),document.removeEventListener("click",B)}),(e,t)=>(U(),P("div",pt,[T("div",ft,[c.value?(U(),P("button",{key:0,onClick:_,disabled:!e.selectedPrincipal,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"},[S(R(y),{class:"h-4 w-4 mr-2"}),t[1]||(t[1]=L(" Create Opportunity ",-1))],8,gt)):O("",!0),u.value?(U(),P("button",{key:1,onClick:k,disabled:!e.selectedPrincipal,class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"},[S(R(d),{class:"h-4 w-4 mr-2"}),t[2]||(t[2]=L(" Log Interaction ",-1))],8,bt)):O("",!0)]),T("div",{class:"relative",ref_key:"dropdownRef",ref:n},[T("button",{onClick:t[0]||(t[0]=e=>r.value=!r.value),disabled:!e.selectedPrincipal,class:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"},[S(R(x),{class:"h-4 w-4"}),t[3]||(t[3]=T("span",{class:"sr-only"},"More actions",-1))],8,yt),S(Y,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:G(()=>[z(T("div",xt,[T("div",vt,[m.value?(U(),P("button",{key:0,onClick:C,class:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 transition-colors duration-150"},[S(R(o),{class:"h-4 w-4 mr-3"}),t[4]||(t[4]=L(" Manage Products ",-1))])):O("",!0),p.value?(U(),P("button",{key:1,onClick:A,class:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 transition-colors duration-150"},[S(R(l),{class:"h-4 w-4 mr-3"}),t[5]||(t[5]=L(" Schedule Follow-up ",-1))])):O("",!0),T("button",{onClick:D,class:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 transition-colors duration-150"},[S(R(f),{class:"h-4 w-4 mr-3"}),t[6]||(t[6]=L(" View Analytics ",-1))]),b.value?(U(),P("button",{key:2,onClick:I,class:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 transition-colors duration-150"},[S(R(v),{class:"h-4 w-4 mr-3"}),t[7]||(t[7]=L(" Export Data ",-1))])):O("",!0),t[9]||(t[9]=T("div",{class:"border-t border-gray-100 my-1"},null,-1)),T("button",{onClick:j,disabled:i.value,class:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"},[S(R(g),{class:V(["h-4 w-4 mr-3",{"animate-spin":i.value}])},null,8,["class"]),L(" "+N(i.value?"Refreshing...":"Refresh Data"),1)],8,ht),w.value?(U(),P("button",{key:3,onClick:$,class:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 transition-colors duration-150"},[S(R(h),{class:"h-4 w-4 mr-3"}),t[8]||(t[8]=L(" Principal Settings ",-1))])):O("",!0)])],512),[[X,r.value]])]),l:1})],512),e.selectedPrincipal?(U(),P("div",wt,[T("div",_t,[T("div",{class:V(["w-2 h-2 rounded-full mr-1",a.selectedPrincipal&&{ACTIVE:"bg-green-400",MODERATE:"bg-yellow-400",LOW:"bg-orange-400",NO_ACTIVITY:"bg-gray-400"}[a.selectedPrincipal.activity_status]||"bg-gray-400"])},null,2),T("span",null,N(a.selectedPrincipal?`${a.selectedPrincipal.engagement_score||0} engagement • ${a.selectedPrincipal.total_interactions||0} interactions`:"No principal selected"),1)])])):O("",!0)]))}}),[["__scopeId","data-v-d95a192f"]]),Ct={class:"create-principal-opportunity-button"},Et=["disabled"],Mt={class:"fixed inset-0 z-10 w-screen overflow-y-auto"},At={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},Pt={class:"flex items-center justify-between mb-4"},Ot={class:"mt-1 text-sm text-gray-600"},Dt={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md"},It={class:"flex"},St={class:"ml-3"},Tt={class:"text-sm text-red-700"},Rt={class:"space-y-4"},Lt={class:"mt-1 p-3 bg-gray-50 border border-gray-200 rounded-md"},Nt={class:"flex items-center justify-between"},Ut={class:"text-sm font-medium text-gray-900"},jt={class:"text-xs text-gray-500"},Vt={key:0,class:"mt-1 text-sm text-red-600"},$t={key:0,class:"mt-1 text-sm text-red-600"},Ft={key:0},Ht=["value"],zt=["min"],Bt={class:"mt-1 flex items-center space-x-3"},Wt={class:"text-sm font-medium text-gray-700 w-12 text-right"},qt={class:"mt-6 flex items-center justify-end space-x-3"},Yt=["disabled"],Gt={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 border-2 border-white rounded-full border-t-transparent"},Xt=ae(C({t:"CreatePrincipalOpportunityButton",props:{principal:{default:null}},emits:["created"],setup(e,{emit:a}){const s=e,l=a,o=re(),r=ne(),n=E(!1),i=E(!1),c=E(null),d=J({name:"",context:"",customContext:"",productId:"",stage:"NEW_LEAD",expectedCloseDate:"",probability:25,notes:""}),u=J({name:"",context:""}),m=M(()=>o.products.filter(e=>e.is_active)),p=M(()=>""!==d.name.trim()&&""!==d.context&&("OTHER"!==d.context||""!==d.customContext.trim())),f=()=>{s.principal&&(v(),k(),n.value=!0)},g=()=>{n.value=!1,v(),c.value=null},x=async()=>{if(p.value&&s.principal&&(h(),_())){i.value=!0,c.value=null;try{const e={name:d.name,organization_id:s.principal.principal_id,principal_id:s.principal.principal_id,product_id:d.productId||null,stage:d.stage,context:d.context,custom_context:"OTHER"===d.context?d.customContext:null,expected_close_date:d.expectedCloseDate||null,probability_percent:d.probability,notes:d.notes||null,deal_owner:"Current User"},t=await r.createOpportunity(e);t?(l("created",t),g()):c.value="Failed to create opportunity. Please try again."}catch(e){c.value=e instanceof Error?e.message:"An unexpected error occurred"}finally{i.value=!1}}},v=()=>{d.name="",d.context="",d.customContext="",d.productId="",d.stage="NEW_LEAD",d.expectedCloseDate="",d.probability=25,d.notes="",h()},h=()=>{u.name="",u.context=""},_=()=>{let e=!0;return d.name.trim()||(u.name="Opportunity name is required",e=!1),d.context||(u.context="Context is required",e=!1),e},k=()=>{if(!s.principal)return;const e=(new Date).toLocaleDateString("en-US",{month:"long",year:"numeric"});d.name=`${s.principal.organization_type||"Organization"} - ${s.principal.principal_name} - ${e}`};return A(()=>d.context,e=>{"OTHER"!==e&&(d.customContext="")}),H(async()=>{0===o.products.length&&await o.fetchProducts()}),(e,a)=>(U(),P("div",Ct,[T("button",{onClick:f,disabled:!e.principal||i.value,class:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-blue-600 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"},[S(R(y),{class:"h-4 w-4 mr-1"}),L(" "+N(i.value?"Creating...":"New Opportunity"),1)],8,Et),S(R(ie),{as:"template",show:n.value},{default:G(()=>[S(R(ce),{as:"div",class:"relative z-50",onClose:g},{default:G(()=>[S(R(de),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:G(()=>a[8]||(a[8]=[T("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)])),l:1,o:[8]}),T("div",Mt,[T("div",At,[S(R(de),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:G(()=>[S(R(ue),{class:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},{default:G(()=>[T("div",Pt,[T("div",null,[S(R(me),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900"},{default:G(()=>a[9]||(a[9]=[L(" Create Opportunity ",-1)])),l:1,o:[9]}),T("p",Ot," Create a new opportunity for "+N(e.principal?.principal_name),1)]),T("button",{onClick:g,class:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500"},[S(R(w),{class:"h-6 w-6"})])]),c.value?(U(),P("div",Dt,[T("div",It,[S(R(b),{class:"h-5 w-5 text-red-400"}),T("div",St,[T("p",Tt,N(c.value),1)])])])):O("",!0),T("form",{onSubmit:K(x,["prevent"])},[T("div",Rt,[T("div",null,[a[10]||(a[10]=T("label",{class:"block text-sm font-medium text-gray-700"},"Principal",-1)),T("div",Lt,[T("div",Nt,[T("div",null,[T("p",Ut,N(e.principal?.principal_name),1),T("p",jt,N(e.principal?.organization_type||"No organization type"),1)]),S(t,{score:e.principal?.engagement_score||0,size:"sm"},null,8,["score"])])])]),T("div",null,[a[11]||(a[11]=T("label",{for:"opportunity-name",class:"block text-sm font-medium text-gray-700"}," Opportunity Name * ",-1)),z(T("input",{id:"opportunity-name","onUpdate:modelValue":a[0]||(a[0]=e=>d.name=e),type:"text",required:"",class:V(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",{"border-red-300":u.name}]),placeholder:"Enter opportunity name..."},null,2),[[Q,d.name]]),u.name?(U(),P("p",Vt,N(u.name),1)):O("",!0)]),T("div",null,[a[13]||(a[13]=T("label",{for:"context",class:"block text-sm font-medium text-gray-700"}," Context * ",-1)),z(T("select",{id:"context","onUpdate:modelValue":a[1]||(a[1]=e=>d.context=e),required:"",class:V(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",{"border-red-300":u.context}])},a[12]||(a[12]=[T("option",{value:""},"Select context...",-1),T("option",{value:"SAMPLE_REQUEST"},"Sample Request",-1),T("option",{value:"PRICE_INQUIRY"},"Price Inquiry",-1),T("option",{value:"PRODUCT_INTEREST"},"Product Interest",-1),T("option",{value:"REFERRAL"},"Referral",-1),T("option",{value:"COLD_OUTREACH"},"Cold Outreach",-1),T("option",{value:"OTHER"},"Other",-1)]),2),[[B,d.context]]),u.context?(U(),P("p",$t,N(u.context),1)):O("",!0)]),"OTHER"===d.context?(U(),P("div",Ft,[a[14]||(a[14]=T("label",{for:"custom-context",class:"block text-sm font-medium text-gray-700"}," Custom Context * ",-1)),z(T("input",{id:"custom-context","onUpdate:modelValue":a[2]||(a[2]=e=>d.customContext=e),type:"text",required:"",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Describe the context..."},null,512),[[Q,d.customContext]])])):O("",!0),T("div",null,[a[16]||(a[16]=T("label",{for:"product",class:"block text-sm font-medium text-gray-700"}," Product ",-1)),z(T("select",{id:"product","onUpdate:modelValue":a[3]||(a[3]=e=>d.productId=e),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},[a[15]||(a[15]=T("option",{value:""},"Select product...",-1)),(U(!0),P(D,null,I(m.value,e=>(U(),P("option",{key:e.id,value:e.id},N(e.name),9,Ht))),128))],512),[[B,d.productId]])]),T("div",null,[a[18]||(a[18]=T("label",{for:"stage",class:"block text-sm font-medium text-gray-700"}," Initial Stage ",-1)),z(T("select",{id:"stage","onUpdate:modelValue":a[4]||(a[4]=e=>d.stage=e),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},a[17]||(a[17]=[T("option",{value:"NEW_LEAD"},"New Lead",-1),T("option",{value:"INITIAL_OUTREACH"},"Initial Outreach",-1),T("option",{value:"SAMPLE_VISIT_OFFERED"},"Sample Visit Offered",-1)]),512),[[B,d.stage]])]),T("div",null,[a[19]||(a[19]=T("label",{for:"close-date",class:"block text-sm font-medium text-gray-700"}," Expected Close Date ",-1)),z(T("input",{id:"close-date","onUpdate:modelValue":a[5]||(a[5]=e=>d.expectedCloseDate=e),type:"date",min:(new Date).toISOString().split("T")[0],class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},null,8,zt),[[Q,d.expectedCloseDate]])]),T("div",null,[a[20]||(a[20]=T("label",{for:"probability",class:"block text-sm font-medium text-gray-700"}," Probability (%) ",-1)),T("div",Bt,[z(T("input",{id:"probability","onUpdate:modelValue":a[6]||(a[6]=e=>d.probability=e),type:"range",min:"0",max:"100",step:"5",class:"flex-1"},null,512),[[Q,d.probability,void 0,{number:!0}]]),T("span",Wt,N(d.probability)+"% ",1)])]),T("div",null,[a[21]||(a[21]=T("label",{for:"notes",class:"block text-sm font-medium text-gray-700"}," Notes ",-1)),z(T("textarea",{id:"notes","onUpdate:modelValue":a[7]||(a[7]=e=>d.notes=e),rows:"3",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Additional details about this opportunity..."},null,512),[[Q,d.notes]])])]),T("div",qt,[T("button",{type:"button",onClick:g,class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Cancel "),T("button",{type:"submit",disabled:i.value||!p.value,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[i.value?(U(),P("div",Gt)):O("",!0),L(" "+N(i.value?"Creating...":"Create Opportunity"),1)],8,Yt)])],32)]),l:1})]),l:1})])])]),l:1})]),l:1},8,["show"])]))}}),[["__scopeId","data-v-125f87e0"]]),Jt={class:"manage-principal-products-button"},Kt=["disabled"],Qt={class:"fixed inset-0 z-10 w-screen overflow-y-auto"},Zt={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},ea={class:"flex items-center justify-between mb-6"},ta={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md"},aa={class:"flex"},sa={class:"ml-3"},la={class:"text-sm text-red-700"},oa={key:1,class:"flex items-center justify-center py-8"},ra={key:2,class:"space-y-6"},na={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0"},ia={class:"flex-1 max-w-lg"},ca={class:"relative"},da={class:"flex items-center space-x-3"},ua=["value"],ma=["disabled"],pa={class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5"},fa={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},ga={class:"bg-blue-50 p-4 rounded-lg"},ba={class:"flex items-center"},ya={class:"text-2xl font-bold text-blue-600 mt-1"},xa={class:"bg-green-50 p-4 rounded-lg"},va={class:"flex items-center"},ha={class:"text-2xl font-bold text-green-600 mt-1"},wa={class:"bg-yellow-50 p-4 rounded-lg"},_a={class:"flex items-center"},ka={class:"text-2xl font-bold text-yellow-600 mt-1"},Ca={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ea={class:"border border-gray-200 rounded-lg max-h-96 overflow-y-auto"},Ma={class:"p-3"},Aa={key:0,class:"text-center py-6 text-gray-500"},Pa={key:1,class:"space-y-2"},Oa={class:"flex items-center space-x-3"},Da=["value"],Ia={class:"text-sm font-medium text-gray-900"},Sa={class:"text-xs text-gray-500"},Ta=["onClick","disabled"],Ra={class:"border border-gray-200 rounded-lg max-h-96 overflow-y-auto"},La={class:"p-3"},Na={key:0,class:"text-center py-6 text-gray-500"},Ua={key:1,class:"space-y-2"},ja={class:"flex items-center space-x-3"},Va=["value"],$a={class:"flex-1"},Fa={class:"flex items-center justify-between"},Ha={class:"text-sm font-medium text-gray-900"},za={class:"text-xs text-gray-500"},Ba={class:"text-right"},Wa={class:"mt-2 flex items-center space-x-4 text-xs text-gray-600"},qa=["onClick","disabled"],Ya={class:"mt-6 flex items-center justify-between"},Ga={class:"text-sm text-gray-600"},Xa={class:"flex items-center space-x-3"},Ja=["disabled"],Ka={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 border-2 border-white rounded-full border-t-transparent"},Qa=ae(C({t:"ManagePrincipalProductsButton",props:{principal:{default:null}},emits:["updated"],setup(e,{emit:t}){const a=e,s=t,l=re(),n=pe(),i=E(!1),c=E(!1),d=E(!1),u=E(!1),m=E(null),g=E(""),x=E(""),v=E([]),h=E(!1),C=E(),A=E([]),j=E([]),V=E([]),$=M(()=>{const e=new Set(l.products.map(e=>e.category).filter(e=>Boolean(e)&&null!==e));return Array.from(e).sort()}),F=M(()=>{let e=l.products.filter(e=>e.is_active&&!j.value.includes(e.id));if(g.value){const t=g.value.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.description?.toLowerCase().includes(t)||e.category?.toLowerCase().includes(t))}return x.value&&(e=e.filter(e=>e.category===x.value)),e}),W=M(()=>l.products.filter(e=>j.value.includes(e.id))),Y=M(()=>{const e=new Set(A.value),t=new Set(j.value);return e.size!==t.size||[...e].some(e=>!t.has(e))||[...t].some(t=>!e.has(t))}),J=M(()=>V.value.filter(e=>(e.product_performance_score||0)>=80).length),K=M(()=>0===V.value.length?0:V.value.reduce((e,t)=>e+(t.product_performance_score||0),0)/V.value.length),ee=async()=>{a.principal&&(i.value=!0,await ne())},ae=()=>{i.value=!1,ve()},se=()=>{v.value.forEach(e=>{j.value.includes(e)||j.value.push(e)}),v.value=[],h.value=!1},le=()=>{v.value.forEach(e=>{const t=j.value.indexOf(e);t>=0&&j.value.splice(t,1)}),v.value=[],h.value=!1},oe=async()=>{if(a.principal&&Y.value){u.value=!0,m.value=null;try{const e=new Set(A.value),t=new Set(j.value),l=[...t].filter(t=>!e.has(t)),o=[...e].filter(e=>!t.has(e));l.length>0&&await n.associateProductsWithPrincipals(l,[a.principal.principal_id]),o.length,A.value=[...j.value],s("updated"),ae()}catch(e){m.value=e instanceof Error?e.message:"Failed to save changes"}finally{u.value=!1}}},ne=async()=>{if(a.principal){d.value=!0,m.value=null;try{0===l.products.length&&await l.fetchProducts();const e=await fe(a.principal.principal_id);A.value=e,j.value=[...e],await ge(a.principal.principal_id)}catch(e){m.value=e instanceof Error?e.message:"Failed to load product data"}finally{d.value=!1}}},fe=async e=>["product-1","product-2"],ge=async e=>{V.value=j.value.map(t=>{const s=l.products.find(e=>e.id===t),o=Math.floor(10*Math.random()),r=Math.floor(Math.random()*Math.max(1,o));return{principal_id:e,principal_name:a.principal?.principal_name||"Unknown Principal",product_id:t,product_name:s?.name||"Unknown Product",product_category:s?.category||null,product_sku:s?.sku||null,is_primary_principal:Math.random()>.5,exclusive_rights:Math.random()>.7,wholesale_price:Math.floor(1e3*Math.random())+100,minimum_order_quantity:Math.floor(100*Math.random())+10,lead_time_days:Math.floor(30*Math.random())+5,contract_start_date:new Date(Date.now()-365*Math.random()*24*60*60*1e3).toISOString(),contract_end_date:new Date(Date.now()+365*Math.random()*24*60*60*1e3).toISOString(),territory_restrictions:null,opportunities_for_product:o,won_opportunities_for_product:r,active_opportunities_for_product:Math.floor(Math.random()*(o-r)),latest_opportunity_date:(new Date).toISOString(),avg_opportunity_probability:Math.floor(100*Math.random()),total_opportunities:o,win_rate:o>0?Math.floor(r/o*100):0,total_value:Math.floor(1e5*Math.random()),interactions_for_product:Math.floor(20*Math.random()),recent_interactions_for_product:Math.floor(5*Math.random()),last_interaction_date:(new Date).toISOString(),product_is_active:s?.is_active||!0,launch_date:new Date(Date.now()-730*Math.random()*24*60*60*1e3).toISOString(),discontinue_date:null,unit_cost:Math.floor(500*Math.random())+50,suggested_retail_price:Math.floor(1500*Math.random())+200,contract_status:Math.random()>.8?"EXPIRED":Math.random()>.6?"EXPIRING_SOON":"ACTIVE",product_performance_score:Math.floor(100*Math.random()),relationship_created_at:new Date(Date.now()-365*Math.random()*24*60*60*1e3).toISOString(),relationship_updated_at:(new Date).toISOString()}})},be=e=>{const t=V.value.find(t=>t.product_id===e);return t?.product_performance_score||0},ye=e=>{const t=V.value.find(t=>t.product_id===e);return t?.total_opportunities||0},xe=e=>{const t=V.value.find(t=>t.product_id===e);return Math.round(t?.win_rate||0)},ve=()=>{g.value="",x.value="",v.value=[],h.value=!1,m.value=null,A.value=[],j.value=[],V.value=[]},he=e=>{const t=e.target;C.value&&!C.value.contains(t)&&(h.value=!1)};return H(()=>{document.addEventListener("click",he)}),q(()=>{document.removeEventListener("click",he)}),(e,t)=>(U(),P("div",Jt,[T("button",{onClick:ee,disabled:!e.principal||c.value,class:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"},[S(R(o),{class:"h-4 w-4 mr-1"}),L(" "+N(c.value?"Loading...":"Manage Products"),1)],8,Kt),S(R(ie),{as:"template",show:i.value},{default:G(()=>[S(R(ce),{as:"div",class:"relative z-50",onClose:ae},{default:G(()=>[S(R(de),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:G(()=>t[5]||(t[5]=[T("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)])),l:1,o:[5]}),T("div",Qt,[T("div",Zt,[S(R(de),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:G(()=>[S(R(ue),{class:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-4xl sm:p-6"},{default:G(()=>[T("div",ea,[T("div",null,[S(R(me),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900"},{default:G(()=>[L(" Manage Products for "+N(e.principal?.principal_name),1)]),l:1}),t[6]||(t[6]=T("p",{class:"mt-1 text-sm text-gray-600"}," Associate and manage products for this principal ",-1))]),T("button",{onClick:ae,class:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500"},[S(R(w),{class:"h-6 w-6"})])]),m.value?(U(),P("div",ta,[T("div",aa,[S(R(b),{class:"h-5 w-5 text-red-400"}),T("div",sa,[T("p",la,N(m.value),1)])])])):O("",!0),d.value?(U(),P("div",oa,t[7]||(t[7]=[T("div",{class:"text-center"},[T("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),T("p",{class:"mt-2 text-sm text-gray-600"},"Loading product data...")],-1)]))):(U(),P("div",ra,[T("div",na,[T("div",ia,[T("div",ca,[S(R(_),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),z(T("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),type:"text",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Search products..."},null,512),[[Q,g.value]])])]),T("div",da,[z(T("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>x.value=e),class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},[t[8]||(t[8]=T("option",{value:""},"All Categories",-1)),(U(!0),P(D,null,I($.value,e=>(U(),P("option",{key:e||"null",value:e||""},N(e||"Uncategorized"),9,ua))),128))],512),[[B,x.value]]),T("div",{class:"relative",ref_key:"bulkActionsRef",ref:C},[T("button",{onClick:t[2]||(t[2]=e=>h.value=!h.value),disabled:0===v.value.length,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[t[9]||(t[9]=L(" Bulk Actions ",-1)),S(R(k),{class:"ml-1 h-4 w-4"})],8,ma),z(T("div",pa,[T("div",{class:"py-1"},[T("button",{onClick:se,class:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," Associate Selected "),T("button",{onClick:le,class:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," Remove Selected ")])],512),[[X,h.value]])],512)])]),T("div",fa,[T("div",ga,[T("div",ba,[S(R(o),{class:"h-5 w-5 text-blue-500 mr-2"}),t[10]||(t[10]=T("span",{class:"text-sm font-medium text-blue-900"},"Associated Products",-1))]),T("p",ya,N(W.value.length),1)]),T("div",xa,[T("div",va,[S(R(r),{class:"h-5 w-5 text-green-500 mr-2"}),t[11]||(t[11]=T("span",{class:"text-sm font-medium text-green-900"},"High Performance",-1))]),T("p",ha,N(J.value),1)]),T("div",wa,[T("div",_a,[S(R(f),{class:"h-5 w-5 text-yellow-500 mr-2"}),t[12]||(t[12]=T("span",{class:"text-sm font-medium text-yellow-900"},"Avg Performance",-1))]),T("p",ka,N(K.value.toFixed(1)),1)])]),T("div",Ca,[T("div",null,[t[15]||(t[15]=T("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Available Products",-1)),T("div",Ea,[T("div",Ma,[0===F.value.length?(U(),P("div",Aa,[S(R(o),{class:"h-8 w-8 mx-auto mb-2 text-gray-300"}),t[13]||(t[13]=T("p",{class:"text-sm"},"No available products found",-1))])):(U(),P("div",Pa,[(U(!0),P(D,null,I(F.value,e=>(U(),P("div",{key:e.id,class:"flex items-center justify-between p-3 rounded-md border border-gray-100 hover:bg-gray-50 transition-colors"},[T("div",Oa,[z(T("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>v.value=e),type:"checkbox",value:e.id,class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,8,Da),[[Z,v.value]]),T("div",null,[T("p",Ia,N(e.name),1),T("p",Sa,N(e.category),1)])]),T("button",{onClick:t=>(e=>{j.value.includes(e.id)||j.value.push(e.id)})(e),disabled:u.value,class:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-blue-600 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[S(R(y),{class:"h-3 w-3 mr-1"}),t[14]||(t[14]=L(" Add ",-1))],8,Ta)]))),128))]))])])]),T("div",null,[t[18]||(t[18]=T("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Associated Products",-1)),T("div",Ra,[T("div",La,[0===W.value.length?(U(),P("div",Na,[S(R(o),{class:"h-8 w-8 mx-auto mb-2 text-gray-300"}),t[16]||(t[16]=T("p",{class:"text-sm"},"No associated products",-1))])):(U(),P("div",Ua,[(U(!0),P(D,null,I(W.value,e=>(U(),P("div",{key:e.id,class:"flex items-center justify-between p-3 rounded-md border border-gray-100 bg-blue-50 transition-colors"},[T("div",ja,[z(T("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>v.value=e),type:"checkbox",value:e.id,class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,8,Va),[[Z,v.value]]),T("div",$a,[T("div",Fa,[T("div",null,[T("p",Ha,N(e.name),1),T("p",za,N(e.category),1)]),T("div",Ba,[S(te,{score:be(e.id),size:"sm"},null,8,["score"])])]),T("div",Wa,[T("span",null,"Opportunities: "+N(ye(e.id)),1),T("span",null,"Win Rate: "+N(xe(e.id))+"%",1)])])]),T("button",{onClick:t=>(e=>{const t=j.value.indexOf(e.id);t>=0&&j.value.splice(t,1)})(e),disabled:u.value,class:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-red-600 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50"},[S(R(p),{class:"h-3 w-3 mr-1"}),t[17]||(t[17]=L(" Remove ",-1))],8,qa)]))),128))]))])])])])])),T("div",Ya,[T("div",Ga,N(v.value.length)+" products selected ",1),T("div",Xa,[T("button",{type:"button",onClick:ae,class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Close "),T("button",{onClick:oe,disabled:u.value||!Y.value,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[u.value?(U(),P("div",Ka)):O("",!0),L(" "+N(u.value?"Saving...":"Save Changes"),1)],8,Ja)])])]),l:1})]),l:1})])])]),l:1})]),l:1},8,["show"])]))}}),[["__scopeId","data-v-f75a9cbf"]]);export{Xt as C,Qa as M,kt as P,mt as a,He as b};
