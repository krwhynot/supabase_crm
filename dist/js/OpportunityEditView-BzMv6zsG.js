import{b as e,u as t}from"./vue-router-BP51f1Hv.js";import{u as r}from"./opportunityStore-Cei765hD.js";import{O as s}from"./OpportunityFormWrapper-BvrCrIfP.js";import{d as o,r as i,y as n,C as a,J as l,D as d,V as p,W as u,N as m,H as c,O as x,E as v,U as g}from"./vue-runtime-Ds28nt_E.js";import{_ as f}from"./_plugin-vue_export-helper-DYAABpgn.js";import"./pinia-CUC4VGP7.js";import"./supabaseClient-Bh63a8tq.js";import"./supabase-BNBjhZ5t.js";import"./index-CocGRfLV.js";import"./yup-D1qa_jJc.js";import"./principalStore-Bil7HxyJ.js";import"./organizationsApi-CU0xJvEA.js";import"./productStore-C7_R-7jb.js";const y={class:"opportunity-edit-view"},h={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},b={key:1,class:"bg-white rounded-lg shadow-sm border border-red-200 p-6"},w={class:"flex items-center mb-4"},k={class:"text-red-700"},j={class:"flex space-x-3"},_={key:2},C={class:"flex mb-4","aria-label":"Breadcrumb"},B={class:"inline-flex items-center space-x-1 md:space-x-3"},O={class:"inline-flex items-center"},E={class:"flex items-center"},M={class:"flex items-center"},S={class:"mb-8"},A={class:"flex items-center space-x-3 mb-4"},D={class:"max-w-4xl"},$={key:0,class:"mt-6 max-w-4xl"},z={class:"p-4 border border-red-300 rounded-md bg-red-50"},L={class:"flex"},T={class:"mt-1 text-sm text-red-700"},V={key:1,class:"mt-6 max-w-4xl"},F={class:"p-4 border border-green-300 rounded-md bg-green-50"},H={class:"flex"},U={class:"mt-1 text-sm text-green-700"},W=f(o({t:"OpportunityEditView",setup(o){const f=e(),W=t(),G=r(),I=f.params.id,J=i(null),N=i(!0),R=i(null),Z=i(null),q=i(null),K=async()=>{try{N.value=!0,R.value=null,await G.fetchOpportunityById(I),G.selectedOpportunity?J.value=G.selectedOpportunity:R.value=G.error||"Opportunity not found"}catch(e){R.value="An unexpected error occurred while loading the opportunity"}finally{N.value=!1}},P=e=>{Z.value=null,q.value="Opportunity updated successfully! Redirecting to details...",setTimeout(()=>{W.push(`/opportunities/${e.opportunityId}`)},1500)},Q=()=>{Z.value=null,q.value=null,J.value?W.push(`/opportunities/${J.value.id}`):W.push("/opportunities")},X=e=>{q.value=null,Z.value="string"==typeof e?e:e.message||"An unexpected error occurred"},Y=()=>{Z.value=null};return n(()=>{K()}),(e,t)=>{const r=c("router-link");return v(),a("div",y,[N.value?(v(),a("div",h,t[0]||(t[0]=[d("div",{class:"flex justify-center"},[d("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})],-1),d("p",{class:"text-center text-gray-500 mt-4"},"Loading opportunity details...",-1)]))):R.value?(v(),a("div",b,[d("div",w,[t[1]||(t[1]=d("svg",{class:"h-5 w-5 text-red-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),d("span",k,p(R.value),1)]),d("div",j,[u(r,{to:"/opportunities",class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"},{default:m(()=>t[2]||(t[2]=[g(" Back to Opportunities ",-1)])),o:1,i:[2]}),d("button",{onClick:K,class:"px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700"}," Try Again ")])])):J.value?(v(),a("div",_,[d("nav",C,[d("ol",B,[d("li",O,[u(r,{to:"/",class:"inline-flex items-center text-sm font-medium text-gray-700 hover:text-primary-600"},{default:m(()=>t[3]||(t[3]=[d("svg",{class:"w-3 h-3 mr-2.5",fill:"currentColor",viewBox:"0 0 20 20"},[d("path",{d:"m19.707 9.293-2-2-7-7a1 1 0 0 0-1.414 0l-7 7-2 2a1 1 0 0 0 1.414 1.414L2 10.414V18a2 2 0 0 0 2 2h3a1 1 0 0 0 1-1v-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v4a1 1 0 0 0 1 1h3a2 2 0 0 0 2-2v-7.586l.293.293a1 1 0 0 0 1.414-1.414Z"})],-1),g(" Dashboard ",-1)])),o:1,i:[3]})]),d("li",null,[d("div",E,[t[5]||(t[5]=d("svg",{class:"w-3 h-3 text-gray-400 mx-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m9 5 7 7-7 7"})],-1)),u(r,{to:"/opportunities",class:"ml-1 text-sm font-medium text-gray-700 hover:text-primary-600 md:ml-2"},{default:m(()=>t[4]||(t[4]=[g(" Opportunities ",-1)])),o:1,i:[4]})])]),d("li",null,[d("div",M,[t[6]||(t[6]=d("svg",{class:"w-3 h-3 text-gray-400 mx-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m9 5 7 7-7 7"})],-1)),u(r,{to:`/opportunities/${J.value.id}`,class:"ml-1 text-sm font-medium text-gray-700 hover:text-primary-600 md:ml-2"},{default:m(()=>[g(p(J.value.name),1)]),o:1},8,["to"])])]),t[7]||(t[7]=x('<li aria-current="page" data-v-b6e22825><div class="flex items-center" data-v-b6e22825><svg class="w-3 h-3 text-gray-400 mx-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-b6e22825><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5 7 7-7 7" data-v-b6e22825></path></svg><span class="ml-1 text-sm font-medium text-gray-500 md:ml-2" data-v-b6e22825>Edit</span></div></li>',1))])]),d("div",S,[d("div",A,[u(r,{to:`/opportunities/${J.value.id}`,class:"inline-flex items-center text-gray-500 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 rounded-md p-1","aria-label":"Back to opportunity details"},{default:m(()=>t[8]||(t[8]=[d("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),o:1,i:[8]},8,["to"]),t[9]||(t[9]=d("div",null,[d("h1",{class:"text-3xl font-bold text-gray-900"},"Edit Opportunity"),d("p",{class:"mt-2 text-gray-600"}," Update opportunity details, stage, and associated information. ")],-1))])]),d("div",D,[u(s,{"is-editing":!0,"existing-opportunity":J.value,onSuccess:P,onCancel:Q,onError:X},null,8,["existing-opportunity"])]),Z.value?(v(),a("div",$,[d("div",z,[d("div",L,[t[11]||(t[11]=d("svg",{class:"h-5 w-5 text-red-400 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),d("div",null,[t[10]||(t[10]=d("h3",{class:"text-sm font-medium text-red-800"},"Error updating opportunity",-1)),d("p",T,p(Z.value),1),d("div",{class:"mt-3"},[d("button",{onClick:Y,class:"text-sm font-medium text-red-800 hover:text-red-900 focus:outline-none focus:ring-2 focus:ring-red-500 rounded-md px-2 py-1"}," Dismiss ")])])])])])):l("",!0),q.value?(v(),a("div",V,[d("div",F,[d("div",H,[t[13]||(t[13]=d("svg",{class:"h-5 w-5 text-green-400 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),d("div",null,[t[12]||(t[12]=d("h3",{class:"text-sm font-medium text-green-800"},"Success!",-1)),d("p",U,p(q.value),1)])])])])):l("",!0)])):l("",!0)])}}}),[["__scopeId","data-v-b6e22825"]]);export{W as default};
