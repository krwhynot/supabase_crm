import{d as e}from"./pinia-CUC4VGP7.js";import{c as t}from"./contactsApi-DllDKbAq.js";import{r as a,c as r,d as o,C as n,D as s,J as l,B as i,U as c,V as d,R as u,n as p,E as y,F as m,L as f}from"./vue-runtime-Ds28nt_E.js";const h=e("contact",()=>{const e=a([]),o=a(null),n=a(!1),s=a(!1),l=a(""),i=a(""),c=a(0),d=a(1),u=a(10),p=a("first_name"),y=a("asc"),m=r(()=>e.value.length>0),f=r(()=>Math.ceil(c.value/u.value)),h=r(()=>d.value<f.value),g=r(()=>d.value>1),b=()=>{l.value=""},w=e=>{l.value=e},x=async(a={})=>{try{n.value=!0,b();const r=a.search||i.value,o=a.offset||(d.value-1)*u.value,s=a.limit||u.value,l=a.sortBy||p.value,m=a.sortOrder||y.value,f=await t.getContacts({search:(null==r?void 0:r.trim())||void 0,offset:o,limit:s,sortBy:l,sortOrder:m});if(!f.success||!f.data)throw new Error(f.error||"Failed to fetch contacts");e.value=f.data,c.value=f.data.length}catch(r){const e=r instanceof Error?r.message:"Failed to fetch contacts";w(e)}finally{n.value=!1}},v=async e=>{e>=1&&e<=f.value&&(d.value=e,await x())};return{contacts:e,currentContact:o,isLoading:n,isSubmitting:s,errorMessage:l,searchQuery:i,currentPage:d,pageSize:u,totalCount:c,sortBy:p,sortOrder:y,hasContacts:m,totalPages:f,hasNextPage:h,hasPreviousPage:g,fetchContacts:x,fetchContact:async e=>{try{n.value=!0,b();const a=await t.getContact(e);if(a.success&&a.data)return o.value=a.data,a.data;throw new Error(a.error||"Failed to fetch contact")}catch(a){const e=a instanceof Error?a.message:"Failed to fetch contact";return w(e),o.value=null,null}finally{n.value=!1}},createContact:async e=>{try{s.value=!0,b();const a=await t.createContact(e);if(a.success&&a.data)return await x(),a.data;throw new Error(a.error||"Failed to create contact")}catch(a){const e=a instanceof Error?a.message:"Failed to create contact";return w(e),null}finally{s.value=!1}},updateContact:async(e,a)=>{try{s.value=!0,b();const r=await t.updateContact(e,a);if(r.success&&r.data)return o.value=r.data,await x(),r.data;throw new Error(r.error||"Failed to update contact")}catch(r){const e=r instanceof Error?r.message:"Failed to update contact";return w(e),null}finally{s.value=!1}},deleteContact:async e=>{var a;try{s.value=!0,b();const r=await t.deleteContact(e);if(r.success)return(null==(a=o.value)?void 0:a.id)===e&&(o.value=null),await x(),!0;throw new Error(r.error||"Failed to delete contact")}catch(r){const e=r instanceof Error?r.message:"Failed to delete contact";return w(e),!1}finally{s.value=!1}},searchContacts:async e=>{i.value=e,d.value=1,await x({search:e})},clearSearch:async()=>{i.value="",d.value=1,await x()},setPage:v,nextPage:async()=>{h.value&&await v(d.value+1)},previousPage:async()=>{g.value&&await v(d.value-1)},setSorting:async(e,t)=>{p.value=e,y.value=t,d.value=1,await x()},clearError:b,resetStore:()=>{e.value=[],o.value=null,n.value=!1,s.value=!1,l.value="",i.value="",d.value=1,c.value=0,p.value="first_name",y.value="asc"}}}),g={class:"space-y-1"},b=["for"],w={key:0,class:"text-danger ml-1","aria-label":"required"},x=["id"],v={class:"relative"},k=["id","type","name","placeholder","readonly","disabled","required","min","max","step","maxlength","minlength","pattern","value","aria-describedby","aria-invalid","aria-required"],C={key:0,class:"absolute inset-y-0 right-0 flex items-center pr-4","aria-hidden":"true"},$={key:1,class:"absolute inset-y-0 right-0 flex items-center pr-4","aria-hidden":"true"},B=["id"],F=["id"],E=o({t:"BaseInputField",props:{name:{},label:{},type:{default:"text"},modelValue:{},error:{},placeholder:{},description:{},helpText:{},required:{type:Boolean},disabled:{type:Boolean},readonly:{type:Boolean},loading:{type:Boolean},showValidIcon:{type:Boolean,default:!0},autocomplete:{default:"off"},min:{},max:{},step:{},maxlength:{},minlength:{},pattern:{},inputClass:{},labelClass:{}},emits:["update:modelValue","blur","focus","input","keydown","validate"],setup(e,{expose:t,emit:o}){const m=e,f=o,h=a(!1),E=r(()=>`field-${m.name}`),q=r(()=>`error-${m.name}`),M=r(()=>`desc-${m.name}`),V=r(()=>`help-${m.name}`),z=r(()=>!!m.error),j=r(()=>{const e=[];return m.description&&e.push(M.value),m.error&&e.push(q.value),m.helpText&&!m.error&&e.push(V.value),e.length>0?e.join(" "):void 0}),P=r(()=>`form-label transition-colors duration-200 ${z.value?"text-danger-700":h.value?"text-primary-600":"text-gray-700"} ${m.disabled?"opacity-60":""} ${m.labelClass||""}`.trim()),S=r(()=>`w-full min-h-input px-4 py-3 border rounded-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:border-transparent ${z.value?"border-danger-300 bg-danger-50 focus:ring-danger-500 focus:bg-white text-gray-900":h.value?"border-primary-500 bg-white focus:ring-primary-500":"border-gray-300 bg-white hover:border-gray-400 focus:ring-primary-500"} ${m.disabled?"bg-gray-100 text-gray-500 cursor-not-allowed border-gray-200":""} ${m.readonly?"bg-gray-50 cursor-default border-gray-200":""} ${m.loading||m.showValidIcon&&!z.value&&m.modelValue?"pr-12":""} ${m.inputClass||""}`.trim()),_=e=>{const t=e.target,a="number"===m.type?Number(t.value):t.value;f("update:modelValue",a),f("input",e)},A=async e=>{h.value=!1,f("blur",e),await p(),f("validate",m.modelValue)},I=e=>{h.value=!0,f("focus",e)},K=e=>{f("keydown",e),"Escape"===e.key&&h.value&&e.target.blur()};return t({focus:()=>{const e=document.getElementById(E.value);null==e||e.focus()},blur:()=>{const e=document.getElementById(E.value);null==e||e.blur()},select:()=>{const e=document.getElementById(E.value);null==e||e.select()}}),(e,t)=>(y(),n("div",g,[s("label",{for:E.value,class:i(P.value)},[c(d(e.label)+" ",1),e.required?(y(),n("span",w,"*")):l("",!0)],10,b),e.description?(y(),n("p",{key:0,id:M.value,class:"text-sm text-gray-600"},d(e.description),9,x)):l("",!0),s("div",v,[s("input",u({id:E.value,type:e.type,name:e.name,placeholder:e.placeholder},e.autocomplete?{autocomplete:e.autocomplete}:{},{readonly:e.readonly||void 0,disabled:e.disabled||void 0,required:e.required,min:e.min,max:e.max,step:e.step,maxlength:e.maxlength,minlength:e.minlength,pattern:e.pattern,value:e.modelValue,"aria-describedby":j.value,"aria-invalid":z.value,"aria-required":e.required,class:S.value,onInput:_,onBlur:A,onFocus:I,onKeydown:K}),null,16,k),e.loading?(y(),n("div",C,t[0]||(t[0]=[s("svg",{class:"h-5 w-5 animate-spin text-gray-400",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):l("",!0),e.showValidIcon&&!z.value&&e.modelValue&&!e.loading?(y(),n("div",$,t[1]||(t[1]=[s("svg",{class:"h-5 w-5 text-success-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]))):l("",!0)]),e.error?(y(),n("p",{key:1,id:q.value,role:"alert",class:"form-error"},[t[2]||(t[2]=s("svg",{class:"h-4 w-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),s("span",null,d(e.error),1)],8,B)):l("",!0),e.helpText&&!e.error?(y(),n("p",{key:2,id:V.value,class:"form-help"},d(e.helpText),9,F)):l("",!0)]))}}),q={class:"space-y-1"},M=["for"],V={key:0,class:"text-danger ml-1","aria-label":"required"},z=["id"],j={class:"relative"},P=["id","name","disabled","required","multiple","size","value","aria-describedby","aria-invalid","aria-required"],S=["disabled"],_=["label"],A=["value","disabled"],I=["value"],K={key:0,class:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none","aria-hidden":"true"},L={key:1,class:"absolute inset-y-0 right-8 flex items-center pr-3","aria-hidden":"true"},O=["id"],H=["id"],N={key:3,class:"text-sm text-gray-600"},T=o({t:"SelectField",props:{name:{},label:{},modelValue:{},options:{},error:{},placeholder:{default:"Select an option"},description:{},helpText:{},required:{type:Boolean},disabled:{type:Boolean},multiple:{type:Boolean},size:{},loading:{type:Boolean},selectClass:{},labelClass:{}},emits:["update:modelValue","blur","focus","change","keydown","validate"],setup(e,{expose:t,emit:o}){const u=e,h=o,g=a(!1),b=r(()=>`select-${u.name}`),w=r(()=>`error-${u.name}`),x=r(()=>`desc-${u.name}`),v=r(()=>`help-${u.name}`),k=r(()=>!!u.error),C=r(()=>{const e=[];return u.description&&e.push(x.value),u.error&&e.push(w.value),u.helpText&&!u.error&&e.push(v.value),e.length>0?e.join(" "):void 0}),$=r(()=>u.options.length>0&&"object"==typeof u.options[0]),B=r(()=>{if(!$.value)return[];const e=u.options,t=new Map;return e.forEach(e=>{const a=e.group||"Options";t.has(a)||t.set(a,[]),t.get(a).push(e)}),Array.from(t.entries()).map(([e,t])=>({label:e,options:t}))}),F=e=>e.value,E=e=>e.value,T=e=>e.disabled||!1,D=r(()=>`block text-sm font-medium transition-colors duration-200 ${k.value?"text-red-700":g.value?"text-primary":"text-gray-700"} ${u.disabled?"opacity-60":""} ${u.labelClass||""}`.trim()),J=r(()=>`w-full px-3 py-2 border rounded-md transition-all duration-200 focus:outline-none focus:ring-2 focus:border-transparent ${k.value?"border-red-500 bg-red-50 focus:ring-red-500 focus:bg-white":g.value?"border-primary bg-white focus:ring-primary":"border-gray-300 bg-white hover:border-gray-400 focus:ring-primary"} ${u.disabled?"bg-gray-100 text-gray-500 cursor-not-allowed":"cursor-pointer"} ${u.multiple?"py-1":"pr-10"} ${u.loading?"pr-16":""} ${u.selectClass||""}`.trim()),Q=e=>{const t=e.target;if(u.multiple){const e=[];for(let a=0;a<t.options.length;a++)t.options[a].selected&&e.push(t.options[a].value);h("update:modelValue",e)}else h("update:modelValue",t.value);h("change",e)},R=async e=>{g.value=!1,h("blur",e),await p(),h("validate",u.modelValue)},U=e=>{g.value=!0,h("focus",e)},G=e=>{h("keydown",e),"Escape"===e.key&&g.value&&e.target.blur()," "!==e.key||u.multiple||(e.preventDefault(),e.target.click())};return t({focus:()=>{const e=document.getElementById(b.value);null==e||e.focus()},blur:()=>{const e=document.getElementById(b.value);null==e||e.blur()}}),(e,t)=>(y(),n("div",q,[s("label",{for:b.value,class:i(D.value)},[c(d(e.label)+" ",1),e.required?(y(),n("span",V,"*")):l("",!0)],10,M),e.description?(y(),n("p",{key:0,id:x.value,class:"text-sm text-gray-600"},d(e.description),9,z)):l("",!0),s("div",j,[s("select",{id:b.value,name:e.name,disabled:e.disabled,required:e.required,multiple:e.multiple,size:e.multiple?e.size||Math.min(e.options.length,5):void 0,value:e.modelValue,"aria-describedby":C.value,"aria-invalid":k.value,"aria-required":e.required,class:i(J.value),onChange:Q,onBlur:R,onFocus:U,onKeydown:G},[!e.multiple&&e.placeholder?(y(),n("option",{key:0,value:"",disabled:e.required},d(e.placeholder),9,S)):l("",!0),$.value?(y(!0),n(m,{key:1},f(B.value,e=>(y(),n("optgroup",{key:e.label,label:e.label},[(y(!0),n(m,null,f(e.options,e=>(y(),n("option",{key:F(e),value:E(e),disabled:T(e)},d((e=>e.label)(e)),9,A))),128))],8,_))),128)):(y(!0),n(m,{key:2},f(e.options,e=>(y(),n("option",{key:String(e),value:e},d(e),9,I))),128))],42,P),e.multiple?l("",!0):(y(),n("div",K,[(y(),n("svg",{class:i(["h-4 w-4 text-gray-400",{"text-red-500":k.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[0]||(t[0]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))])),e.loading?(y(),n("div",L,t[1]||(t[1]=[s("svg",{class:"h-4 w-4 animate-spin text-gray-400",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):l("",!0)]),e.error?(y(),n("p",{key:1,id:w.value,role:"alert",class:"text-sm text-danger flex items-center space-x-1"},[t[2]||(t[2]=s("svg",{class:"h-4 w-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),s("span",null,d(e.error),1)],8,O)):l("",!0),e.helpText&&!e.error?(y(),n("p",{key:2,id:v.value,class:"text-sm text-gray-500"},d(e.helpText),9,H)):l("",!0),e.multiple&&Array.isArray(e.modelValue)&&e.modelValue.length>0?(y(),n("p",N,d(e.modelValue.length)+" item"+d(1===e.modelValue.length?"":"s")+" selected ",1)):l("",!0)]))}});export{E as _,T as a,h as u};
