import{d as e,r as t,w as o,c as a,C as s,D as l,J as n,K as r,U as i,B as d,F as u,L as c,u as m,Y as p,V as b,X as f,W as g,E as x,a2 as y,$ as v,b as h,y as w,M as k,Z as _,G as D}from"./vue-runtime-Ds28nt_E.js";import{u as C}from"./vue-router-BP51f1Hv.js";import{u as S}from"./interactionStore-BcFjnLm_.js";import{u as E}from"./opportunityStore-Cei765hD.js";import{Q as I,I as U,d as P,e as O}from"./interactions-BneQrg6J.js";import{f as V,T as j,U as T,r as A,g as L,x as M,h as q,b as N,R as B}from"./heroicons-QXV26b6T.js";import{_ as F}from"./_plugin-vue_export-helper-DYAABpgn.js";const W={class:"interaction-step-one space-y-6"},R={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},H=["value"],$={key:0,class:"mt-1 text-sm text-red-600"},z={class:"mt-1 text-sm text-gray-500"},G={key:0,class:"mt-1 text-sm text-red-600"},K={key:0,class:"mt-1 text-sm text-red-600"},J={class:"mt-1 text-sm text-gray-500"},Q={class:"relative"},X=["disabled"],Y=["value"],Z={key:0,class:"absolute inset-y-0 right-0 flex items-center pr-3"},ee={key:0,class:"mt-1 text-sm text-red-600"},te={key:1,class:"mt-3 p-3 bg-blue-50 rounded-md"},oe={class:"flex items-center"},ae={class:"text-sm font-medium text-blue-900"},se={class:"text-sm text-blue-700"},le={key:0,class:"border-t pt-6"},ne={class:"grid grid-cols-2 gap-3 sm:grid-cols-4"},re=["onClick"],ie={class:"text-lg mb-1"},de={class:"text-xs text-center"},ue=F(e({t:"InteractionStepOne",props:{formData:{},validation:{},opportunities:{},loading:{type:Boolean,default:!1}},emits:["update:formData","opportunitySelected"],setup(e,{emit:y}){const v=e,h=y,w=t({...v.formData});o(()=>v.formData,e=>{w.value={...e}},{deep:!0});const k=a(()=>v.opportunities.find(e=>e.id===w.value.opportunity_id)),_=a(()=>!w.value.subject||window.innerWidth<768),D=a(()=>I.filter(e=>e.type===w.value.type)),C=e=>v.validation.errors.step1?.includes(`${e} is required`)||v.validation.errors[e]?.length>0,S=e=>v.validation.errors[e]?.[0]||v.validation.errors.step1?.find(t=>t.includes(e)),E=()=>{h("update:formData",{type:w.value.type})},P=()=>{h("update:formData",{subject:w.value.subject})},O=()=>{h("update:formData",{interaction_date:w.value.interaction_date})},j=()=>{h("update:formData",{opportunity_id:w.value.opportunity_id}),h("opportunitySelected",w.value.opportunity_id)};return(e,t)=>{return x(),s("div",W,[l("div",R,[l("div",null,[t[4]||(t[4]=l("label",{for:"interaction-type",class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Interaction Type "),l("span",{class:"text-red-500"},"*")],-1)),r(l("select",{id:"interaction-type","onUpdate:modelValue":t[0]||(t[0]=e=>w.value.type=e),onChange:E,class:d(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":C("type")}])},[(x(!0),s(u,null,c(m(U),e=>(x(),s("option",{key:e.value,value:e.value},b(e.label),9,H))),128))],34),[[p,w.value.type]]),C("type")?(x(),s("p",$,b(S("type")),1)):n("",!0),l("p",z,b((o=w.value.type,{Email:"Email communication or email campaign",Phone:"Phone call or voice conversation",Meeting:"Face-to-face meeting or site visit",Demo:"Product demonstration or presentation",Proposal:"Business proposal or quote",Contract:"Contract discussion or signing",Note:"Internal note or documentation",Task:"Task or follow-up action",Event:"Sample drop-off or delivery",Social:"Social media interaction",Website:"Website or online interaction",Other:"Follow-up contact or check-in"}[o]||"")),1)]),l("div",null,[t[5]||(t[5]=l("label",{for:"interaction-date",class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Date & Time "),l("span",{class:"text-red-500"},"*")],-1)),r(l("input",{id:"interaction-date",type:"datetime-local","onUpdate:modelValue":t[1]||(t[1]=e=>w.value.interaction_date=e),onInput:O,class:d(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":C("interaction_date")}])},null,34),[[f,w.value.interaction_date]]),C("interaction_date")?(x(),s("p",G,b(S("interaction_date")),1)):n("",!0)])]),l("div",null,[t[6]||(t[6]=l("label",{for:"subject",class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Subject "),l("span",{class:"text-red-500"},"*")],-1)),r(l("input",{id:"subject",type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>w.value.subject=e),onInput:P,placeholder:"Brief description of the interaction",class:d(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":C("subject")}]),maxlength:"255"},null,34),[[f,w.value.subject]]),C("subject")?(x(),s("p",K,b(S("subject")),1)):n("",!0),l("p",J,b(w.value.subject.length)+"/255 characters ",1)]),l("div",null,[t[9]||(t[9]=l("label",{for:"opportunity",class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Related Opportunity "),l("span",{class:"text-red-500"},"*")],-1)),l("div",Q,[r(l("select",{id:"opportunity","onUpdate:modelValue":t[3]||(t[3]=e=>w.value.opportunity_id=e),onChange:j,class:d(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":C("opportunity_id")}]),disabled:e.loading},[t[7]||(t[7]=l("option",{value:""},"Select an opportunity...",-1)),(x(!0),s(u,null,c(e.opportunities,e=>(x(),s("option",{key:e.id,value:e.id},b(e.name)+" - "+b(e.organization_name),9,Y))),128))],42,X),[[p,w.value.opportunity_id]]),e.loading?(x(),s("div",Z,t[8]||(t[8]=[l("svg",{class:"animate-spin h-4 w-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):n("",!0)]),C("opportunity_id")?(x(),s("p",ee,b(S("opportunity_id")),1)):n("",!0),k.value?(x(),s("div",te,[l("div",oe,[g(m(V),{class:"h-5 w-5 text-blue-400 mr-2"}),l("div",null,[l("p",ae,b(k.value.name),1),l("p",se,b(k.value.organization_name)+" â€¢ Stage: "+b(k.value.stage),1)])])])):n("",!0)]),_.value?(x(),s("div",le,[t[10]||(t[10]=l("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"Quick Templates",-1)),l("div",ne,[(x(!0),s(u,null,c(D.value,e=>(x(),s("button",{key:e.id,type:"button",onClick:t=>(e=>{w.value.type=e.type,w.value.subject=e.subject_template,h("update:formData",{type:e.type,subject:e.subject_template})})(e),class:"flex flex-col items-center p-3 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"},[l("span",ie,b(e.icon),1),l("span",de,b(e.label),1)],8,re))),128))])])):n("",!0)]);var o}}}),[["__scopeId","data-v-a3b33e19"]]),ce={class:"interaction-step-two space-y-6"},me={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},pe=["value"],be={key:0,class:"mt-1 text-sm text-red-600"},fe={key:0,class:"mt-1 text-sm text-red-600"},ge={key:0},xe={for:"location",class:"block text-sm font-medium text-gray-700 mb-2"},ye={key:0,class:"text-red-500"},ve={key:0,class:"mt-1 text-sm text-red-600"},he={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},we=["value"],ke={key:1,class:"bg-blue-50 rounded-lg p-4"},_e={class:"flex"},De={class:"space-y-2"},Ce={class:"text-sm text-blue-800"},Se=["onClick"],Ee={key:2,class:"border-t pt-6"},Ie={key:3,class:"border-t pt-6"},Ue={key:4,class:"border-t pt-6"},Pe=F(e({t:"InteractionStepTwo",props:{formData:{},validation:{},interactionType:{}},emits:["update:formData"],setup(e,{emit:y}){const v=e,h=y,w=t({...v.formData}),k=t(1);o(()=>v.formData,e=>{w.value={...e},k.value=e.participants?.length||1},{deep:!0});const _=[{value:"SCHEDULED",label:"Scheduled"},{value:"COMPLETED",label:"Completed"},{value:"CANCELLED",label:"Cancelled"},{value:"NO_SHOW",label:"No Show"}],D=["Phone","Email","Video Call","In Person","Text","Social Media","Other"],C=a(()=>["Meeting","Demo","Event"].includes(v.interactionType)),S=a(()=>E.value.length>0),E=a(()=>{const e=[];if(!w.value.duration_minutes){const t={Email:null,Phone:15,Meeting:60,Demo:45,Proposal:30,Contract:45,Note:null,Task:15,Event:15,Social:null,Website:null,Other:20}[v.interactionType];t&&e.push({field:"duration_minutes",label:`Set duration to ${t} minutes`,value:t})}if(!w.value.contact_method){const t={Email:"Email",Phone:"Phone",Meeting:"In Person",Demo:"In Person",Proposal:"Email",Contract:"In Person",Note:"Other",Task:"Phone",Event:"In Person",Social:"Social Media",Website:"Other",Other:"Phone"}[v.interactionType];t&&e.push({field:"contact_method",label:`Set contact method to ${t}`,value:t})}return e}),I=e=>v.validation.errors.step2?.some(t=>t.includes(e))||v.validation.errors[e]?.length>0,U=e=>v.validation.errors[e]?.[0]||v.validation.errors.step2?.find(t=>t.includes(e)),P=()=>{h("update:formData",{status:w.value.status})},O=()=>{h("update:formData",{duration_minutes:w.value.duration_minutes})},V=()=>{h("update:formData",{location:w.value.location})},T=()=>{h("update:formData",{contact_method:w.value.contact_method})},A=()=>{const e=Array.from({length:k.value},(e,t)=>`Participant ${t+1}`);w.value.participants=e,h("update:formData",{participants:e})};return(e,t)=>(x(),s("div",ce,[l("div",me,[l("div",null,[t[5]||(t[5]=l("label",{for:"status",class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Status "),l("span",{class:"text-red-500"},"*")],-1)),r(l("select",{id:"status","onUpdate:modelValue":t[0]||(t[0]=e=>w.value.status=e),onChange:P,class:d(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":I("status")}])},[(x(),s(u,null,c(_,e=>l("option",{key:e.value,value:e.value},b(e.label),9,pe)),64))],34),[[p,w.value.status]]),I("status")?(x(),s("p",be,b(U("status")),1)):n("",!0)]),l("div",null,[t[6]||(t[6]=l("label",{for:"duration",class:"block text-sm font-medium text-gray-700 mb-2"}," Duration (minutes) ",-1)),r(l("input",{id:"duration",type:"number","onUpdate:modelValue":t[1]||(t[1]=e=>w.value.duration_minutes=e),onInput:O,placeholder:"e.g., 30",min:"1",max:"480",class:d(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":I("duration_minutes")}])},null,34),[[f,w.value.duration_minutes,void 0,{number:!0}]]),I("duration_minutes")?(x(),s("p",fe,b(U("duration_minutes")),1)):n("",!0),t[7]||(t[7]=l("p",{class:"mt-1 text-sm text-gray-500"}," Leave blank if duration is not applicable ",-1))])]),C.value?(x(),s("div",ge,[l("label",xe,[t[8]||(t[8]=i(" Location ",-1)),"Meeting"===e.interactionType?(x(),s("span",ye,"*")):n("",!0)]),r(l("input",{id:"location",type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>w.value.location=e),onInput:V,placeholder:"Meeting location, address, or venue",class:d(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":I("location")}]),maxlength:"255"},null,34),[[f,w.value.location]]),I("location")?(x(),s("p",ve,b(U("location")),1)):n("",!0)])):n("",!0),l("div",he,[l("div",null,[t[10]||(t[10]=l("label",{for:"contact-method",class:"block text-sm font-medium text-gray-700 mb-2"}," Contact Method ",-1)),r(l("select",{id:"contact-method","onUpdate:modelValue":t[3]||(t[3]=e=>w.value.contact_method=e),onChange:T,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[t[9]||(t[9]=l("option",{value:""},"Select method...",-1)),(x(),s(u,null,c(D,e=>l("option",{key:e,value:e},b(e),9,we)),64))],544),[[p,w.value.contact_method]]),t[11]||(t[11]=l("p",{class:"mt-1 text-sm text-gray-500"}," How was this interaction conducted? ",-1))]),l("div",null,[t[12]||(t[12]=l("label",{for:"participant-count",class:"block text-sm font-medium text-gray-700 mb-2"}," Number of Participants ",-1)),r(l("input",{id:"participant-count",type:"number","onUpdate:modelValue":t[4]||(t[4]=e=>k.value=e),onInput:A,placeholder:"1",min:"1",max:"20",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,544),[[f,k.value,void 0,{number:!0}]]),t[13]||(t[13]=l("p",{class:"mt-1 text-sm text-gray-500"}," Total people involved in this interaction ",-1))])]),S.value?(x(),s("div",ke,[l("div",_e,[g(m(j),{class:"h-5 w-5 text-blue-400 mt-0.5 mr-3"}),l("div",null,[t[14]||(t[14]=l("h4",{class:"text-sm font-medium text-blue-900 mb-2"},"Smart Suggestions",-1)),l("div",De,[(x(!0),s(u,null,c(E.value,e=>(x(),s("div",{key:e.field,class:"flex items-center justify-between"},[l("span",Ce,b(e.label),1),l("button",{type:"button",onClick:t=>(e=>{"duration_minutes"===e.field?(w.value.duration_minutes=e.value,h("update:formData",{duration_minutes:e.value})):"contact_method"===e.field&&(w.value.contact_method=e.value,h("update:formData",{contact_method:e.value}))})(e),class:"text-sm text-blue-600 hover:text-blue-800 font-medium"}," Apply ",8,Se)]))),128))])])])])):n("",!0),"Email"===e.interactionType?(x(),s("div",Ee,t[15]||(t[15]=[l("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"Email Details",-1),l("div",{class:"text-sm text-gray-500"},[l("p",null,"â€¢ Duration is typically not applicable for emails"),l("p",null,"â€¢ Consider follow-up requirements for important emails")],-1)]))):"Demo"===e.interactionType?(x(),s("div",Ie,t[16]||(t[16]=[l("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"Demo Details",-1),l("div",{class:"text-sm text-gray-500"},[l("p",null,"â€¢ Consider setting duration to 45-60 minutes for product demos"),l("p",null,"â€¢ Location helps track whether it's on-site or virtual"),l("p",null,"â€¢ Multiple participants are common for demos")],-1)]))):"Event"===e.interactionType?(x(),s("div",Ue,t[17]||(t[17]=[l("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"Sample Delivery Details",-1),l("div",{class:"text-sm text-gray-500"},[l("p",null,"â€¢ Duration is typically short (10-15 minutes)"),l("p",null,"â€¢ Location is important for delivery tracking"),l("p",null,"â€¢ Consider scheduling follow-up for feedback")],-1)]))):n("",!0)]))}}),[["__scopeId","data-v-d495ae2f"]]),Oe={class:"interaction-step-three space-y-6"},Ve={key:0,class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},je=["value"],Te={key:0,class:"mt-1 text-sm text-red-600"},Ae=["value"],Le={key:0,class:"mt-1 text-sm text-red-600"},Me={key:0,class:"mt-1 text-sm text-red-600"},qe={class:"mt-1 text-sm text-gray-500"},Ne={class:"border-t pt-6"},Be={class:"flex items-center mb-4"},Fe={key:0,class:"space-y-4 pl-6"},We=["min"],Re={key:0,class:"mt-1 text-sm text-red-600"},He={class:"mt-1 text-sm text-gray-500"},$e=["value"],ze={class:"flex flex-wrap gap-2 mb-2"},Ge=["onClick"],Ke={class:"flex"},Je={key:1,class:"bg-gray-50 rounded-lg p-4"},Qe={class:"flex"},Xe={class:"space-y-2"},Ye={class:"text-sm text-gray-700"},Ze=["onClick"],et=F(e({t:"InteractionStepThree",props:{formData:{},validation:{},status:{}},emits:["update:formData"],setup(e,{emit:h}){const w=e,k=h,_=t({...w.formData}),D=t("");o(()=>w.formData,e=>{_.value={...e}},{deep:!0});const C=[{value:1,label:"1 - Poor"},{value:2,label:"2 - Below Average"},{value:3,label:"3 - Average"},{value:4,label:"4 - Good"},{value:5,label:"5 - Excellent"}],S=["Schedule Follow-up Call","Send Information","Prepare Proposal","Schedule Demo","Send Samples","Schedule Site Visit","Internal Discussion","Wait for Customer Response","Update Opportunity Stage","Close Opportunity"],E=a(()=>(new Date).toISOString().slice(0,16)),I=a(()=>"COMPLETED"===w.status&&_.value.outcome),U=a(()=>{const e=_.value.outcome;return e&&{POSITIVE:[{description:"Schedule follow-up to maintain momentum",action:"follow_up"},{description:"Consider updating opportunity stage",action:null},{description:"Add positive interaction tag",action:"tag_positive"}],NEUTRAL:[{description:"Schedule follow-up to address concerns",action:"follow_up"},{description:"Consider sending additional information",action:null},{description:"Add neutral interaction tag",action:"tag_neutral"}],NEGATIVE:[{description:"Schedule follow-up to address issues",action:"follow_up"},{description:"Consider internal team discussion",action:null},{description:"Add negative interaction tag",action:"tag_negative"}],NEEDS_FOLLOW_UP:[{description:"Schedule immediate follow-up",action:"follow_up"},{description:"Set next action as priority",action:null},{description:"Add follow-up required tag",action:"tag_followup"}]}[e]||[]}),O=e=>w.validation.errors.step3?.some(t=>t.includes(e))||w.validation.errors[e]?.length>0,V=e=>w.validation.errors[e]?.[0]||w.validation.errors.step3?.find(t=>t.includes(e)),j=()=>{k("update:formData",{outcome:_.value.outcome})},L=()=>{k("update:formData",{rating:_.value.rating})},M=()=>{k("update:formData",{notes:_.value.notes})},q=()=>{const e={follow_up_required:_.value.follow_up_required};_.value.follow_up_required||(e.follow_up_date=null,e.follow_up_notes="",e.next_action="",_.value.follow_up_date=null,_.value.follow_up_notes="",_.value.next_action=""),k("update:formData",e)},N=()=>{k("update:formData",{follow_up_date:_.value.follow_up_date})},B=()=>{k("update:formData",{follow_up_notes:_.value.follow_up_notes})},F=()=>{k("update:formData",{next_action:_.value.next_action})},W=()=>{const e=D.value.trim().replace(",","");if(e&&!_.value.tags?.includes(e)){const t=[..._.value.tags||[],e];_.value.tags=t,k("update:formData",{tags:t})}D.value=""},R=e=>{","===e.key&&(e.preventDefault(),W())};return _.value.tags||(_.value.tags=[],k("update:formData",{tags:[]})),(e,t)=>(x(),s("div",Oe,["COMPLETED"===e.status?(x(),s("div",Ve,[l("div",null,[t[9]||(t[9]=l("label",{for:"outcome",class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Outcome "),l("span",{class:"text-red-500"},"*")],-1)),r(l("select",{id:"outcome","onUpdate:modelValue":t[0]||(t[0]=e=>_.value.outcome=e),onChange:j,class:d(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":O("outcome")}])},[t[8]||(t[8]=l("option",{value:""},"Select outcome...",-1)),(x(!0),s(u,null,c(m(P),e=>(x(),s("option",{key:e.value,value:e.value},b(e.label),9,je))),128))],34),[[p,_.value.outcome]]),O("outcome")?(x(),s("p",Te,b(V("outcome")),1)):n("",!0)]),l("div",null,[t[11]||(t[11]=l("label",{for:"rating",class:"block text-sm font-medium text-gray-700 mb-2"}," Rating (1-5) ",-1)),r(l("select",{id:"rating","onUpdate:modelValue":t[1]||(t[1]=e=>_.value.rating=e),onChange:L,class:d(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":O("rating")}])},[t[10]||(t[10]=l("option",{value:null},"Select rating...",-1)),(x(),s(u,null,c(C,e=>l("option",{key:e.value,value:e.value},b(e.label),9,Ae)),64))],34),[[p,_.value.rating,void 0,{number:!0}]]),O("rating")?(x(),s("p",Le,b(V("rating")),1)):n("",!0),t[12]||(t[12]=l("p",{class:"mt-1 text-sm text-gray-500"}," Rate the effectiveness of this interaction ",-1))])])):n("",!0),l("div",null,[t[13]||(t[13]=l("label",{for:"notes",class:"block text-sm font-medium text-gray-700 mb-2"}," Notes ",-1)),r(l("textarea",{id:"notes","onUpdate:modelValue":t[2]||(t[2]=e=>_.value.notes=e),onInput:M,rows:"4",placeholder:"Additional notes about this interaction...",class:d(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":O("notes")}]),maxlength:"2000"},null,34),[[f,_.value.notes]]),O("notes")?(x(),s("p",Me,b(V("notes")),1)):n("",!0),l("p",qe,b(_.value.notes?.length||0)+"/2000 characters ",1)]),l("div",Ne,[t[19]||(t[19]=l("h4",{class:"text-sm font-medium text-gray-700 mb-4"},"Follow-up Planning",-1)),l("div",Be,[r(l("input",{id:"follow-up-required","onUpdate:modelValue":t[3]||(t[3]=e=>_.value.follow_up_required=e),onChange:q,type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,544),[[y,_.value.follow_up_required]]),t[14]||(t[14]=l("label",{for:"follow-up-required",class:"ml-2 block text-sm text-gray-700"}," This interaction requires follow-up ",-1))]),_.value.follow_up_required?(x(),s("div",Fe,[l("div",null,[t[15]||(t[15]=l("label",{for:"follow-up-date",class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Follow-up Date "),l("span",{class:"text-red-500"},"*")],-1)),r(l("input",{id:"follow-up-date",type:"datetime-local","onUpdate:modelValue":t[4]||(t[4]=e=>_.value.follow_up_date=e),onInput:N,min:E.value,class:d(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":O("follow_up_date")}])},null,42,We),[[f,_.value.follow_up_date]]),O("follow_up_date")?(x(),s("p",Re,b(V("follow_up_date")),1)):n("",!0)]),l("div",null,[t[16]||(t[16]=l("label",{for:"follow-up-notes",class:"block text-sm font-medium text-gray-700 mb-2"}," Follow-up Notes ",-1)),r(l("textarea",{id:"follow-up-notes","onUpdate:modelValue":t[5]||(t[5]=e=>_.value.follow_up_notes=e),onInput:B,rows:"3",placeholder:"What needs to be done in the follow-up?",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",maxlength:"500"},null,544),[[f,_.value.follow_up_notes]]),l("p",He,b(_.value.follow_up_notes?.length||0)+"/500 characters ",1)]),l("div",null,[t[18]||(t[18]=l("label",{for:"next-action",class:"block text-sm font-medium text-gray-700 mb-2"}," Next Action ",-1)),r(l("select",{id:"next-action","onUpdate:modelValue":t[6]||(t[6]=e=>_.value.next_action=e),onChange:F,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[t[17]||(t[17]=l("option",{value:""},"Select next action...",-1)),(x(),s(u,null,c(S,e=>l("option",{key:e,value:e},b(e),9,$e)),64))],544),[[p,_.value.next_action]])])])):n("",!0)]),l("div",null,[t[20]||(t[20]=l("label",{for:"tags",class:"block text-sm font-medium text-gray-700 mb-2"}," Tags ",-1)),l("div",ze,[(x(!0),s(u,null,c(_.value.tags,e=>(x(),s("span",{key:e,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},[i(b(e)+" ",1),l("button",{type:"button",onClick:t=>(e=>{const t=(_.value.tags||[]).filter(t=>t!==e);_.value.tags=t,k("update:formData",{tags:t})})(e),class:"flex-shrink-0 ml-1.5 h-4 w-4 rounded-full inline-flex items-center justify-center text-blue-400 hover:bg-blue-200 hover:text-blue-500 focus:outline-none focus:bg-blue-500 focus:text-white"},[g(m(A),{class:"h-3 w-3"})],8,Ge)]))),128))]),l("div",Ke,[r(l("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>D.value=e),onKeyup:v(W,["enter"]),onKeydown:R,type:"text",placeholder:"Add tag and press Enter",class:"flex-1 rounded-l-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",maxlength:"50"},null,544),[[f,D.value]]),l("button",{type:"button",onClick:W,class:"inline-flex items-center px-3 py-2 border border-l-0 border-gray-300 rounded-r-md bg-gray-50 text-gray-500 text-sm hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"}," Add ")]),t[21]||(t[21]=l("p",{class:"mt-1 text-sm text-gray-500"}," Use tags to categorize and search interactions later ",-1))]),I.value?(x(),s("div",Je,[l("div",Qe,[g(m(T),{class:"h-5 w-5 text-gray-400 mt-0.5 mr-3"}),l("div",null,[t[22]||(t[22]=l("h4",{class:"text-sm font-medium text-gray-900 mb-2"},"Recommended Next Steps",-1)),l("div",Xe,[(x(!0),s(u,null,c(U.value,e=>(x(),s("div",{key:e.action||"default",class:"flex items-center justify-between"},[l("span",Ye,b(e.description),1),e.action?(x(),s("button",{key:0,type:"button",onClick:t=>(e=>{if("follow_up"===e.action){_.value.follow_up_required=!0;const e=new Date;e.setDate(e.getDate()+7),_.value.follow_up_date=e.toISOString().slice(0,16),k("update:formData",{follow_up_required:!0,follow_up_date:_.value.follow_up_date})}else if(e.action?.startsWith("tag_")){const t=`${e.action.replace("tag_","")}-interaction`;if(!_.value.tags?.includes(t)){const e=[..._.value.tags||[],t];_.value.tags=e,k("update:formData",{tags:e})}}})(e),class:"text-sm text-blue-600 hover:text-blue-800 font-medium"}," Apply ",8,Ze)):n("",!0)]))),128))])])])])):n("",!0)]))}}),[["__scopeId","data-v-55a81276"]]),tt={class:"interaction-form-wrapper"},ot={class:"mb-8"},at={class:"text-2xl font-bold text-gray-900 mb-2"},st={class:"text-gray-600"},lt={class:"mb-8"},nt={"aria-label":"Progress"},rt={class:"flex items-center"},it={class:"flex items-center"},dt={key:1},ut={class:"space-y-6"},ct={class:"space-y-6"},mt={class:"space-y-6"},pt={class:"flex justify-between pt-6 border-t border-gray-200"},bt={key:1},ft={class:"flex space-x-3"},gt=["disabled"],xt=["disabled"],yt=["disabled"],vt={key:0,class:"flex items-center"},ht={key:1},wt={key:0,class:"mt-6 rounded-md bg-red-50 p-4"},kt={class:"flex"},_t={class:"ml-3"},Dt={class:"mt-2 text-sm text-red-700"},Ct=F(e({t:"InteractionFormWrapper",props:{interactionId:{},opportunityId:{},isEditing:{type:Boolean,default:!1}},setup(e){const p=e,f=S(),y=E(),v=C(),I=t(1),U=t([]),P=t(!1),V=h({step1:{type:"Phone",subject:"",opportunity_id:p.opportunityId||"",interaction_date:(new Date).toISOString().slice(0,16)},step2:{status:"SCHEDULED",duration_minutes:null,location:null,contact_method:null,participants:[]},step3:{outcome:null,rating:null,notes:"",follow_up_required:!1,follow_up_date:null,follow_up_notes:"",next_action:"",tags:[],attachments:[],custom_fields:null}}),j=h({isValid:!1,errors:{},warnings:{},touched:{},step1Valid:!1,step2Valid:!1,step3Valid:!1}),T=[{id:"basic",name:"Basic Info"},{id:"details",name:"Details"},{id:"outcome",name:"Outcome"}],A=a(()=>f.creating),F=a(()=>f.error),W=a(()=>{switch(I.value){case 1:return j.step1Valid;case 2:return j.step2Valid;case 3:return j.step3Valid;default:return!1}}),R=a(()=>j.step1Valid&&j.step2Valid&&j.step3Valid),H=e=>{switch(e){case 1:return j.step1Valid&&I.value>1;case 2:return j.step2Valid&&I.value>2;case 3:return j.step3Valid;default:return!1}},$=()=>{I.value<3&&W.value&&I.value++},z=()=>{I.value>1&&I.value--},G=e=>{Object.assign(V.step1,e),X()},K=e=>{Object.assign(V.step2,e),Y()},J=e=>{Object.assign(V.step3,e),Z()},Q=e=>{V.step1.opportunity_id=e,X()},X=()=>{const e=[];(!V.step1.subject||V.step1.subject.length<3)&&e.push("Subject must be at least 3 characters"),V.step1.opportunity_id||e.push("Opportunity must be selected"),V.step1.interaction_date||e.push("Interaction date is required"),j.step1Valid=0===e.length,j.errors.step1=e},Y=()=>{const e=[];V.step2.status||e.push("Status is required"),"Meeting"!==V.step1.type||V.step2.location||e.push("Location is required for in-person meetings"),V.step2.duration_minutes&&(V.step2.duration_minutes<1||V.step2.duration_minutes>480)&&e.push("Duration must be between 1 and 480 minutes"),j.step2Valid=0===e.length,j.errors.step2=e},Z=()=>{const e=[];"COMPLETED"!==V.step2.status||V.step3.outcome||e.push("Outcome is required for completed interactions"),V.step3.follow_up_required&&!V.step3.follow_up_date&&e.push("Follow-up date is required when follow-up is needed"),V.step3.rating&&(V.step3.rating<1||V.step3.rating>5)&&e.push("Rating must be between 1 and 5"),j.step3Valid=0===e.length,j.errors.step3=e};o(()=>V.step1.type,e=>{const t=O[e];t&&(Object.assign(V.step2,t),Y())}),w(async()=>{P.value=!0;try{await y.fetchOpportunities({},{page:1,limit:100,sort_by:"created_at",sort_order:"desc"}),U.value=y.opportunities}catch(e){}finally{P.value=!1}p.isEditing&&p.interactionId&&await ee(),X(),Y(),Z()});const ee=async()=>{if(p.interactionId)try{await f.fetchInteractionById(p.interactionId);const e=f.selectedInteraction;if(e){const t=e;V.step1={type:t.type,subject:t.subject||"",opportunity_id:t.opportunity_id,interaction_date:t.interaction_date.slice(0,16)};const o=Array.isArray(t.participants)?t.participants:[];V.step2={status:t.status||"SCHEDULED",duration_minutes:t.duration_minutes,location:t.location,contact_method:t.contact_method,participants:o},V.step3={outcome:t.outcome,rating:t.rating,notes:t.notes||"",follow_up_required:t.follow_up_required||!1,follow_up_date:t.follow_up_date,follow_up_notes:t.follow_up_notes||"",next_action:t.next_action||"",tags:Array.isArray(t.tags)?t.tags:[],attachments:Array.isArray(t.attachments)?t.attachments:[],custom_fields:t.custom_fields}}}catch(e){}},te=async()=>{if(!R.value)return;const e={...V.step1,...V.step2,...V.step3};try{let t=!1;t=p.isEditing&&p.interactionId?await f.updateInteraction(p.interactionId,e):await f.createInteraction(e),t&&(p.opportunityId?v.push(`/opportunities/${p.opportunityId}`):v.push("/interactions"))}catch(t){}},oe=async()=>{};return(e,t)=>(x(),s("div",tt,[l("div",ot,[l("h2",at,b(e.isEditing?"Edit Interaction":"New Interaction"),1),l("p",st,b(e.isEditing?"Update interaction details":"Record a new customer interaction"),1)]),l("div",lt,[l("nav",nt,[l("ol",rt,[(x(),s(u,null,c(T,(e,t)=>{return l("li",{key:e.id,class:"relative"},[l("div",it,[l("div",{class:d(["flex h-8 w-8 items-center justify-center rounded-full text-sm font-medium",(o=t+1,H(o)||I.value===o?"bg-blue-600 text-white":"bg-gray-300 text-gray-500")])},[H(t+1)?(x(),D(m(B),{key:0,class:"h-5 w-5"})):(x(),s("span",dt,b(t+1),1))],2),l("span",{class:d(["ml-3 text-sm font-medium",I.value===t+1?"text-blue-600":"text-gray-500"])},b(e.name),3)]),t<T.length-1?(x(),s("div",{key:0,class:d(["absolute left-4 top-8 h-6 w-0.5",H(t+1)?"bg-blue-600":"bg-gray-300"])},null,2)):n("",!0)]);var o}),64))])])]),l("form",{onSubmit:_(te,["prevent"]),class:"space-y-6"},[r(l("div",ut,[g(ue,{"form-data":V.step1,"onUpdate:formData":[t[0]||(t[0]=e=>V.step1=e),G],validation:j,opportunities:U.value,loading:P.value,onOpportunitySelected:Q},null,8,["form-data","validation","opportunities","loading"])],512),[[k,1===I.value]]),r(l("div",ct,[g(Pe,{"form-data":V.step2,"onUpdate:formData":[t[1]||(t[1]=e=>V.step2=e),K],validation:j,"interaction-type":V.step1.type},null,8,["form-data","validation","interaction-type"])],512),[[k,2===I.value]]),r(l("div",mt,[g(et,{"form-data":V.step3,"onUpdate:formData":[t[2]||(t[2]=e=>V.step3=e),J],validation:j,status:V.step2.status},null,8,["form-data","validation","status"])],512),[[k,3===I.value]]),l("div",pt,[I.value>1?(x(),s("button",{key:0,type:"button",onClick:z,class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[g(m(L),{class:"h-4 w-4 mr-2"}),t[3]||(t[3]=i(" Previous ",-1))])):(x(),s("div",bt)),l("div",ft,[e.isEditing||3!==I.value?n("",!0):(x(),s("button",{key:0,type:"button",onClick:oe,disabled:A.value,class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[g(m(M),{class:"h-4 w-4 mr-2"}),t[4]||(t[4]=i(" Save Draft ",-1))],8,gt)),I.value<3?(x(),s("button",{key:1,type:"button",onClick:$,disabled:!W.value,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[t[5]||(t[5]=i(" Next ",-1)),g(m(q),{class:"h-4 w-4 ml-2"})],8,xt)):(x(),s("button",{key:2,type:"submit",disabled:!R.value||A.value,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[A.value?(x(),s("span",vt,[t[6]||(t[6]=l("svg",{class:"animate-spin -ml-1 mr-3 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),i(" "+b(e.isEditing?"Updating...":"Creating..."),1)])):(x(),s("span",ht,b(e.isEditing?"Update Interaction":"Create Interaction"),1))],8,yt))])])],32),F.value?(x(),s("div",wt,[l("div",kt,[g(m(N),{class:"h-5 w-5 text-red-400"}),l("div",_t,[t[7]||(t[7]=l("h3",{class:"text-sm font-medium text-red-800"},"Error",-1)),l("div",Dt,b(F.value),1)])])])):n("",!0)]))}}),[["__scopeId","data-v-811bad0d"]]);export{Ct as I};
