import{d as e,r as o,c as t,b as r,w as s,y as a,C as l,J as n,D as d,W as i,u,V as c,U as m,N as b,H as p,K as y,X as g,B as f,Y as x,F as h,L as v,O as w,Z as _,E as k}from"./vue-runtime-Ds28nt_E.js";import{u as z}from"./vue-router-BP51f1Hv.js";import{u as V}from"./organizationStore-Cdi8siI6.js";import{b as U,e as C,h as j,r as E}from"./heroicons-QXV26b6T.js";import"./pinia-CUC4VGP7.js";import"./supabaseClient-Bh63a8tq.js";import"./supabase-BNBjhZ5t.js";import"./index-CocGRfLV.js";import"./yup-D1qa_jJc.js";const O={key:0,class:"text-center py-12"},P={key:1,class:"text-center py-12"},S={class:"text-red-600 mb-4"},A={class:"text-gray-600 mb-6"},N={class:"space-x-4"},I={key:2,class:"max-w-4xl mx-auto space-y-6"},B={class:"flex items-center justify-between"},F={class:"flex items-center space-x-2 text-sm text-gray-500 mb-2"},$={class:"mt-1 text-sm text-gray-500"},L={class:"bg-white shadow-sm rounded-lg border border-gray-200"},T={class:"px-6 py-6 space-y-6"},q={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},H={key:0,class:"mt-1 text-sm text-red-600"},M=["value"],W={class:"bg-white shadow-sm rounded-lg border border-gray-200"},Y={class:"px-6 py-6 space-y-6"},D={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},R={key:0,class:"mt-1 text-sm text-red-600"},G={key:0,class:"mt-1 text-sm text-red-600"},J={class:"bg-white shadow-sm rounded-lg border border-gray-200"},K={class:"px-6 py-6 space-y-6"},X={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Z={class:"md:col-span-2"},Q={class:"md:col-span-2"},ee={class:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200"},oe=["disabled"],te={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},re=e({o:"OrganizationEditView",props:{id:{}},setup(e){const re=e,se=z(),ae=V(),le=o(!1),ne=o(null),de=o(!1),ie=o({}),ue=t(()=>ae.currentOrganization),ce=r({name:"",industry:"",status:"Prospect",description:"",website:"",email:"",primary_phone:"",employees_count:void 0,address_line_1:"",address_line_2:"",city:"",state_province:"",postal_code:"",country:""}),me=["Technology","Healthcare","Finance","Education","Manufacturing","Retail","Real Estate","Consulting","Non-profit","Government","Media & Entertainment","Transportation","Energy","Agriculture","Construction","Food & Beverage","Telecommunications","Automotive","Aerospace","Other"],be=async()=>{le.value=!0,ne.value=null;try{await ae.fetchOrganization(re.id),ue.value?pe():ne.value="Organization not found"}catch(e){ne.value="Failed to load organization. Please try again."}finally{le.value=!1}},pe=()=>{ue.value&&Object.assign(ce,{name:ue.value.name||"",industry:ue.value.industry||"",status:ue.value.status||"Prospect",description:ue.value.description||"",website:ue.value.website||"",email:ue.value.email||"",primary_phone:ue.value.primary_phone||"",employees_count:ue.value.employees_count,address_line_1:ue.value.address_line_1||"",address_line_2:ue.value.address_line_2||"",city:ue.value.city||"",state_province:ue.value.state_province||"",postal_code:ue.value.postal_code||"",country:ue.value.country||""})},ye=async()=>{if((()=>{const e=(e=>{const o={};return e.name?.trim()||(o.name="Organization name is required"),e.email&&!/^[^@]+@[^@]+\.[^@]+$/.test(e.email)&&(o.email="Please enter a valid email address"),e.website&&!e.website.startsWith("http")&&(o.website="Website must start with http:// or https://"),{isValid:0===Object.keys(o).length,errors:o}})(ce);return ie.value=e.errors,e.isValid})()&&ue.value){de.value=!0;try{const e={...ce,employees_count:ce.employees_count??null};await ae.updateOrganization(re.id,e),se.push(`/organizations/${re.id}`)}catch(e){if(e&&"object"==typeof e&&"details"in e){const o=e.details;ie.value={...ie.value,...o}}else alert("Failed to update organization. Please try again.")}finally{de.value=!1}}};return s(ue,e=>{e&&pe()},{immediate:!0}),a(()=>{be()}),(e,o)=>{const t=p("router-link");return le.value?(k(),l("div",O,o[14]||(o[14]=[d("div",{class:"inline-flex items-center"},[d("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-3"}),d("span",{class:"text-lg text-gray-600"},"Loading organization...")],-1)]))):ne.value?(k(),l("div",P,[d("div",S,[i(u(U),{class:"h-16 w-16 mx-auto"})]),o[17]||(o[17]=d("h3",{class:"text-xl font-medium text-gray-900 mb-2"},"Error Loading Organization",-1)),d("p",A,c(ne.value),1),d("div",N,[d("button",{onClick:be,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-600 bg-blue-100 hover:bg-blue-200"},[i(u(C),{class:"h-4 w-4 mr-2"}),o[15]||(o[15]=m(" Try Again ",-1))]),i(t,{to:"/organizations",class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},{default:b(()=>o[16]||(o[16]=[m(" Back to Organizations ",-1)])),t:1,l:[16]})])])):ue.value?(k(),l("div",I,[d("div",B,[d("div",null,[d("nav",F,[i(t,{to:"/organizations",class:"hover:text-gray-700"},{default:b(()=>o[18]||(o[18]=[m("Organizations",-1)])),t:1,l:[18]}),i(u(j),{class:"h-4 w-4"}),i(t,{to:`/organizations/${ue.value.id}`,class:"hover:text-gray-700"},{default:b(()=>[m(c(ue.value.name),1)]),t:1},8,["to"]),i(u(j),{class:"h-4 w-4"}),o[19]||(o[19]=d("span",{class:"text-gray-900"},"Edit",-1))]),o[20]||(o[20]=d("h1",{class:"text-2xl font-bold text-gray-900"},"Edit Organization",-1)),d("p",$," Update information for "+c(ue.value.name),1)]),i(t,{to:`/organizations/${ue.value.id}`,class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:b(()=>[i(u(E),{class:"h-4 w-4 mr-2"}),o[21]||(o[21]=m(" Cancel ",-1))]),t:1,l:[21]},8,["to"])]),d("form",{onSubmit:_(ye,["prevent"]),class:"space-y-8"},[d("div",L,[o[29]||(o[29]=d("div",{class:"px-6 py-4 border-b border-gray-200"},[d("h3",{class:"text-lg font-medium text-gray-900"},"Basic Information"),d("p",{class:"mt-1 text-sm text-gray-500"},"Essential details about the organization")],-1)),d("div",T,[d("div",q,[d("div",null,[o[22]||(o[22]=d("label",{for:"name",class:"block text-sm font-medium text-gray-700 mb-2"}," Organization Name * ",-1)),y(d("input",{id:"name","onUpdate:modelValue":o[0]||(o[0]=e=>ce.name=e),type:"text",required:"",class:f(["block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",{"border-red-500 focus:ring-red-500 focus:border-red-500":ie.value.name}]),placeholder:"Enter organization name"},null,2),[[g,ce.name]]),ie.value.name?(k(),l("p",H,c(ie.value.name),1)):n("",!0)]),d("div",null,[o[24]||(o[24]=d("label",{for:"industry",class:"block text-sm font-medium text-gray-700 mb-2"}," Industry ",-1)),y(d("select",{id:"industry","onUpdate:modelValue":o[1]||(o[1]=e=>ce.industry=e),class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[o[23]||(o[23]=d("option",{value:""},"Select industry",-1)),(k(),l(h,null,v(me,e=>d("option",{key:e,value:e},c(e),9,M)),64))],512),[[x,ce.industry]])]),d("div",null,[o[26]||(o[26]=d("label",{for:"status",class:"block text-sm font-medium text-gray-700 mb-2"}," Status * ",-1)),y(d("select",{id:"status","onUpdate:modelValue":o[2]||(o[2]=e=>ce.status=e),required:"",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},o[25]||(o[25]=[w('<option value="Prospect">Prospect</option><option value="Active">Active</option><option value="Inactive">Inactive</option><option value="Customer">Customer</option><option value="Partner">Partner</option><option value="Vendor">Vendor</option>',6)]),512),[[x,ce.status]])]),d("div",null,[o[27]||(o[27]=d("label",{for:"employees_count",class:"block text-sm font-medium text-gray-700 mb-2"}," Employee Count ",-1)),y(d("input",{id:"employees_count","onUpdate:modelValue":o[3]||(o[3]=e=>ce.employees_count=e),type:"number",min:"1",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Number of employees"},null,512),[[g,ce.employees_count,void 0,{number:!0}]])])]),d("div",null,[o[28]||(o[28]=d("label",{for:"description",class:"block text-sm font-medium text-gray-700 mb-2"}," Description ",-1)),y(d("textarea",{id:"description","onUpdate:modelValue":o[4]||(o[4]=e=>ce.description=e),rows:"3",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Brief description of the organization"},null,512),[[g,ce.description]])])])]),d("div",W,[o[33]||(o[33]=d("div",{class:"px-6 py-4 border-b border-gray-200"},[d("h3",{class:"text-lg font-medium text-gray-900"},"Contact Information"),d("p",{class:"mt-1 text-sm text-gray-500"},"How to reach this organization")],-1)),d("div",Y,[d("div",D,[d("div",null,[o[30]||(o[30]=d("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-2"}," Email Address ",-1)),y(d("input",{id:"email","onUpdate:modelValue":o[5]||(o[5]=e=>ce.email=e),type:"email",class:f(["block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",{"border-red-500 focus:ring-red-500 focus:border-red-500":ie.value.email}]),placeholder:"contact@organization.com"},null,2),[[g,ce.email]]),ie.value.email?(k(),l("p",R,c(ie.value.email),1)):n("",!0)]),d("div",null,[o[31]||(o[31]=d("label",{for:"primary_phone",class:"block text-sm font-medium text-gray-700 mb-2"}," Phone Number ",-1)),y(d("input",{id:"primary_phone","onUpdate:modelValue":o[6]||(o[6]=e=>ce.primary_phone=e),type:"tel",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"+1 (555) 123-4567"},null,512),[[g,ce.primary_phone]])]),d("div",null,[o[32]||(o[32]=d("label",{for:"website",class:"block text-sm font-medium text-gray-700 mb-2"}," Website ",-1)),y(d("input",{id:"website","onUpdate:modelValue":o[7]||(o[7]=e=>ce.website=e),type:"url",class:f(["block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",{"border-red-500 focus:ring-red-500 focus:border-red-500":ie.value.website}]),placeholder:"https://www.organization.com"},null,2),[[g,ce.website]]),ie.value.website?(k(),l("p",G,c(ie.value.website),1)):n("",!0)])])])]),d("div",J,[o[40]||(o[40]=d("div",{class:"px-6 py-4 border-b border-gray-200"},[d("h3",{class:"text-lg font-medium text-gray-900"},"Address Information"),d("p",{class:"mt-1 text-sm text-gray-500"},"Physical location details")],-1)),d("div",K,[d("div",X,[d("div",Z,[o[34]||(o[34]=d("label",{for:"address_line_1",class:"block text-sm font-medium text-gray-700 mb-2"}," Street Address ",-1)),y(d("input",{id:"address_line_1","onUpdate:modelValue":o[8]||(o[8]=e=>ce.address_line_1=e),type:"text",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"123 Main Street"},null,512),[[g,ce.address_line_1]])]),d("div",Q,[o[35]||(o[35]=d("label",{for:"address_line_2",class:"block text-sm font-medium text-gray-700 mb-2"}," Address Line 2 (Optional) ",-1)),y(d("input",{id:"address_line_2","onUpdate:modelValue":o[9]||(o[9]=e=>ce.address_line_2=e),type:"text",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Suite, unit, building, floor, etc."},null,512),[[g,ce.address_line_2]])]),d("div",null,[o[36]||(o[36]=d("label",{for:"city",class:"block text-sm font-medium text-gray-700 mb-2"}," City ",-1)),y(d("input",{id:"city","onUpdate:modelValue":o[10]||(o[10]=e=>ce.city=e),type:"text",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"New York"},null,512),[[g,ce.city]])]),d("div",null,[o[37]||(o[37]=d("label",{for:"state_province",class:"block text-sm font-medium text-gray-700 mb-2"}," State/Province ",-1)),y(d("input",{id:"state_province","onUpdate:modelValue":o[11]||(o[11]=e=>ce.state_province=e),type:"text",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"NY"},null,512),[[g,ce.state_province]])]),d("div",null,[o[38]||(o[38]=d("label",{for:"postal_code",class:"block text-sm font-medium text-gray-700 mb-2"}," Postal Code ",-1)),y(d("input",{id:"postal_code","onUpdate:modelValue":o[12]||(o[12]=e=>ce.postal_code=e),type:"text",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"10001"},null,512),[[g,ce.postal_code]])]),d("div",null,[o[39]||(o[39]=d("label",{for:"country",class:"block text-sm font-medium text-gray-700 mb-2"}," Country ",-1)),y(d("input",{id:"country","onUpdate:modelValue":o[13]||(o[13]=e=>ce.country=e),type:"text",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"United States"},null,512),[[g,ce.country]])])])])]),d("div",ee,[i(t,{to:`/organizations/${ue.value.id}`,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:b(()=>o[41]||(o[41]=[m(" Cancel ",-1)])),t:1,l:[41]},8,["to"]),d("button",{type:"submit",disabled:de.value,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[de.value?(k(),l("div",te)):n("",!0),m(" "+c(de.value?"Saving...":"Save Changes"),1)],8,oe)])],32)])):n("",!0)}}});export{re as default};
