import{d as e,r as t,c as s,w as a,y as r,C as l,D as n,J as o,W as i,K as c,u as d,X as u,N as m,H as g,F as b,L as x,V as y,U as p,E as f,B as h,Z as v}from"./vue-runtime-Ds28nt_E.js";import{u as w}from"./vue-router-BP51f1Hv.js";import{u as k}from"./organizationStore-BI5YngbF.js";import{d as z,b as C,e as j,f as _,g as A,h as O,a as P,i as $,j as E,k as L,l as N,m as V,n as F}from"./heroicons-QXV26b6T.js";import"./pinia-CUC4VGP7.js";import"./supabaseClient-BTp2rsYU.js";import"./supabase-b_GQhF-l.js";import"./yup-D02u5inE.js";const M={class:"space-y-6"},S={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},U={class:"mt-4 sm:mt-0 flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-3"},D={class:"relative"},I={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},T={class:"border-b border-gray-200"},B={class:"-mb-px flex space-x-8"},G=["onClick"],H={key:0,class:"text-center py-12"},J={key:1,class:"text-center py-12"},K={class:"text-red-600 mb-4"},W={class:"text-gray-600 mb-4"},X={key:2,class:"text-center py-12"},Z={key:3,class:"text-center py-12"},q={class:"text-gray-600 mb-4"},Q={key:4,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},R=["onClick"],Y={class:"p-6"},ee={class:"flex items-start justify-between mb-4"},te={class:"flex items-center space-x-3"},se={class:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center"},ae={class:"min-w-0 flex-1"},re={class:"text-lg font-medium text-gray-900 truncate"},le={key:0,class:"text-sm text-gray-500 truncate"},ne={class:"space-y-2 mb-4"},oe={key:0,class:"flex items-center text-sm text-gray-600"},ie={class:"truncate"},ce={key:1,class:"flex items-center text-sm text-gray-600"},de={key:2,class:"flex items-center text-sm text-gray-600"},ue={class:"truncate"},me={class:"flex items-center justify-between pt-4 border-t border-gray-200"},ge={class:"flex items-center text-sm text-gray-500"},be={class:"flex items-center space-x-1"},xe=["onClick","aria-label"],ye=["onClick","aria-label"],pe={key:5,class:"flex items-center justify-between pt-6"},fe={class:"text-sm text-gray-700"},he={class:"flex items-center space-x-2"},ve=["disabled"],we={class:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700"},ke=["disabled"],ze=e({t:"OrganizationsListView",setup(e){const ze=w(),Ce=k(),je=t(""),_e=t("all"),Ae=t(!1),Oe=t(null),Pe=t(1),$e=t(12),Ee=t([{key:"all",label:"All Organizations",count:0},{key:"active",label:"Active",count:0},{key:"inactive",label:"Inactive",count:0},{key:"prospect",label:"Prospects",count:0}]),Le=s(()=>Ce.organizations),Ne=s(()=>{let e=Le.value;if("all"!==_e.value&&(e=e.filter(e=>e.status?.toLowerCase()===_e.value)),je.value.trim()){const t=je.value.toLowerCase().trim();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.industry?.toLowerCase().includes(t)||e.website?.toLowerCase().includes(t)||e.email?.toLowerCase().includes(t))}return e}),Ve=s(()=>Ne.value.length),Fe=s(()=>Math.ceil(Ve.value/$e.value)),Me=async()=>{Ae.value=!0,Oe.value=null;try{await Ce.fetchOrganizations(),Se()}catch(e){Oe.value="Failed to load organizations. Please try again."}finally{Ae.value=!1}},Se=()=>{const e=Le.value.reduce((e,t)=>{e.all++;const s=t.status?.toLowerCase()||"unknown";return e[s]=(e[s]||0)+1,e},{all:0,active:0,inactive:0,prospect:0});Ee.value.forEach(t=>{t.count=e[t.key]||0})},Ue=e=>{if(!e)return"bg-gray-100 text-gray-800";const t={Active:"bg-green-100 text-green-800",Inactive:"bg-gray-100 text-gray-800",Prospect:"bg-blue-100 text-blue-800",Customer:"bg-purple-100 text-purple-800",Partner:"bg-yellow-100 text-yellow-800",Vendor:"bg-indigo-100 text-indigo-800"};return t[e]||t.Inactive};return a(je,()=>{Pe.value=1}),a(_e,()=>{Pe.value=1}),r(()=>{Me()}),(e,t)=>{const s=g("router-link");return f(),l("div",M,[n("div",S,[t[5]||(t[5]=n("div",null,[n("h1",{class:"text-2xl font-bold text-gray-900"},"Organizations"),n("p",{class:"mt-1 text-sm text-gray-500"}," Manage your business organizations and client companies ")],-1)),n("div",U,[n("div",D,[n("div",I,[i(d(z),{class:"h-5 w-5 text-gray-400"})]),c(n("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>je.value=e),type:"text",placeholder:"Search organizations...",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},null,512),[[u,je.value]])]),i(s,{to:"/organizations/new",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:m(()=>[i(d(P),{class:"h-4 w-4 mr-2"}),t[4]||(t[4]=p(" Add Organization ",-1))]),l:1,o:[4]})])]),n("div",T,[n("nav",B,[(f(!0),l(b,null,x(Ee.value,e=>(f(),l("button",{key:e.key,onClick:t=>_e.value=e.key,class:h(["py-2 px-1 border-b-2 font-medium text-sm",_e.value===e.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[p(y(e.label)+" ",1),e.count?(f(),l("span",{key:0,class:h(["ml-2 py-0.5 px-2 rounded-full text-xs",_e.value===e.key?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"])},y(e.count),3)):o("",!0)],10,G))),128))])]),Ae.value?(f(),l("div",H,t[6]||(t[6]=[n("div",{class:"inline-flex items-center"},[n("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-3"}),n("span",{class:"text-gray-600"},"Loading organizations...")],-1)]))):Oe.value?(f(),l("div",J,[n("div",K,[i(d(C),{class:"h-12 w-12 mx-auto"})]),t[8]||(t[8]=n("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Error Loading Organizations",-1)),n("p",W,y(Oe.value),1),n("button",{onClick:Me,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-600 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[i(d(j),{class:"h-4 w-4 mr-2"}),t[7]||(t[7]=p(" Try Again ",-1))])])):0!==Ne.value.length||je.value?0===Ne.value.length&&je.value?(f(),l("div",Z,[i(d(z),{class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),t[12]||(t[12]=n("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No organizations found",-1)),n("p",q,'No organizations match "'+y(je.value)+'"',1),n("button",{onClick:t[1]||(t[1]=e=>je.value=""),class:"text-blue-600 hover:text-blue-500 font-medium"}," Clear search ")])):(f(),l("div",Q,[(f(!0),l(b,null,x(Ne.value,e=>{return f(),l("div",{key:e.id,class:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow cursor-pointer",onClick:t=>{return s=e.id,void ze.push(`/organizations/${s}`);var s}},[n("div",Y,[n("div",ee,[n("div",te,[n("div",se,[i(d(_),{class:"h-6 w-6 text-blue-600"})]),n("div",ae,[n("h3",re,y(e.name),1),e.industry?(f(),l("p",le,y(e.industry),1)):o("",!0)])]),n("span",{class:h(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",Ue(e.status)])},y((t=e.status,t||"Unknown")),3)]),n("div",ne,[e.website?(f(),l("div",oe,[i(d($),{class:"h-4 w-4 mr-2 flex-shrink-0"}),n("span",ie,y(e.website),1)])):o("",!0),e.primary_phone?(f(),l("div",ce,[i(d(E),{class:"h-4 w-4 mr-2 flex-shrink-0"}),n("span",null,y(e.primary_phone),1)])):o("",!0),e.email?(f(),l("div",de,[i(d(L),{class:"h-4 w-4 mr-2 flex-shrink-0"}),n("span",ue,y(e.email),1)])):o("",!0)]),n("div",me,[n("div",ge,[i(d(N),{class:"h-4 w-4 mr-1"}),n("span",null,y(e.employees_count||0)+" employees",1)]),n("div",be,[n("button",{onClick:v(t=>{return s=e.id,void ze.push(`/organizations/${s}/edit`);var s},["stop"]),class:"p-1.5 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100","aria-label":`Edit ${e.name}`},[i(d(V),{class:"h-4 w-4"})],8,xe),n("button",{onClick:v(t=>(async e=>{const t=Le.value.find(t=>t.id===e);if(t&&confirm(`Are you sure you want to delete "${t.name}"? This action cannot be undone.`))try{await Ce.deleteOrganization(e),Se()}catch(s){alert("Failed to delete organization. Please try again.")}})(e.id),["stop"]),class:"p-1.5 text-red-400 hover:text-red-600 rounded-md hover:bg-red-50","aria-label":`Delete ${e.name}`},[i(d(F),{class:"h-4 w-4"})],8,ye)])])])],8,R);var t}),128))])):(f(),l("div",X,[i(d(_),{class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),t[10]||(t[10]=n("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No organizations yet",-1)),t[11]||(t[11]=n("p",{class:"text-gray-600 mb-6"},"Get started by adding your first organization.",-1)),i(s,{to:"/organizations/new",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:m(()=>[i(d(P),{class:"h-4 w-4 mr-2"}),t[9]||(t[9]=p(" Add Organization ",-1))]),l:1,o:[9]})])),Fe.value>1?(f(),l("div",pe,[n("div",fe," Showing "+y((Pe.value-1)*$e.value+1)+" to "+y(Math.min(Pe.value*$e.value,Ve.value))+" of "+y(Ve.value)+" organizations ",1),n("div",he,[n("button",{onClick:t[2]||(t[2]=e=>Pe.value--),disabled:1===Pe.value,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[i(d(A),{class:"h-5 w-5"})],8,ve),n("span",we,y(Pe.value)+" of "+y(Fe.value),1),n("button",{onClick:t[3]||(t[3]=e=>Pe.value++),disabled:Pe.value===Fe.value,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[i(d(O),{class:"h-5 w-5"})],8,ke)])])):o("",!0)])}}});export{ze as default};
